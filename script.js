var l7=`
          #page {
            height: max-content;
          }

          .page h1 {
            font-size: 14pt;
            font-weight: 700;
            text-align: center;
            counter-reset: h2-counter fig-counter caption-counter;
            counter-increment: h1-counter;
            margin-bottom: 10pt;
            margin-top: 10pt;
          }
            .page img::focus{
            @apply ring-blue-500
            }
          .page h1::before {
            content: "BAB " counter(h1-counter) "\\A";
            font-weight: bold;
            white-space: pre-line;
          }

          .page h2 {
            font-size: 12pt;
            font-weight: 600;
            margin-bottom: 4pt;
            display: list-item;
            list-style: none;
            counter-increment: h2-counter;
            counter-reset: h3-counter;
          }
        .page table {
            max-width: 14cm !important;
            border-bottom: 1px solid black;
             border-collapse: collapse;

        }
        .page table td, table th {
        position: relative;
        }
        td[colspan] {
        border-right: none;
        }
        .selectedCell::after {
                background: rgba(0,0,0,0.07);
                content: "";
                left: 0; right: 0; top: 0; bottom: 0;
                pointer-events: none;
                position: absolute;
                z-index: 2;
                width:100%;
        }
        .page figure[data-type="figureTable"] > figcaption {
                width:14cm !important;
                text-align:center;
                counter-increment: caption-counter;
        }
        .page figure[data-type="figureTable"] > figcaption::before {
        content: "Tabel " counter(h1-counter) "." counter(caption-counter) " ";
        }



        .page figure[data-type="imageFigure"] {
        text-align:center;
        align-items:center;
        widht:100%;
        display:flex;
        flex-direction:column;
        }
        .page th,
        .page td {
            text-align: left;
            min-width:100%;
        }
        .page td > div{
            width:100%;
        }

        .page th {
            border-bottom: 1px solid black;
            border-top: 1px solid black

        }


          .page h2::before {
            content: counter(h1-counter) "." counter(h2-counter) " ";
            font-weight: bold;
          }
        .page h3::before {
            content: counter(h1-counter) "." counter(h2-counter) "." counter(h3-counter) ;
            font-weight: bold;
          }

          .page h3 {
            font-size: 12pt;
            font-weight: 600;
            margin-bottom: 3pt;
            display: list-item;
            list-style: none;
            counter-increment: h3-counter;
          }

          .page figcaption {
            counter-increment: fig-counter;
          }

          .page figcaption::before {
            content: "Gambar " counter(h1-counter) "." counter(fig-counter) " ";
          }

          .page-break {
            width: 21cm;
            height: 6cm;
            margin-left: -4cm;
            position: relative;
          }

          .page .tiptap > p {
            text-indent: 1.27cm;
            margin-top: 0;
            margin-bottom: 0.5em;
            text-align: justify;
          }

          .ProseMirror p {
            max-width: 14cm;
            text-align: justify;
            hyphens: auto;
            hyphenate-limit-chars: 3 3 3;
            overflow-wrap: break-word;
          }

          .page > .tiptap {
            max-width: 14cm !important;
          }

          .tiptap {
            margin: 0;
            padding: 0;
          }

          .page li p {
            text-indent: 0;
          }

          .page ol {
            list-style-position: outside;
            list-style-type: decimal;
            margin-left: 2.5em;
          }

          .page ul {
            list-style-type: disc;
            margin-left: 2.5em;
          }

          .page {
            width: 21cm;
            min-height: 29.7cm;
            background: rgb(255, 255, 255);
            border: 1px solid #ccc;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 3cm 3cm 4cm 4cm;
            margin: 3cm auto;
            font-family: 'Times New Roman', Times, serif;
            line-height: 1.5;
            overflow-y: hidden;
            box-sizing: border-box;
            page-break-after: always;
            font-size: 12pt;
            position: relative;
          }

          .tiptap {
            min-height: max-content;
          }

          .tiptap:focus {
            outline: none;
          }

          .page cite {
            font-style: normal;
          }

          .latex-var {
            cursor: pointer;
            position: relative;
          }

          .latex-var::before {
            max-width: 20rem !important;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            white-space: normal;
            border-radius: .25rem;
            padding: .25rem .5rem;
            font-size: .875rem;
            line-height: 1.25rem;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(3px);
            color: white;
            width: max-content !important;
            transition-duration: .2s;
            transition-timing-function: cubic-bezier(.4, 0, .2, 1);
            transform: translate(-50%);
            font-weight: 700;
            top: auto;
            left: 50%;
            opacity: 0;
            right: auto;
            bottom: calc(100% + 1px + .1875rem);
            position: absolute;
            pointer-events: none;
            z-index: 1;
            text-indent: 0;
            content: "@var \\" attr(var);
          }

          .latex-var:hover::before {
            opacity: 1;
            transition-delay: 75ms;
          }

          table[type="longtable"] {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid;
          }

          table[type="tabular"] {
            border-collapse: separate;
            border-spacing: 5px;
          }

          @media print {
            * {
              visibility: hidden;
            }

            #page {
              visibility: visible;
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
              height: 100%;
              overflow: visible;
              border: none;
              box-shadow: none;
              margin: 0 !important;
            }

            .page-break {
              visibility: hidden;
            }

            #page * {
              visibility: visible;
            }
          }

          .menu {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            z-index: 100;
          }
        `;var e=function(Q){this.content=Q};e.prototype={constructor:e,find:function(Q){for(var Z=0;Z<this.content.length;Z+=2)if(this.content[Z]===Q)return Z;return-1},get:function(Q){var Z=this.find(Q);return Z==-1?void 0:this.content[Z+1]},update:function(Q,Z,X){var J=X&&X!=Q?this.remove(X):this,Y=J.find(Q),q=J.content.slice();if(Y==-1)q.push(X||Q,Z);else if(q[Y+1]=Z,X)q[Y]=X;return new e(q)},remove:function(Q){var Z=this.find(Q);if(Z==-1)return this;var X=this.content.slice();return X.splice(Z,2),new e(X)},addToStart:function(Q,Z){return new e([Q,Z].concat(this.remove(Q).content))},addToEnd:function(Q,Z){var X=this.remove(Q).content.slice();return X.push(Q,Z),new e(X)},addBefore:function(Q,Z,X){var J=this.remove(Z),Y=J.content.slice(),q=J.find(Q);return Y.splice(q==-1?Y.length:q,0,Z,X),new e(Y)},forEach:function(Q){for(var Z=0;Z<this.content.length;Z+=2)Q(this.content[Z],this.content[Z+1])},prepend:function(Q){if(Q=e.from(Q),!Q.size)return this;return new e(Q.content.concat(this.subtract(Q).content))},append:function(Q){if(Q=e.from(Q),!Q.size)return this;return new e(this.subtract(Q).content.concat(Q.content))},subtract:function(Q){var Z=this;Q=e.from(Q);for(var X=0;X<Q.content.length;X+=2)Z=Z.remove(Q.content[X]);return Z},toObject:function(){var Q={};return this.forEach(function(Z,X){Q[Z]=X}),Q},get size(){return this.content.length>>1}};e.from=function(Q){if(Q instanceof e)return Q;var Z=[];if(Q)for(var X in Q)Z.push(X,Q[X]);return new e(Z)};var X6=e;var t7=function(Q,Z,X){for(let J=0;;J++){if(J==Q.childCount||J==Z.childCount)return Q.childCount==Z.childCount?null:X;let Y=Q.child(J),q=Z.child(J);if(Y==q){X+=Y.nodeSize;continue}if(!Y.sameMarkup(q))return X;if(Y.isText&&Y.text!=q.text){for(let U=0;Y.text[U]==q.text[U];U++)X++;return X}if(Y.content.size||q.content.size){let U=t7(Y.content,q.content,X+1);if(U!=null)return U}X+=Y.nodeSize}},e7=function(Q,Z,X,J){for(let Y=Q.childCount,q=Z.childCount;;){if(Y==0||q==0)return Y==q?null:{a:X,b:J};let U=Q.child(--Y),G=Z.child(--q),z=U.nodeSize;if(U==G){X-=z,J-=z;continue}if(!U.sameMarkup(G))return{a:X,b:J};if(U.isText&&U.text!=G.text){let V=0,K=Math.min(U.text.length,G.text.length);while(V<K&&U.text[U.text.length-V-1]==G.text[G.text.length-V-1])V++,X--,J--;return{a:X,b:J}}if(U.content.size||G.content.size){let V=e7(U.content,G.content,X-1,J-1);if(V)return V}X-=z,J-=z}},G5=function(Q,Z){return J6.index=Q,J6.offset=Z,J6},V5=function(Q,Z){if(Q===Z)return!0;if(!(Q&&typeof Q=="object")||!(Z&&typeof Z=="object"))return!1;let X=Array.isArray(Q);if(Array.isArray(Z)!=X)return!1;if(X){if(Q.length!=Z.length)return!1;for(let J=0;J<Q.length;J++)if(!V5(Q[J],Z[J]))return!1}else{for(let J in Q)if(!(J in Z)||!V5(Q[J],Z[J]))return!1;for(let J in Z)if(!(J in Q))return!1}return!0},Q9=function(Q,Z,X){let{index:J,offset:Y}=Q.findIndex(Z),q=Q.maybeChild(J),{index:U,offset:G}=Q.findIndex(X);if(Y==Z||q.isText){if(G!=X&&!Q.child(U).isText)throw new RangeError("Removing non-flat range");return Q.cut(0,Z).append(Q.cut(X))}if(J!=U)throw new RangeError("Removing non-flat range");return Q.replaceChild(J,q.copy(Q9(q.content,Z-Y-1,X-Y-1)))},Z9=function(Q,Z,X,J){let{index:Y,offset:q}=Q.findIndex(Z),U=Q.maybeChild(Y);if(q==Z||U.isText){if(J&&!J.canReplace(Y,Y,X))return null;return Q.cut(0,Z).append(X).append(Q.cut(Z))}let G=Z9(U.content,Z-q-1,X);return G&&Q.replaceChild(Y,U.copy(G))},H2=function(Q,Z,X){if(X.openStart>Q.depth)throw new W1("Inserted content deeper than insertion position");if(Q.depth-X.openStart!=Z.depth-X.openEnd)throw new W1("Inconsistent open depths");return X9(Q,Z,X,0)},X9=function(Q,Z,X,J){let Y=Q.index(J),q=Q.node(J);if(Y==Z.index(J)&&J<Q.depth-X.openStart){let U=X9(Q,Z,X,J+1);return q.copy(q.content.replaceChild(Y,U))}else if(!X.content.size)return o0(q,K5(Q,Z,J));else if(!X.openStart&&!X.openEnd&&Q.depth==J&&Z.depth==J){let U=Q.parent,G=U.content;return o0(U,G.cut(0,Q.parentOffset).append(X.content).append(G.cut(Z.parentOffset)))}else{let{start:U,end:G}=W2(X,Q);return o0(q,Y9(Q,U,G,Z,J))}},J9=function(Q,Z){if(!Z.type.compatibleContent(Q.type))throw new W1("Cannot join "+Z.type.name+" onto "+Q.type.name)},q6=function(Q,Z,X){let J=Q.node(X);return J9(J,Z.node(X)),J},r0=function(Q,Z){let X=Z.length-1;if(X>=0&&Q.isText&&Q.sameMarkup(Z[X]))Z[X]=Q.withText(Z[X].text+Q.text);else Z.push(Q)},w1=function(Q,Z,X,J){let Y=(Z||Q).node(X),q=0,U=Z?Z.index(X):Y.childCount;if(Q){if(q=Q.index(X),Q.depth>X)q++;else if(Q.textOffset)r0(Q.nodeAfter,J),q++}for(let G=q;G<U;G++)r0(Y.child(G),J);if(Z&&Z.depth==X&&Z.textOffset)r0(Z.nodeBefore,J)},o0=function(Q,Z){return Q.type.checkContent(Z),Q.copy(Z)},Y9=function(Q,Z,X,J,Y){let q=Q.depth>Y&&q6(Q,Z,Y+1),U=J.depth>Y&&q6(X,J,Y+1),G=[];if(w1(null,Q,Y,G),q&&U&&Z.index(Y)==X.index(Y))J9(q,U),r0(o0(q,Y9(Q,Z,X,J,Y+1)),G);else{if(q)r0(o0(q,K5(Q,Z,Y+1)),G);if(w1(Z,X,Y,G),U)r0(o0(U,K5(X,J,Y+1)),G)}return w1(J,null,Y,G),new P(G)},K5=function(Q,Z,X){let J=[];if(w1(null,Q,X,J),Q.depth>X){let Y=q6(Q,Z,X+1);r0(o0(Y,K5(Q,Z,X+1)),J)}return w1(Z,null,X,J),new P(J)},W2=function(Q,Z){let X=Z.depth-Q.openStart,Y=Z.node(X).copy(Q.content);for(let q=X-1;q>=0;q--)Y=Z.node(q).copy(P.from(Y));return{start:Y.resolveNoCache(Q.openStart+X),end:Y.resolveNoCache(Y.content.size-Q.openEnd-X)}},U9=function(Q,Z){for(let X=Q.length-1;X>=0;X--)Z=Q[X].type.name+"("+Z+")";return Z},z9=function(Q){let Z=[];do Z.push(_2(Q));while(Q.eat("|"));return Z.length==1?Z[0]:{type:"choice",exprs:Z}},_2=function(Q){let Z=[];do Z.push(I2(Q));while(Q.next&&Q.next!=")"&&Q.next!="|");return Z.length==1?Z[0]:{type:"seq",exprs:Z}},I2=function(Q){let Z=j2(Q);for(;;)if(Q.eat("+"))Z={type:"plus",expr:Z};else if(Q.eat("*"))Z={type:"star",expr:Z};else if(Q.eat("?"))Z={type:"opt",expr:Z};else if(Q.eat("{"))Z=F2(Q,Z);else break;return Z},p7=function(Q){if(/\D/.test(Q.next))Q.err("Expected number, got '"+Q.next+"'");let Z=Number(Q.next);return Q.pos++,Z},F2=function(Q,Z){let X=p7(Q),J=X;if(Q.eat(","))if(Q.next!="}")J=p7(Q);else J=-1;if(!Q.eat("}"))Q.err("Unclosed braced range");return{type:"range",min:X,max:J,expr:Z}},P2=function(Q,Z){let X=Q.nodeTypes,J=X[Z];if(J)return[J];let Y=[];for(let q in X){let U=X[q];if(U.isInGroup(Z))Y.push(U)}if(Y.length==0)Q.err("No node type or group '"+Z+"' found");return Y},j2=function(Q){if(Q.eat("(")){let Z=z9(Q);if(!Q.eat(")"))Q.err("Missing closing paren");return Z}else if(!/\W/.test(Q.next)){let Z=P2(Q,Q.next).map((X)=>{if(Q.inline==null)Q.inline=X.isInline;else if(Q.inline!=X.isInline)Q.err("Mixing inline and block content");return{type:"name",value:X}});return Q.pos++,Z.length==1?Z[0]:{type:"choice",exprs:Z}}else Q.err("Unexpected token '"+Q.next+"'")},E2=function(Q){let Z=[[]];return Y(q(Q,0),X()),Z;function X(){return Z.push([])-1}function J(U,G,z){let V={term:z,to:G};return Z[U].push(V),V}function Y(U,G){U.forEach((z)=>z.to=G)}function q(U,G){if(U.type=="choice")return U.exprs.reduce((z,V)=>z.concat(q(V,G)),[]);else if(U.type=="seq")for(let z=0;;z++){let V=q(U.exprs[z],G);if(z==U.exprs.length-1)return V;Y(V,G=X())}else if(U.type=="star"){let z=X();return J(G,z),Y(q(U.expr,z),z),[J(z)]}else if(U.type=="plus"){let z=X();return Y(q(U.expr,G),z),Y(q(U.expr,z),z),[J(z)]}else if(U.type=="opt")return[J(G)].concat(q(U.expr,G));else if(U.type=="range"){let z=G;for(let V=0;V<U.min;V++){let K=X();Y(q(U.expr,z),K),z=K}if(U.max==-1)Y(q(U.expr,z),z);else for(let V=U.min;V<U.max;V++){let K=X();J(z,K),Y(q(U.expr,z),K),z=K}return[J(z)]}else if(U.type=="name")return[J(G,void 0,U.value)];else throw new Error("Unknown expr type")}},V9=function(Q,Z){return Z-Q},d7=function(Q,Z){let X=[];return J(Z),X.sort(V9);function J(Y){let q=Q[Y];if(q.length==1&&!q[0].term)return J(q[0].to);X.push(Y);for(let U=0;U<q.length;U++){let{term:G,to:z}=q[U];if(!G&&X.indexOf(z)==-1)J(z)}}},A2=function(Q){let Z=Object.create(null);return X(d7(Q,0));function X(J){let Y=[];J.forEach((U)=>{Q[U].forEach(({term:G,to:z})=>{if(!G)return;let V;for(let K=0;K<Y.length;K++)if(Y[K][0]==G)V=Y[K][1];d7(Q,z).forEach((K)=>{if(!V)Y.push([G,V=[]]);if(V.indexOf(K)==-1)V.push(K)})})});let q=Z[J.join(",")]=new t0(J.indexOf(Q.length-1)>-1);for(let U=0;U<Y.length;U++){let G=Y[U][1].sort(V9);q.next.push({type:Y[U][0],next:Z[G.join(",")]||X(G)})}return q}},O2=function(Q,Z){for(let X=0,J=[Q];X<J.length;X++){let Y=J[X],q=!Y.validEnd,U=[];for(let G=0;G<Y.next.length;G++){let{type:z,next:V}=Y.next[G];if(U.push(z.name),q&&!(z.isText||z.hasRequiredAttrs()))q=!1;if(J.indexOf(V)==-1)J.push(V)}if(q)Z.err("Only non-generatable nodes ("+U.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}},K9=function(Q){let Z=Object.create(null);for(let X in Q){let J=Q[X];if(!J.hasDefault)return null;Z[X]=J.default}return Z},H9=function(Q,Z){let X=Object.create(null);for(let J in Q){let Y=Z&&Z[J];if(Y===void 0){let q=Q[J];if(q.hasDefault)Y=q.default;else throw new RangeError("No value supplied for attribute "+J)}X[J]=Y}return X},W9=function(Q,Z,X,J){for(let Y in Z)if(!(Y in Q))throw new RangeError(`Unsupported attribute ${Y} for ${X} of type ${Y}`);for(let Y in Q){let q=Q[Y];if(q.validate)q.validate(Z[Y])}},L9=function(Q,Z){let X=Object.create(null);if(Z)for(let J in Z)X[J]=new B9(Q,J,Z[J]);return X},R2=function(Q,Z,X){let J=X.split("|");return(Y)=>{let q=Y===null?"null":typeof Y;if(J.indexOf(q)<0)throw new RangeError(`Expected value of type ${J} for attribute ${Z} on type ${Q}, got ${q}`)}},i7=function(Q,Z){let X=[];for(let J=0;J<Z.length;J++){let Y=Z[J],q=Q.marks[Y],U=q;if(q)X.push(q);else for(let G in Q.marks){let z=Q.marks[G];if(Y=="_"||z.spec.group&&z.spec.group.split(" ").indexOf(Y)>-1)X.push(U=z)}if(!U)throw new SyntaxError("Unknown mark type: '"+Z[J]+"'")}return X},N2=function(Q){return Q.tag!=null},D2=function(Q){return Q.style!=null},s7=function(Q,Z,X){if(Z!=null)return(Z?f1:0)|(Z==="full"?U6:0);return Q&&Q.whitespace=="pre"?f1|U6:X&~u1},C2=function(Q){for(let Z=Q.firstChild,X=null;Z;Z=Z.nextSibling){let J=Z.nodeType==1?Z.nodeName.toLowerCase():null;if(J&&I9.hasOwnProperty(J)&&X)X.appendChild(Z),Z=X;else if(J=="li")X=Z;else if(J)X=null}},T2=function(Q,Z){return(Q.matches||Q.msMatchesSelector||Q.webkitMatchesSelector||Q.mozMatchesSelector).call(Q,Z)},a7=function(Q){let Z={};for(let X in Q)Z[X]=Q[X];return Z},n7=function(Q,Z){let X=Z.schema.nodes;for(let J in X){let Y=X[J];if(!Y.allowsMarkType(Q))continue;let q=[],U=(G)=>{q.push(G);for(let z=0;z<G.edgeCount;z++){let{type:V,next:K}=G.edge(z);if(V==Z)return!0;if(q.indexOf(K)<0&&U(K))return!0}};if(U(Y.contentMatch))return!0}},r7=function(Q){let Z={};for(let X in Q){let J=Q[X].spec.toDOM;if(J)Z[X]=J}return Z},Y6=function(Q){return Q.document||window.document},k2=function(Q){let Z=o7.get(Q);if(Z===void 0)o7.set(Q,Z=S2(Q));return Z},S2=function(Q){let Z=null;function X(J){if(J&&typeof J=="object")if(Array.isArray(J))if(typeof J[0]=="string"){if(!Z)Z=[];Z.push(J)}else for(let Y=0;Y<J.length;Y++)X(J[Y]);else for(let Y in J)X(J[Y])}return X(Q),Z},z5=function(Q,Z,X,J){if(typeof Z=="string")return{dom:Q.createTextNode(Z)};if(Z.nodeType!=null)return{dom:Z};if(Z.dom&&Z.dom.nodeType!=null)return Z;let Y=Z[0],q;if(typeof Y!="string")throw new RangeError("Invalid array passed to renderSpec");if(J&&(q=k2(J))&&q.indexOf(Z)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let U=Y.indexOf(" ");if(U>0)X=Y.slice(0,U),Y=Y.slice(U+1);let G,z=X?Q.createElementNS(X,Y):Q.createElement(Y),V=Z[1],K=1;if(V&&typeof V=="object"&&V.nodeType==null&&!Array.isArray(V)){K=2;for(let H in V)if(V[H]!=null){let W=H.indexOf(" ");if(W>0)z.setAttributeNS(H.slice(0,W),H.slice(W+1),V[H]);else z.setAttribute(H,V[H])}}for(let H=K;H<Z.length;H++){let W=Z[H];if(W===0){if(H<Z.length-1||H>K)throw new RangeError("Content hole must be the only child of its parent node");return{dom:z,contentDOM:z}}else{let{dom:B,contentDOM:L}=z5(Q,W,X,J);if(z.appendChild(B),L){if(G)throw new RangeError("Multiple content holes");G=L}}}return{dom:z,contentDOM:G}};class P{constructor(Q,Z){if(this.content=Q,this.size=Z||0,Z==null)for(let X=0;X<Q.length;X++)this.size+=Q[X].nodeSize}nodesBetween(Q,Z,X,J=0,Y){for(let q=0,U=0;U<Z;q++){let G=this.content[q],z=U+G.nodeSize;if(z>Q&&X(G,J+U,Y||null,q)!==!1&&G.content.size){let V=U+1;G.nodesBetween(Math.max(0,Q-V),Math.min(G.content.size,Z-V),X,J+V)}U=z}}descendants(Q){this.nodesBetween(0,this.size,Q)}textBetween(Q,Z,X,J){let Y="",q=!0;return this.nodesBetween(Q,Z,(U,G)=>{let z=U.isText?U.text.slice(Math.max(Q,G)-G,Z-G):!U.isLeaf?"":J?typeof J==="function"?J(U):J:U.type.spec.leafText?U.type.spec.leafText(U):"";if(U.isBlock&&(U.isLeaf&&z||U.isTextblock)&&X)if(q)q=!1;else Y+=X;Y+=z},0),Y}append(Q){if(!Q.size)return this;if(!this.size)return Q;let Z=this.lastChild,X=Q.firstChild,J=this.content.slice(),Y=0;if(Z.isText&&Z.sameMarkup(X))J[J.length-1]=Z.withText(Z.text+X.text),Y=1;for(;Y<Q.content.length;Y++)J.push(Q.content[Y]);return new P(J,this.size+Q.size)}cut(Q,Z=this.size){if(Q==0&&Z==this.size)return this;let X=[],J=0;if(Z>Q)for(let Y=0,q=0;q<Z;Y++){let U=this.content[Y],G=q+U.nodeSize;if(G>Q){if(q<Q||G>Z)if(U.isText)U=U.cut(Math.max(0,Q-q),Math.min(U.text.length,Z-q));else U=U.cut(Math.max(0,Q-q-1),Math.min(U.content.size,Z-q-1));X.push(U),J+=U.nodeSize}q=G}return new P(X,J)}cutByIndex(Q,Z){if(Q==Z)return P.empty;if(Q==0&&Z==this.content.length)return this;return new P(this.content.slice(Q,Z))}replaceChild(Q,Z){let X=this.content[Q];if(X==Z)return this;let J=this.content.slice(),Y=this.size+Z.nodeSize-X.nodeSize;return J[Q]=Z,new P(J,Y)}addToStart(Q){return new P([Q].concat(this.content),this.size+Q.nodeSize)}addToEnd(Q){return new P(this.content.concat(Q),this.size+Q.nodeSize)}eq(Q){if(this.content.length!=Q.content.length)return!1;for(let Z=0;Z<this.content.length;Z++)if(!this.content[Z].eq(Q.content[Z]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(Q){let Z=this.content[Q];if(!Z)throw new RangeError("Index "+Q+" out of range for "+this);return Z}maybeChild(Q){return this.content[Q]||null}forEach(Q){for(let Z=0,X=0;Z<this.content.length;Z++){let J=this.content[Z];Q(J,X,Z),X+=J.nodeSize}}findDiffStart(Q,Z=0){return t7(this,Q,Z)}findDiffEnd(Q,Z=this.size,X=Q.size){return e7(this,Q,Z,X)}findIndex(Q,Z=-1){if(Q==0)return G5(0,Q);if(Q==this.size)return G5(this.content.length,Q);if(Q>this.size||Q<0)throw new RangeError(`Position ${Q} outside of fragment (${this})`);for(let X=0,J=0;;X++){let Y=this.child(X),q=J+Y.nodeSize;if(q>=Q){if(q==Q||Z>0)return G5(X+1,q);return G5(X,J)}J=q}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map((Q)=>Q.toJSON()):null}static fromJSON(Q,Z){if(!Z)return P.empty;if(!Array.isArray(Z))throw new RangeError("Invalid input for Fragment.fromJSON");return new P(Z.map(Q.nodeFromJSON))}static fromArray(Q){if(!Q.length)return P.empty;let Z,X=0;for(let J=0;J<Q.length;J++){let Y=Q[J];if(X+=Y.nodeSize,J&&Y.isText&&Q[J-1].sameMarkup(Y)){if(!Z)Z=Q.slice(0,J);Z[Z.length-1]=Y.withText(Z[Z.length-1].text+Y.text)}else if(Z)Z.push(Y)}return new P(Z||Q,X)}static from(Q){if(!Q)return P.empty;if(Q instanceof P)return Q;if(Array.isArray(Q))return this.fromArray(Q);if(Q.attrs)return new P([Q],Q.nodeSize);throw new RangeError("Can not convert "+Q+" to a Fragment"+(Q.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}P.empty=new P([],0);var J6={index:0,offset:0};class b{constructor(Q,Z){this.type=Q,this.attrs=Z}addToSet(Q){let Z,X=!1;for(let J=0;J<Q.length;J++){let Y=Q[J];if(this.eq(Y))return Q;if(this.type.excludes(Y.type)){if(!Z)Z=Q.slice(0,J)}else if(Y.type.excludes(this.type))return Q;else{if(!X&&Y.type.rank>this.type.rank){if(!Z)Z=Q.slice(0,J);Z.push(this),X=!0}if(Z)Z.push(Y)}}if(!Z)Z=Q.slice();if(!X)Z.push(this);return Z}removeFromSet(Q){for(let Z=0;Z<Q.length;Z++)if(this.eq(Q[Z]))return Q.slice(0,Z).concat(Q.slice(Z+1));return Q}isInSet(Q){for(let Z=0;Z<Q.length;Z++)if(this.eq(Q[Z]))return!0;return!1}eq(Q){return this==Q||this.type==Q.type&&V5(this.attrs,Q.attrs)}toJSON(){let Q={type:this.type.name};for(let Z in this.attrs){Q.attrs=this.attrs;break}return Q}static fromJSON(Q,Z){if(!Z)throw new RangeError("Invalid input for Mark.fromJSON");let X=Q.marks[Z.type];if(!X)throw new RangeError(`There is no mark type ${Z.type} in this schema`);let J=X.create(Z.attrs);return X.checkAttrs(J.attrs),J}static sameSet(Q,Z){if(Q==Z)return!0;if(Q.length!=Z.length)return!1;for(let X=0;X<Q.length;X++)if(!Q[X].eq(Z[X]))return!1;return!0}static setFrom(Q){if(!Q||Array.isArray(Q)&&Q.length==0)return b.none;if(Q instanceof b)return[Q];let Z=Q.slice();return Z.sort((X,J)=>X.type.rank-J.type.rank),Z}}b.none=[];class W1 extends Error{}class j{constructor(Q,Z,X){this.content=Q,this.openStart=Z,this.openEnd=X}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(Q,Z){let X=Z9(this.content,Q+this.openStart,Z);return X&&new j(X,this.openStart,this.openEnd)}removeBetween(Q,Z){return new j(Q9(this.content,Q+this.openStart,Z+this.openStart),this.openStart,this.openEnd)}eq(Q){return this.content.eq(Q.content)&&this.openStart==Q.openStart&&this.openEnd==Q.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let Q={content:this.content.toJSON()};if(this.openStart>0)Q.openStart=this.openStart;if(this.openEnd>0)Q.openEnd=this.openEnd;return Q}static fromJSON(Q,Z){if(!Z)return j.empty;let X=Z.openStart||0,J=Z.openEnd||0;if(typeof X!="number"||typeof J!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new j(P.fromJSON(Q,Z.content),X,J)}static maxOpen(Q,Z=!0){let X=0,J=0;for(let Y=Q.firstChild;Y&&!Y.isLeaf&&(Z||!Y.type.spec.isolating);Y=Y.firstChild)X++;for(let Y=Q.lastChild;Y&&!Y.isLeaf&&(Z||!Y.type.spec.isolating);Y=Y.lastChild)J++;return new j(Q,X,J)}}j.empty=new j(P.empty,0,0);class v1{constructor(Q,Z,X){this.pos=Q,this.path=Z,this.parentOffset=X,this.depth=Z.length/3-1}resolveDepth(Q){if(Q==null)return this.depth;if(Q<0)return this.depth+Q;return Q}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(Q){return this.path[this.resolveDepth(Q)*3]}index(Q){return this.path[this.resolveDepth(Q)*3+1]}indexAfter(Q){return Q=this.resolveDepth(Q),this.index(Q)+(Q==this.depth&&!this.textOffset?0:1)}start(Q){return Q=this.resolveDepth(Q),Q==0?0:this.path[Q*3-1]+1}end(Q){return Q=this.resolveDepth(Q),this.start(Q)+this.node(Q).content.size}before(Q){if(Q=this.resolveDepth(Q),!Q)throw new RangeError("There is no position before the top-level node");return Q==this.depth+1?this.pos:this.path[Q*3-1]}after(Q){if(Q=this.resolveDepth(Q),!Q)throw new RangeError("There is no position after the top-level node");return Q==this.depth+1?this.pos:this.path[Q*3-1]+this.path[Q*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let Q=this.parent,Z=this.index(this.depth);if(Z==Q.childCount)return null;let X=this.pos-this.path[this.path.length-1],J=Q.child(Z);return X?Q.child(Z).cut(X):J}get nodeBefore(){let Q=this.index(this.depth),Z=this.pos-this.path[this.path.length-1];if(Z)return this.parent.child(Q).cut(0,Z);return Q==0?null:this.parent.child(Q-1)}posAtIndex(Q,Z){Z=this.resolveDepth(Z);let X=this.path[Z*3],J=Z==0?0:this.path[Z*3-1]+1;for(let Y=0;Y<Q;Y++)J+=X.child(Y).nodeSize;return J}marks(){let Q=this.parent,Z=this.index();if(Q.content.size==0)return b.none;if(this.textOffset)return Q.child(Z).marks;let X=Q.maybeChild(Z-1),J=Q.maybeChild(Z);if(!X){let U=X;X=J,J=U}let Y=X.marks;for(var q=0;q<Y.length;q++)if(Y[q].type.spec.inclusive===!1&&(!J||!Y[q].isInSet(J.marks)))Y=Y[q--].removeFromSet(Y);return Y}marksAcross(Q){let Z=this.parent.maybeChild(this.index());if(!Z||!Z.isInline)return null;let X=Z.marks,J=Q.parent.maybeChild(Q.index());for(var Y=0;Y<X.length;Y++)if(X[Y].type.spec.inclusive===!1&&(!J||!X[Y].isInSet(J.marks)))X=X[Y--].removeFromSet(X);return X}sharedDepth(Q){for(let Z=this.depth;Z>0;Z--)if(this.start(Z)<=Q&&this.end(Z)>=Q)return Z;return 0}blockRange(Q=this,Z){if(Q.pos<this.pos)return Q.blockRange(this);for(let X=this.depth-(this.parent.inlineContent||this.pos==Q.pos?1:0);X>=0;X--)if(Q.pos<=this.end(X)&&(!Z||Z(this.node(X))))return new L1(this,Q,X);return null}sameParent(Q){return this.pos-this.parentOffset==Q.pos-Q.parentOffset}max(Q){return Q.pos>this.pos?Q:this}min(Q){return Q.pos<this.pos?Q:this}toString(){let Q="";for(let Z=1;Z<=this.depth;Z++)Q+=(Q?"/":"")+this.node(Z).type.name+"_"+this.index(Z-1);return Q+":"+this.parentOffset}static resolve(Q,Z){if(!(Z>=0&&Z<=Q.content.size))throw new RangeError("Position "+Z+" out of range");let X=[],J=0,Y=Z;for(let q=Q;;){let{index:U,offset:G}=q.content.findIndex(Y),z=Y-G;if(X.push(q,U,J+G),!z)break;if(q=q.child(U),q.isText)break;Y=z-1,J+=G+1}return new v1(Z,X,Y)}static resolveCached(Q,Z){let X=c7.get(Q);if(X)for(let Y=0;Y<X.elts.length;Y++){let q=X.elts[Y];if(q.pos==Z)return q}else c7.set(Q,X=new q9);let J=X.elts[X.i]=v1.resolve(Q,Z);return X.i=(X.i+1)%L2,J}}class q9{constructor(){this.elts=[],this.i=0}}var L2=12,c7=new WeakMap;class L1{constructor(Q,Z,X){this.$from=Q,this.$to=Z,this.depth=X}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}var B2=Object.create(null);class z0{constructor(Q,Z,X,J=b.none){this.type=Q,this.attrs=Z,this.marks=J,this.content=X||P.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(Q){return this.content.child(Q)}maybeChild(Q){return this.content.maybeChild(Q)}forEach(Q){this.content.forEach(Q)}nodesBetween(Q,Z,X,J=0){this.content.nodesBetween(Q,Z,X,J,this)}descendants(Q){this.nodesBetween(0,this.content.size,Q)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(Q,Z,X,J){return this.content.textBetween(Q,Z,X,J)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(Q){return this==Q||this.sameMarkup(Q)&&this.content.eq(Q.content)}sameMarkup(Q){return this.hasMarkup(Q.type,Q.attrs,Q.marks)}hasMarkup(Q,Z,X){return this.type==Q&&V5(this.attrs,Z||Q.defaultAttrs||B2)&&b.sameSet(this.marks,X||b.none)}copy(Q=null){if(Q==this.content)return this;return new z0(this.type,this.attrs,Q,this.marks)}mark(Q){return Q==this.marks?this:new z0(this.type,this.attrs,this.content,Q)}cut(Q,Z=this.content.size){if(Q==0&&Z==this.content.size)return this;return this.copy(this.content.cut(Q,Z))}slice(Q,Z=this.content.size,X=!1){if(Q==Z)return j.empty;let J=this.resolve(Q),Y=this.resolve(Z),q=X?0:J.sharedDepth(Z),U=J.start(q),z=J.node(q).content.cut(J.pos-U,Y.pos-U);return new j(z,J.depth-q,Y.depth-q)}replace(Q,Z,X){return H2(this.resolve(Q),this.resolve(Z),X)}nodeAt(Q){for(let Z=this;;){let{index:X,offset:J}=Z.content.findIndex(Q);if(Z=Z.maybeChild(X),!Z)return null;if(J==Q||Z.isText)return Z;Q-=J+1}}childAfter(Q){let{index:Z,offset:X}=this.content.findIndex(Q);return{node:this.content.maybeChild(Z),index:Z,offset:X}}childBefore(Q){if(Q==0)return{node:null,index:0,offset:0};let{index:Z,offset:X}=this.content.findIndex(Q);if(X<Q)return{node:this.content.child(Z),index:Z,offset:X};let J=this.content.child(Z-1);return{node:J,index:Z-1,offset:X-J.nodeSize}}resolve(Q){return v1.resolveCached(this,Q)}resolveNoCache(Q){return v1.resolve(this,Q)}rangeHasMark(Q,Z,X){let J=!1;if(Z>Q)this.nodesBetween(Q,Z,(Y)=>{if(X.isInSet(Y.marks))J=!0;return!J});return J}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let Q=this.type.name;if(this.content.size)Q+="("+this.content.toStringInner()+")";return U9(this.marks,Q)}contentMatchAt(Q){let Z=this.type.contentMatch.matchFragment(this.content,0,Q);if(!Z)throw new Error("Called contentMatchAt on a node with invalid content");return Z}canReplace(Q,Z,X=P.empty,J=0,Y=X.childCount){let q=this.contentMatchAt(Q).matchFragment(X,J,Y),U=q&&q.matchFragment(this.content,Z);if(!U||!U.validEnd)return!1;for(let G=J;G<Y;G++)if(!this.type.allowsMarks(X.child(G).marks))return!1;return!0}canReplaceWith(Q,Z,X,J){if(J&&!this.type.allowsMarks(J))return!1;let Y=this.contentMatchAt(Q).matchType(X),q=Y&&Y.matchFragment(this.content,Z);return q?q.validEnd:!1}canAppend(Q){if(Q.content.size)return this.canReplace(this.childCount,this.childCount,Q.content);else return this.type.compatibleContent(Q.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let Q=b.none;for(let Z=0;Z<this.marks.length;Z++){let X=this.marks[Z];X.type.checkAttrs(X.attrs),Q=X.addToSet(Q)}if(!b.sameSet(Q,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map((Z)=>Z.type.name)}`);this.content.forEach((Z)=>Z.check())}toJSON(){let Q={type:this.type.name};for(let Z in this.attrs){Q.attrs=this.attrs;break}if(this.content.size)Q.content=this.content.toJSON();if(this.marks.length)Q.marks=this.marks.map((Z)=>Z.toJSON());return Q}static fromJSON(Q,Z){if(!Z)throw new RangeError("Invalid input for Node.fromJSON");let X=void 0;if(Z.marks){if(!Array.isArray(Z.marks))throw new RangeError("Invalid mark data for Node.fromJSON");X=Z.marks.map(Q.markFromJSON)}if(Z.type=="text"){if(typeof Z.text!="string")throw new RangeError("Invalid text node in JSON");return Q.text(Z.text,X)}let J=P.fromJSON(Q,Z.content),Y=Q.nodeType(Z.type).create(Z.attrs,J,X);return Y.type.checkAttrs(Y.attrs),Y}}z0.prototype.text=void 0;class H5 extends z0{constructor(Q,Z,X,J){super(Q,Z,null,J);if(!X)throw new RangeError("Empty text nodes are not allowed");this.text=X}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);return U9(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(Q,Z){return this.text.slice(Q,Z)}get nodeSize(){return this.text.length}mark(Q){return Q==this.marks?this:new H5(this.type,this.attrs,this.text,Q)}withText(Q){if(Q==this.text)return this;return new H5(this.type,this.attrs,Q,this.marks)}cut(Q=0,Z=this.text.length){if(Q==0&&Z==this.text.length)return this;return this.withText(this.text.slice(Q,Z))}eq(Q){return this.sameMarkup(Q)&&this.text==Q.text}toJSON(){let Q=super.toJSON();return Q.text=this.text,Q}}class t0{constructor(Q){this.validEnd=Q,this.next=[],this.wrapCache=[]}static parse(Q,Z){let X=new G9(Q,Z);if(X.next==null)return t0.empty;let J=z9(X);if(X.next)X.err("Unexpected trailing text");let Y=A2(E2(J));return O2(Y,X),Y}matchType(Q){for(let Z=0;Z<this.next.length;Z++)if(this.next[Z].type==Q)return this.next[Z].next;return null}matchFragment(Q,Z=0,X=Q.childCount){let J=this;for(let Y=Z;J&&Y<X;Y++)J=J.matchType(Q.child(Y).type);return J}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let Q=0;Q<this.next.length;Q++){let{type:Z}=this.next[Q];if(!(Z.isText||Z.hasRequiredAttrs()))return Z}return null}compatible(Q){for(let Z=0;Z<this.next.length;Z++)for(let X=0;X<Q.next.length;X++)if(this.next[Z].type==Q.next[X].type)return!0;return!1}fillBefore(Q,Z=!1,X=0){let J=[this];function Y(q,U){let G=q.matchFragment(Q,X);if(G&&(!Z||G.validEnd))return P.from(U.map((z)=>z.createAndFill()));for(let z=0;z<q.next.length;z++){let{type:V,next:K}=q.next[z];if(!(V.isText||V.hasRequiredAttrs())&&J.indexOf(K)==-1){J.push(K);let H=Y(K,U.concat(V));if(H)return H}}return null}return Y(this,[])}findWrapping(Q){for(let X=0;X<this.wrapCache.length;X+=2)if(this.wrapCache[X]==Q)return this.wrapCache[X+1];let Z=this.computeWrapping(Q);return this.wrapCache.push(Q,Z),Z}computeWrapping(Q){let Z=Object.create(null),X=[{match:this,type:null,via:null}];while(X.length){let J=X.shift(),Y=J.match;if(Y.matchType(Q)){let q=[];for(let U=J;U.type;U=U.via)q.push(U.type);return q.reverse()}for(let q=0;q<Y.next.length;q++){let{type:U,next:G}=Y.next[q];if(!U.isLeaf&&!U.hasRequiredAttrs()&&!(U.name in Z)&&(!J.type||G.validEnd))X.push({match:U.contentMatch,type:U,via:J}),Z[U.name]=!0}}return null}get edgeCount(){return this.next.length}edge(Q){if(Q>=this.next.length)throw new RangeError(`There's no ${Q}th edge in this content match`);return this.next[Q]}toString(){let Q=[];function Z(X){Q.push(X);for(let J=0;J<X.next.length;J++)if(Q.indexOf(X.next[J].next)==-1)Z(X.next[J].next)}return Z(this),Q.map((X,J)=>{let Y=J+(X.validEnd?"*":" ")+" ";for(let q=0;q<X.next.length;q++)Y+=(q?", ":"")+X.next[q].type.name+"->"+Q.indexOf(X.next[q].next);return Y}).join("\n")}}t0.empty=new t0(!0);class G9{constructor(Q,Z){if(this.string=Q,this.nodeTypes=Z,this.inline=null,this.pos=0,this.tokens=Q.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]=="")this.tokens.pop();if(this.tokens[0]=="")this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(Q){return this.next==Q&&(this.pos++||!0)}err(Q){throw new SyntaxError(Q+" (in content expression '"+this.string+"')")}}class W5{constructor(Q,Z,X){this.name=Q,this.schema=Z,this.spec=X,this.markSet=null,this.groups=X.group?X.group.split(" "):[],this.attrs=L9(Q,X.attrs),this.defaultAttrs=K9(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(X.inline||Q=="text"),this.isText=Q=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==t0.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(Q){return this.groups.indexOf(Q)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let Q in this.attrs)if(this.attrs[Q].isRequired)return!0;return!1}compatibleContent(Q){return this==Q||this.contentMatch.compatible(Q.contentMatch)}computeAttrs(Q){if(!Q&&this.defaultAttrs)return this.defaultAttrs;else return H9(this.attrs,Q)}create(Q=null,Z,X){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new z0(this,this.computeAttrs(Q),P.from(Z),b.setFrom(X))}createChecked(Q=null,Z,X){return Z=P.from(Z),this.checkContent(Z),new z0(this,this.computeAttrs(Q),Z,b.setFrom(X))}createAndFill(Q=null,Z,X){if(Q=this.computeAttrs(Q),Z=P.from(Z),Z.size){let q=this.contentMatch.fillBefore(Z);if(!q)return null;Z=q.append(Z)}let J=this.contentMatch.matchFragment(Z),Y=J&&J.fillBefore(P.empty,!0);if(!Y)return null;return new z0(this,Q,Z.append(Y),b.setFrom(X))}validContent(Q){let Z=this.contentMatch.matchFragment(Q);if(!Z||!Z.validEnd)return!1;for(let X=0;X<Q.childCount;X++)if(!this.allowsMarks(Q.child(X).marks))return!1;return!0}checkContent(Q){if(!this.validContent(Q))throw new RangeError(`Invalid content for node ${this.name}: ${Q.toString().slice(0,50)}`)}checkAttrs(Q){W9(this.attrs,Q,"node",this.name)}allowsMarkType(Q){return this.markSet==null||this.markSet.indexOf(Q)>-1}allowsMarks(Q){if(this.markSet==null)return!0;for(let Z=0;Z<Q.length;Z++)if(!this.allowsMarkType(Q[Z].type))return!1;return!0}allowedMarks(Q){if(this.markSet==null)return Q;let Z;for(let X=0;X<Q.length;X++)if(!this.allowsMarkType(Q[X].type)){if(!Z)Z=Q.slice(0,X)}else if(Z)Z.push(Q[X]);return!Z?Q:Z.length?Z:b.none}static compile(Q,Z){let X=Object.create(null);Q.forEach((Y,q)=>X[Y]=new W5(Y,Z,q));let J=Z.spec.topNode||"doc";if(!X[J])throw new RangeError("Schema is missing its top node type ('"+J+"')");if(!X.text)throw new RangeError("Every schema needs a 'text' type");for(let Y in X.text.attrs)throw new RangeError("The text node type should not have attributes");return X}}class B9{constructor(Q,Z,X){this.hasDefault=Object.prototype.hasOwnProperty.call(X,"default"),this.default=X.default,this.validate=typeof X.validate=="string"?R2(Q,Z,X.validate):X.validate}get isRequired(){return!this.hasDefault}}class h1{constructor(Q,Z,X,J){this.name=Q,this.rank=Z,this.schema=X,this.spec=J,this.attrs=L9(Q,J.attrs),this.excluded=null;let Y=K9(this.attrs);this.instance=Y?new b(this,Y):null}create(Q=null){if(!Q&&this.instance)return this.instance;return new b(this,H9(this.attrs,Q))}static compile(Q,Z){let X=Object.create(null),J=0;return Q.forEach((Y,q)=>X[Y]=new h1(Y,J++,Z,q)),X}removeFromSet(Q){for(var Z=0;Z<Q.length;Z++)if(Q[Z].type==this)Q=Q.slice(0,Z).concat(Q.slice(Z+1)),Z--;return Q}isInSet(Q){for(let Z=0;Z<Q.length;Z++)if(Q[Z].type==this)return Q[Z]}checkAttrs(Q){W9(this.attrs,Q,"mark",this.name)}excludes(Q){return this.excluded.indexOf(Q)>-1}}class L5{constructor(Q){this.linebreakReplacement=null,this.cached=Object.create(null);let Z=this.spec={};for(let J in Q)Z[J]=Q[J];Z.nodes=X6.from(Q.nodes),Z.marks=X6.from(Q.marks||{}),this.nodes=W5.compile(this.spec.nodes,this),this.marks=h1.compile(this.spec.marks,this);let X=Object.create(null);for(let J in this.nodes){if(J in this.marks)throw new RangeError(J+" can not be both a node and a mark");let Y=this.nodes[J],q=Y.spec.content||"",U=Y.spec.marks;if(Y.contentMatch=X[q]||(X[q]=t0.parse(q,this.nodes)),Y.inlineContent=Y.contentMatch.inlineContent,Y.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!Y.isInline||!Y.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=Y}Y.markSet=U=="_"?null:U?i7(this,U.split(" ")):U==""||!Y.inlineContent?[]:null}for(let J in this.marks){let Y=this.marks[J],q=Y.spec.excludes;Y.excluded=q==null?[Y]:q==""?[]:i7(this,q.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(Q,Z=null,X,J){if(typeof Q=="string")Q=this.nodeType(Q);else if(!(Q instanceof W5))throw new RangeError("Invalid node type: "+Q);else if(Q.schema!=this)throw new RangeError("Node type from different schema used ("+Q.name+")");return Q.createChecked(Z,X,J)}text(Q,Z){let X=this.nodes.text;return new H5(X,X.defaultAttrs,Q,b.setFrom(Z))}mark(Q,Z){if(typeof Q=="string")Q=this.marks[Q];return Q.create(Z)}nodeFromJSON(Q){return z0.fromJSON(this,Q)}markFromJSON(Q){return b.fromJSON(this,Q)}nodeType(Q){let Z=this.nodes[Q];if(!Z)throw new RangeError("Unknown node type: "+Q);return Z}}class j0{constructor(Q,Z){this.schema=Q,this.rules=Z,this.tags=[],this.styles=[];let X=this.matchedStyles=[];Z.forEach((J)=>{if(N2(J))this.tags.push(J);else if(D2(J)){let Y=/[^=]*/.exec(J.style)[0];if(X.indexOf(Y)<0)X.push(Y);this.styles.push(J)}}),this.normalizeLists=!this.tags.some((J)=>{if(!/^(ul|ol)\b/.test(J.tag)||!J.node)return!1;let Y=Q.nodes[J.node];return Y.contentMatch.matchType(Y)})}parse(Q,Z={}){let X=new G6(this,Z,!1);return X.addAll(Q,b.none,Z.from,Z.to),X.finish()}parseSlice(Q,Z={}){let X=new G6(this,Z,!0);return X.addAll(Q,b.none,Z.from,Z.to),j.maxOpen(X.finish())}matchTag(Q,Z,X){for(let J=X?this.tags.indexOf(X)+1:0;J<this.tags.length;J++){let Y=this.tags[J];if(T2(Q,Y.tag)&&(Y.namespace===void 0||Q.namespaceURI==Y.namespace)&&(!Y.context||Z.matchesContext(Y.context))){if(Y.getAttrs){let q=Y.getAttrs(Q);if(q===!1)continue;Y.attrs=q||void 0}return Y}}}matchStyle(Q,Z,X,J){for(let Y=J?this.styles.indexOf(J)+1:0;Y<this.styles.length;Y++){let q=this.styles[Y],U=q.style;if(U.indexOf(Q)!=0||q.context&&!X.matchesContext(q.context)||U.length>Q.length&&(U.charCodeAt(Q.length)!=61||U.slice(Q.length+1)!=Z))continue;if(q.getAttrs){let G=q.getAttrs(Z);if(G===!1)continue;q.attrs=G||void 0}return q}}static schemaRules(Q){let Z=[];function X(J){let Y=J.priority==null?50:J.priority,q=0;for(;q<Z.length;q++){let U=Z[q];if((U.priority==null?50:U.priority)<Y)break}Z.splice(q,0,J)}for(let J in Q.marks){let Y=Q.marks[J].spec.parseDOM;if(Y)Y.forEach((q)=>{if(X(q=a7(q)),!(q.mark||q.ignore||q.clearMark))q.mark=J})}for(let J in Q.nodes){let Y=Q.nodes[J].spec.parseDOM;if(Y)Y.forEach((q)=>{if(X(q=a7(q)),!(q.node||q.ignore||q.mark))q.node=J})}return Z}static fromSchema(Q){return Q.cached.domParser||(Q.cached.domParser=new j0(Q,j0.schemaRules(Q)))}}var _9={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},M2={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},I9={ol:!0,ul:!0},f1=1,U6=2,u1=4;class g1{constructor(Q,Z,X,J,Y,q){this.type=Q,this.attrs=Z,this.marks=X,this.solid=J,this.options=q,this.content=[],this.activeMarks=b.none,this.match=Y||(q&u1?null:Q.contentMatch)}findWrapping(Q){if(!this.match){if(!this.type)return[];let Z=this.type.contentMatch.fillBefore(P.from(Q));if(Z)this.match=this.type.contentMatch.matchFragment(Z);else{let X=this.type.contentMatch,J;if(J=X.findWrapping(Q.type))return this.match=X,J;else return null}}return this.match.findWrapping(Q.type)}finish(Q){if(!(this.options&f1)){let X=this.content[this.content.length-1],J;if(X&&X.isText&&(J=/[ \t\r\n\u000c]+$/.exec(X.text))){let Y=X;if(X.text.length==J[0].length)this.content.pop();else this.content[this.content.length-1]=Y.withText(Y.text.slice(0,Y.text.length-J[0].length))}}let Z=P.from(this.content);if(!Q&&this.match)Z=Z.append(this.match.fillBefore(P.empty,!0));return this.type?this.type.create(this.attrs,Z,this.marks):Z}inlineContext(Q){if(this.type)return this.type.inlineContent;if(this.content.length)return this.content[0].isInline;return Q.parentNode&&!_9.hasOwnProperty(Q.parentNode.nodeName.toLowerCase())}}class G6{constructor(Q,Z,X){this.parser=Q,this.options=Z,this.isOpen=X,this.open=0,this.localPreserveWS=!1;let J=Z.topNode,Y,q=s7(null,Z.preserveWhitespace,0)|(X?u1:0);if(J)Y=new g1(J.type,J.attrs,b.none,!0,Z.topMatch||J.type.contentMatch,q);else if(X)Y=new g1(null,null,b.none,!0,null,q);else Y=new g1(Q.schema.topNodeType,null,b.none,!0,null,q);this.nodes=[Y],this.find=Z.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(Q,Z){if(Q.nodeType==3)this.addTextNode(Q,Z);else if(Q.nodeType==1)this.addElement(Q,Z)}addTextNode(Q,Z){let X=Q.nodeValue,J=this.top,Y=J.options&U6?"full":this.localPreserveWS||(J.options&f1)>0;if(Y==="full"||J.inlineContext(Q)||/[^ \t\r\n\u000c]/.test(X)){if(!Y){if(X=X.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(X)&&this.open==this.nodes.length-1){let q=J.content[J.content.length-1],U=Q.previousSibling;if(!q||U&&U.nodeName=="BR"||q.isText&&/[ \t\r\n\u000c]$/.test(q.text))X=X.slice(1)}}else if(Y!=="full")X=X.replace(/\r?\n|\r/g," ");else X=X.replace(/\r\n?/g,"\n");if(X)this.insertNode(this.parser.schema.text(X),Z);this.findInText(Q)}else this.findInside(Q)}addElement(Q,Z,X){let J=this.localPreserveWS,Y=this.top;if(Q.tagName=="PRE"||/pre/.test(Q.style&&Q.style.whiteSpace))this.localPreserveWS=!0;let q=Q.nodeName.toLowerCase(),U;if(I9.hasOwnProperty(q)&&this.parser.normalizeLists)C2(Q);let G=this.options.ruleFromNode&&this.options.ruleFromNode(Q)||(U=this.parser.matchTag(Q,this,X));Q:if(G?G.ignore:M2.hasOwnProperty(q))this.findInside(Q),this.ignoreFallback(Q,Z);else if(!G||G.skip||G.closeParent){if(G&&G.closeParent)this.open=Math.max(0,this.open-1);else if(G&&G.skip.nodeType)Q=G.skip;let z,V=this.needsBlock;if(_9.hasOwnProperty(q)){if(Y.content.length&&Y.content[0].isInline&&this.open)this.open--,Y=this.top;if(z=!0,!Y.type)this.needsBlock=!0}else if(!Q.firstChild){this.leafFallback(Q,Z);break Q}let K=G&&G.skip?Z:this.readStyles(Q,Z);if(K)this.addAll(Q,K);if(z)this.sync(Y);this.needsBlock=V}else{let z=this.readStyles(Q,Z);if(z)this.addElementByRule(Q,G,z,G.consuming===!1?U:void 0)}this.localPreserveWS=J}leafFallback(Q,Z){if(Q.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent)this.addTextNode(Q.ownerDocument.createTextNode("\n"),Z)}ignoreFallback(Q,Z){if(Q.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent))this.findPlace(this.parser.schema.text("-"),Z)}readStyles(Q,Z){let X=Q.style;if(X&&X.length)for(let J=0;J<this.parser.matchedStyles.length;J++){let Y=this.parser.matchedStyles[J],q=X.getPropertyValue(Y);if(q)for(let U=void 0;;){let G=this.parser.matchStyle(Y,q,this,U);if(!G)break;if(G.ignore)return null;if(G.clearMark)Z=Z.filter((z)=>!G.clearMark(z));else Z=Z.concat(this.parser.schema.marks[G.mark].create(G.attrs));if(G.consuming===!1)U=G;else break}}return Z}addElementByRule(Q,Z,X,J){let Y,q;if(Z.node){if(q=this.parser.schema.nodes[Z.node],!q.isLeaf){let G=this.enter(q,Z.attrs||null,X,Z.preserveWhitespace);if(G)Y=!0,X=G}else if(!this.insertNode(q.create(Z.attrs),X))this.leafFallback(Q,X)}else{let G=this.parser.schema.marks[Z.mark];X=X.concat(G.create(Z.attrs))}let U=this.top;if(q&&q.isLeaf)this.findInside(Q);else if(J)this.addElement(Q,X,J);else if(Z.getContent)this.findInside(Q),Z.getContent(Q,this.parser.schema).forEach((G)=>this.insertNode(G,X));else{let G=Q;if(typeof Z.contentElement=="string")G=Q.querySelector(Z.contentElement);else if(typeof Z.contentElement=="function")G=Z.contentElement(Q);else if(Z.contentElement)G=Z.contentElement;this.findAround(Q,G,!0),this.addAll(G,X),this.findAround(Q,G,!1)}if(Y&&this.sync(U))this.open--}addAll(Q,Z,X,J){let Y=X||0;for(let q=X?Q.childNodes[X]:Q.firstChild,U=J==null?null:Q.childNodes[J];q!=U;q=q.nextSibling,++Y)this.findAtPoint(Q,Y),this.addDOM(q,Z);this.findAtPoint(Q,Y)}findPlace(Q,Z){let X,J;for(let Y=this.open;Y>=0;Y--){let q=this.nodes[Y],U=q.findWrapping(Q);if(U&&(!X||X.length>U.length)){if(X=U,J=q,!U.length)break}if(q.solid)break}if(!X)return null;this.sync(J);for(let Y=0;Y<X.length;Y++)Z=this.enterInner(X[Y],null,Z,!1);return Z}insertNode(Q,Z){if(Q.isInline&&this.needsBlock&&!this.top.type){let J=this.textblockFromContext();if(J)Z=this.enterInner(J,null,Z)}let X=this.findPlace(Q,Z);if(X){this.closeExtra();let J=this.top;if(J.match)J.match=J.match.matchType(Q.type);let Y=b.none;for(let q of X.concat(Q.marks))if(J.type?J.type.allowsMarkType(q.type):n7(q.type,Q.type))Y=q.addToSet(Y);return J.content.push(Q.mark(Y)),!0}return!1}enter(Q,Z,X,J){let Y=this.findPlace(Q.create(Z),X);if(Y)Y=this.enterInner(Q,Z,X,!0,J);return Y}enterInner(Q,Z,X,J=!1,Y){this.closeExtra();let q=this.top;q.match=q.match&&q.match.matchType(Q);let U=s7(Q,Y,q.options);if(q.options&u1&&q.content.length==0)U|=u1;let G=b.none;return X=X.filter((z)=>{if(q.type?q.type.allowsMarkType(z.type):n7(z.type,Q))return G=z.addToSet(G),!1;return!0}),this.nodes.push(new g1(Q,Z,G,J,null,U)),this.open++,X}closeExtra(Q=!1){let Z=this.nodes.length-1;if(Z>this.open){for(;Z>this.open;Z--)this.nodes[Z-1].content.push(this.nodes[Z].finish(Q));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(Q){for(let Z=this.open;Z>=0;Z--)if(this.nodes[Z]==Q)return this.open=Z,!0;else if(this.localPreserveWS)this.nodes[Z].options|=f1;return!1}get currentPos(){this.closeExtra();let Q=0;for(let Z=this.open;Z>=0;Z--){let X=this.nodes[Z].content;for(let J=X.length-1;J>=0;J--)Q+=X[J].nodeSize;if(Z)Q++}return Q}findAtPoint(Q,Z){if(this.find){for(let X=0;X<this.find.length;X++)if(this.find[X].node==Q&&this.find[X].offset==Z)this.find[X].pos=this.currentPos}}findInside(Q){if(this.find){for(let Z=0;Z<this.find.length;Z++)if(this.find[Z].pos==null&&Q.nodeType==1&&Q.contains(this.find[Z].node))this.find[Z].pos=this.currentPos}}findAround(Q,Z,X){if(Q!=Z&&this.find){for(let J=0;J<this.find.length;J++)if(this.find[J].pos==null&&Q.nodeType==1&&Q.contains(this.find[J].node)){if(Z.compareDocumentPosition(this.find[J].node)&(X?2:4))this.find[J].pos=this.currentPos}}}findInText(Q){if(this.find){for(let Z=0;Z<this.find.length;Z++)if(this.find[Z].node==Q)this.find[Z].pos=this.currentPos-(Q.nodeValue.length-this.find[Z].offset)}}matchesContext(Q){if(Q.indexOf("|")>-1)return Q.split(/\s*\|\s*/).some(this.matchesContext,this);let Z=Q.split("/"),X=this.options.context,J=!this.isOpen&&(!X||X.parent.type==this.nodes[0].type),Y=-(X?X.depth+1:0)+(J?0:1),q=(U,G)=>{for(;U>=0;U--){let z=Z[U];if(z==""){if(U==Z.length-1||U==0)continue;for(;G>=Y;G--)if(q(U-1,G))return!0;return!1}else{let V=G>0||G==0&&J?this.nodes[G].type:X&&G>=Y?X.node(G-Y).type:null;if(!V||V.name!=z&&!V.isInGroup(z))return!1;G--}}return!0};return q(Z.length-1,this.open)}textblockFromContext(){let Q=this.options.context;if(Q)for(let Z=Q.depth;Z>=0;Z--){let X=Q.node(Z).contentMatchAt(Q.indexAfter(Z)).defaultType;if(X&&X.isTextblock&&X.defaultAttrs)return X}for(let Z in this.parser.schema.nodes){let X=this.parser.schema.nodes[Z];if(X.isTextblock&&X.defaultAttrs)return X}}}class C0{constructor(Q,Z){this.nodes=Q,this.marks=Z}serializeFragment(Q,Z={},X){if(!X)X=Y6(Z).createDocumentFragment();let J=X,Y=[];return Q.forEach((q)=>{if(Y.length||q.marks.length){let U=0,G=0;while(U<Y.length&&G<q.marks.length){let z=q.marks[G];if(!this.marks[z.type.name]){G++;continue}if(!z.eq(Y[U][0])||z.type.spec.spanning===!1)break;U++,G++}while(U<Y.length)J=Y.pop()[1];while(G<q.marks.length){let z=q.marks[G++],V=this.serializeMark(z,q.isInline,Z);if(V)Y.push([z,J]),J.appendChild(V.dom),J=V.contentDOM||V.dom}}J.appendChild(this.serializeNodeInner(q,Z))}),X}serializeNodeInner(Q,Z){let{dom:X,contentDOM:J}=z5(Y6(Z),this.nodes[Q.type.name](Q),null,Q.attrs);if(J){if(Q.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(Q.content,Z,J)}return X}serializeNode(Q,Z={}){let X=this.serializeNodeInner(Q,Z);for(let J=Q.marks.length-1;J>=0;J--){let Y=this.serializeMark(Q.marks[J],Q.isInline,Z);if(Y)(Y.contentDOM||Y.dom).appendChild(X),X=Y.dom}return X}serializeMark(Q,Z,X={}){let J=this.marks[Q.type.name];return J&&z5(Y6(X),J(Q,Z),null,Q.attrs)}static renderSpec(Q,Z,X=null,J){return z5(Q,Z,X,J)}static fromSchema(Q){return Q.cached.domSerializer||(Q.cached.domSerializer=new C0(this.nodesFromSchema(Q),this.marksFromSchema(Q)))}static nodesFromSchema(Q){let Z=r7(Q.nodes);if(!Z.text)Z.text=(X)=>X.text;return Z}static marksFromSchema(Q){return r7(Q.marks)}}var o7=new WeakMap;var y2=function(Q,Z){return Q+Z*E9},F9=function(Q){return Q&j9},b2=function(Q){return(Q-(Q&j9))/E9},W6=function(Q,Z,X){let J=[];for(let Y=0;Y<Q.childCount;Y++){let q=Q.child(Y);if(q.content.size)q=q.copy(W6(q.content,Z,q));if(q.isInline)q=Z(q,X,Y);J.push(q)}return P.fromArray(J)},H6=function(Q,Z,X){let J=Q.resolve(Z),Y=X-Z,q=J.depth;while(Y>0&&q>0&&J.indexAfter(q)==J.node(q).childCount)q--,Y--;if(Y>0){let U=J.node(q).maybeChild(J.indexAfter(q));while(Y>0){if(!U||U.isLeaf)return!0;U=U.firstChild,Y--}}return!1},$2=function(Q,Z,X,J){let Y=[],q=[],U,G;Q.doc.nodesBetween(Z,X,(z,V,K)=>{if(!z.isInline)return;let H=z.marks;if(!J.isInSet(H)&&K.type.allowsMarkType(J.type)){let W=Math.max(V,Z),B=Math.min(V+z.nodeSize,X),L=J.addToSet(H);for(let _=0;_<H.length;_++)if(!H[_].isInSet(L))if(U&&U.to==W&&U.mark.eq(H[_]))U.to=B;else Y.push(U=new E0(W,B,H[_]));if(G&&G.to==W)G.to=B;else q.push(G=new w0(W,B,J))}}),Y.forEach((z)=>Q.step(z)),q.forEach((z)=>Q.step(z))},x2=function(Q,Z,X,J){let Y=[],q=0;Q.doc.nodesBetween(Z,X,(U,G)=>{if(!U.isInline)return;q++;let z=null;if(J instanceof h1){let V=U.marks,K;while(K=J.isInSet(V))(z||(z=[])).push(K),V=K.removeFromSet(V)}else if(J){if(J.isInSet(U.marks))z=[J]}else z=U.marks;if(z&&z.length){let V=Math.min(G+U.nodeSize,X);for(let K=0;K<z.length;K++){let H=z[K],W;for(let B=0;B<Y.length;B++){let L=Y[B];if(L.step==q-1&&H.eq(Y[B].style))W=L}if(W)W.to=V,W.step=q;else Y.push({style:H,from:Math.max(G,Z),to:V,step:q})}}}),Y.forEach((U)=>Q.step(new E0(U.from,U.to,U.style)))},L6=function(Q,Z,X,J=X.contentMatch,Y=!0){let q=Q.doc.nodeAt(Z),U=[],G=Z+1;for(let z=0;z<q.childCount;z++){let V=q.child(z),K=G+V.nodeSize,H=J.matchType(V.type);if(!H)U.push(new h(G,K,j.empty));else{J=H;for(let W=0;W<V.marks.length;W++)if(!X.allowsMarkType(V.marks[W].type))Q.step(new E0(G,K,V.marks[W]));if(Y&&V.isText&&X.whitespace!="pre"){let W,B=/\r?\n|\r/g,L;while(W=B.exec(V.text)){if(!L)L=new j(P.from(X.schema.text(" ",X.allowedMarks(V.marks))),0,0);U.push(new h(G+W.index,G+W.index+W[0].length,L))}}}G=K}if(!J.validEnd){let z=J.fillBefore(P.empty,!0);Q.replace(G,G,new j(z,0,0))}for(let z=U.length-1;z>=0;z--)Q.step(U[z])},g2=function(Q,Z,X){return(Z==0||Q.canReplace(Z,Q.childCount))&&(X==Q.childCount||Q.canReplace(0,X))},T0=function(Q){let X=Q.parent.content.cutByIndex(Q.startIndex,Q.endIndex);for(let J=Q.depth;;--J){let Y=Q.$from.node(J),q=Q.$from.index(J),U=Q.$to.indexAfter(J);if(J<Q.depth&&Y.canReplace(q,U,X))return J;if(J==0||Y.type.spec.isolating||!g2(Y,q,U))break}return null},w2=function(Q,Z,X){let{$from:J,$to:Y,depth:q}=Z,U=J.before(q+1),G=Y.after(q+1),z=U,V=G,K=P.empty,H=0;for(let L=q,_=!1;L>X;L--)if(_||J.index(L)>0)_=!0,K=P.from(J.node(L).copy(K)),H++;else z--;let W=P.empty,B=0;for(let L=q,_=!1;L>X;L--)if(_||Y.after(L+1)<Y.end(L))_=!0,W=P.from(Y.node(L).copy(W)),B++;else V++;Q.step(new u(z,V,U,G,new j(K.append(W),H,B),K.size-H,!0))},P1=function(Q,Z,X=null,J=Q){let Y=u2(Q,Z),q=Y&&v2(J,Z);if(!q)return null;return Y.map(P9).concat({type:Z,attrs:X}).concat(q.map(P9))},P9=function(Q){return{type:Q,attrs:null}},u2=function(Q,Z){let{parent:X,startIndex:J,endIndex:Y}=Q,q=X.contentMatchAt(J).findWrapping(Z);if(!q)return null;let U=q.length?q[0]:Z;return X.canReplaceWith(J,Y,U)?q:null},v2=function(Q,Z){let{parent:X,startIndex:J,endIndex:Y}=Q,q=X.child(J),U=Z.contentMatch.findWrapping(q.type);if(!U)return null;let z=(U.length?U[U.length-1]:Z).contentMatch;for(let V=J;z&&V<Y;V++)z=z.matchType(X.child(V).type);if(!z||!z.validEnd)return null;return U},f2=function(Q,Z,X){let J=P.empty;for(let U=X.length-1;U>=0;U--){if(J.size){let G=X[U].type.contentMatch.matchFragment(J);if(!G||!G.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}J=P.from(X[U].type.create(X[U].attrs,J))}let{start:Y,end:q}=Z;Q.step(new u(Y,q,Y,q,new j(J,0,0),X.length,!0))},h2=function(Q,Z,X,J,Y){if(!J.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let q=Q.steps.length;Q.doc.nodesBetween(Z,X,(U,G)=>{let z=typeof Y=="function"?Y(U):Y;if(U.isTextblock&&!U.hasMarkup(J,z)&&m2(Q.doc,Q.mapping.slice(q).map(G),J)){let V=null;if(J.schema.linebreakReplacement){let B=J.whitespace=="pre",L=!!J.contentMatch.matchType(J.schema.linebreakReplacement);if(B&&!L)V=!1;else if(!B&&L)V=!0}if(V===!1)D9(Q,U,G,q);L6(Q,Q.mapping.slice(q).map(G,1),J,void 0,V===null);let K=Q.mapping.slice(q),H=K.map(G,1),W=K.map(G+U.nodeSize,1);if(Q.step(new u(H,W,H+1,W-1,new j(P.from(J.create(z,null,U.marks)),0,0),1,!0)),V===!0)N9(Q,U,G,q);return!1}})},N9=function(Q,Z,X,J){Z.forEach((Y,q)=>{if(Y.isText){let U,G=/\r?\n|\r/g;while(U=G.exec(Y.text)){let z=Q.mapping.slice(J).map(X+1+q+U.index);Q.replaceWith(z,z+1,Z.type.schema.linebreakReplacement.create())}}})},D9=function(Q,Z,X,J){Z.forEach((Y,q)=>{if(Y.type==Y.type.schema.linebreakReplacement){let U=Q.mapping.slice(J).map(X+1+q);Q.replaceWith(U,U+1,Z.type.schema.text("\n"))}})},m2=function(Q,Z,X){let J=Q.resolve(Z),Y=J.index();return J.parent.canReplaceWith(Y,Y+1,X)},l2=function(Q,Z,X,J,Y){let q=Q.doc.nodeAt(Z);if(!q)throw new RangeError("No node at given position");if(!X)X=q.type;let U=X.create(J,null,Y||q.marks);if(q.isLeaf)return Q.replaceWith(Z,Z+q.nodeSize,U);if(!X.validContent(q.content))throw new RangeError("Invalid content for node type "+X.name);Q.step(new u(Z,Z+q.nodeSize,Z+1,Z+q.nodeSize-1,new j(P.from(U),0,0),1,!0))},H0=function(Q,Z,X=1,J){let Y=Q.resolve(Z),q=Y.depth-X,U=J&&J[J.length-1]||Y.parent;if(q<0||Y.parent.type.spec.isolating||!Y.parent.canReplace(Y.index(),Y.parent.childCount)||!U.type.validContent(Y.parent.content.cutByIndex(Y.index(),Y.parent.childCount)))return!1;for(let V=Y.depth-1,K=X-2;V>q;V--,K--){let H=Y.node(V),W=Y.index(V);if(H.type.spec.isolating)return!1;let B=H.content.cutByIndex(W,H.childCount),L=J&&J[K+1];if(L)B=B.replaceChild(0,L.type.create(L.attrs));let _=J&&J[K]||H;if(!H.canReplace(W+1,H.childCount)||!_.type.validContent(B))return!1}let G=Y.indexAfter(q),z=J&&J[0];return Y.node(q).canReplaceWith(G,G,z?z.type:Y.node(q+1).type)},c2=function(Q,Z,X=1,J){let Y=Q.doc.resolve(Z),q=P.empty,U=P.empty;for(let G=Y.depth,z=Y.depth-X,V=X-1;G>z;G--,V--){q=P.from(Y.node(G).copy(q));let K=J&&J[V];U=P.from(K?K.type.create(K.attrs,U):Y.node(G).copy(U))}Q.step(new h(Z,Z,new j(q.append(U),X,X),!0))},_0=function(Q,Z){let X=Q.resolve(Z),J=X.index();return M9(X.nodeBefore,X.nodeAfter)&&X.parent.canReplace(J,J+1)},p2=function(Q,Z){if(!Z.content.size)Q.type.compatibleContent(Z.type);let X=Q.contentMatchAt(Q.childCount),{linebreakReplacement:J}=Q.type.schema;for(let Y=0;Y<Z.childCount;Y++){let q=Z.child(Y),U=q.type==J?Q.type.schema.nodes.text:q.type;if(X=X.matchType(U),!X)return!1;if(!Q.type.allowsMarks(q.marks))return!1}return X.validEnd},M9=function(Q,Z){return!!(Q&&Z&&!Q.isLeaf&&p2(Q,Z))},j1=function(Q,Z,X=-1){let J=Q.resolve(Z);for(let Y=J.depth;;Y--){let q,U,G=J.index(Y);if(Y==J.depth)q=J.nodeBefore,U=J.nodeAfter;else if(X>0)q=J.node(Y+1),G++,U=J.node(Y).maybeChild(G);else q=J.node(Y).maybeChild(G-1),U=J.node(Y+1);if(q&&!q.isTextblock&&M9(q,U)&&J.node(Y).canReplace(G,G+1))return Z;if(Y==0)break;Z=X<0?J.before(Y):J.after(Y)}},d2=function(Q,Z,X){let J=null,{linebreakReplacement:Y}=Q.doc.type.schema,q=Q.doc.resolve(Z-X),U=q.node().type;if(Y&&U.inlineContent){let K=U.whitespace=="pre",H=!!U.contentMatch.matchType(Y);if(K&&!H)J=!1;else if(!K&&H)J=!0}let G=Q.steps.length;if(J===!1){let K=Q.doc.resolve(Z+X);D9(Q,K.node(),K.before(),G)}if(U.inlineContent)L6(Q,Z+X-1,U,q.node().contentMatchAt(q.index()),J==null);let z=Q.mapping.slice(G),V=z.map(Z-X);if(Q.step(new h(V,z.map(Z+X,-1),j.empty,!0)),J===!0){let K=Q.doc.resolve(V);N9(Q,K.node(),K.before(),Q.steps.length)}return Q},i2=function(Q,Z,X){let J=Q.resolve(Z);if(J.parent.canReplaceWith(J.index(),J.index(),X))return Z;if(J.parentOffset==0)for(let Y=J.depth-1;Y>=0;Y--){let q=J.index(Y);if(J.node(Y).canReplaceWith(q,q,X))return J.before(Y+1);if(q>0)return null}if(J.parentOffset==J.parent.content.size)for(let Y=J.depth-1;Y>=0;Y--){let q=J.indexAfter(Y);if(J.node(Y).canReplaceWith(q,q,X))return J.after(Y+1);if(q<J.node(Y).childCount)return null}return null},I5=function(Q,Z,X){let J=Q.resolve(Z);if(!X.content.size)return Z;let Y=X.content;for(let q=0;q<X.openStart;q++)Y=Y.firstChild.content;for(let q=1;q<=(X.openStart==0&&X.size?2:1);q++)for(let U=J.depth;U>=0;U--){let G=U==J.depth?0:J.pos<=(J.start(U+1)+J.end(U+1))/2?-1:1,z=J.index(U)+(G>0?1:0),V=J.node(U),K=!1;if(q==1)K=V.canReplace(z,z,Y);else{let H=V.contentMatchAt(z).findWrapping(Y.firstChild.type);K=H&&V.canReplaceWith(z,z,H[0])}if(K)return G==0?J.pos:G<0?J.before(U+1):J.after(U+1)}return null},p1=function(Q,Z,X=Z,J=j.empty){if(Z==X&&!J.size)return null;let Y=Q.resolve(Z),q=Q.resolve(X);if(C9(Y,q,J))return new h(Z,X,J);return new T9(Y,q,J).fit()},C9=function(Q,Z,X){return!X.openStart&&!X.openEnd&&Q.start()==Z.start()&&Q.parent.canReplace(Q.index(),Z.index(),X.content)},m1=function(Q,Z,X){if(Z==0)return Q.cutByIndex(X,Q.childCount);return Q.replaceChild(0,Q.firstChild.copy(m1(Q.firstChild.content,Z-1,X)))},l1=function(Q,Z,X){if(Z==0)return Q.append(X);return Q.replaceChild(Q.childCount-1,Q.lastChild.copy(l1(Q.lastChild.content,Z-1,X)))},V6=function(Q,Z){for(let X=0;X<Z;X++)Q=Q.firstChild.content;return Q},k9=function(Q,Z,X){if(Z<=0)return Q;let J=Q.content;if(Z>1)J=J.replaceChild(0,k9(J.firstChild,Z-1,J.childCount==1?X-1:0));if(Z>0){if(J=Q.type.contentMatch.fillBefore(J).append(J),X<=0)J=J.append(Q.type.contentMatch.matchFragment(J).fillBefore(P.empty,!0))}return Q.copy(J)},K6=function(Q,Z,X,J,Y){let q=Q.node(Z),U=Y?Q.indexAfter(Z):Q.index(Z);if(U==q.childCount&&!X.compatibleContent(q.type))return null;let G=J.fillBefore(q.content,!0,U);return G&&!s2(X,q.content,U)?G:null},s2=function(Q,Z,X){for(let J=X;J<Z.childCount;J++)if(!Q.allowsMarks(Z.child(J).marks))return!0;return!1},a2=function(Q){return Q.spec.defining||Q.spec.definingForContent},n2=function(Q,Z,X,J){if(!J.size)return Q.deleteRange(Z,X);let Y=Q.doc.resolve(Z),q=Q.doc.resolve(X);if(C9(Y,q,J))return Q.step(new h(Z,X,J));let U=y9(Y,Q.doc.resolve(X));if(U[U.length-1]==0)U.pop();let G=-(Y.depth+1);U.unshift(G);for(let W=Y.depth,B=Y.pos-1;W>0;W--,B--){let L=Y.node(W).type.spec;if(L.defining||L.definingAsContext||L.isolating)break;if(U.indexOf(W)>-1)G=W;else if(Y.before(W)==B)U.splice(1,0,-W)}let z=U.indexOf(G),V=[],K=J.openStart;for(let W=J.content,B=0;;B++){let L=W.firstChild;if(V.push(L),B==J.openStart)break;W=L.content}for(let W=K-1;W>=0;W--){let B=V[W],L=a2(B.type);if(L&&!B.sameMarkup(Y.node(Math.abs(G)-1)))K=W;else if(L||!B.type.isTextblock)break}for(let W=J.openStart;W>=0;W--){let B=(W+K+1)%(J.openStart+1),L=V[B];if(!L)continue;for(let _=0;_<U.length;_++){let I=U[(_+z)%U.length],F=!0;if(I<0)F=!1,I=-I;let E=Y.node(I-1),M=Y.index(I-1);if(E.canReplaceWith(M,M,L.type,L.marks))return Q.replace(Y.before(I),F?q.after(I):X,new j(S9(J.content,0,J.openStart,B),B,J.openEnd))}}let H=Q.steps.length;for(let W=U.length-1;W>=0;W--){if(Q.replace(Z,X,J),Q.steps.length>H)break;let B=U[W];if(B<0)continue;Z=Y.before(B),X=q.after(B)}},S9=function(Q,Z,X,J,Y){if(Z<X){let q=Q.firstChild;Q=Q.replaceChild(0,q.copy(S9(q.content,Z+1,X,J,q)))}if(Z>J){let q=Y.contentMatchAt(0),U=q.fillBefore(Q).append(Q);Q=U.append(q.matchFragment(U).fillBefore(P.empty,!0))}return Q},r2=function(Q,Z,X,J){if(!J.isInline&&Z==X&&Q.doc.resolve(Z).parent.content.size){let Y=i2(Q.doc,Z,J.type);if(Y!=null)Z=X=Y}Q.replaceRange(Z,X,new j(P.from(J),0,0))},o2=function(Q,Z,X){let J=Q.doc.resolve(Z),Y=Q.doc.resolve(X),q=y9(J,Y);for(let U=0;U<q.length;U++){let G=q[U],z=U==q.length-1;if(z&&G==0||J.node(G).type.contentMatch.validEnd)return Q.delete(J.start(G),Y.end(G));if(G>0&&(z||J.node(G-1).canReplace(J.index(G-1),Y.indexAfter(G-1))))return Q.delete(J.before(G),Y.after(G))}for(let U=1;U<=J.depth&&U<=Y.depth;U++)if(Z-J.start(U)==J.depth-U&&X>J.end(U)&&Y.end(U)-X!=Y.depth-U&&J.start(U-1)==Y.start(U-1)&&J.node(U-1).canReplace(J.index(U-1),Y.index(U-1)))return Q.delete(J.before(U),X);Q.delete(Z,X)},y9=function(Q,Z){let X=[],J=Math.min(Q.depth,Z.depth);for(let Y=J;Y>=0;Y--){let q=Q.start(Y);if(q<Q.pos-(Q.depth-Y)||Z.end(Y)>Z.pos+(Z.depth-Y)||Q.node(Y).type.spec.isolating||Z.node(Y).type.spec.isolating)break;if(q==Z.start(Y)||Y==Q.depth&&Y==Z.depth&&Q.parent.inlineContent&&Z.parent.inlineContent&&Y&&Z.start(Y-1)==q-1)X.push(Y)}return X},j9=65535,E9=Math.pow(2,16),A9=1,O9=2,B5=4,R9=8;class _5{constructor(Q,Z,X){this.pos=Q,this.delInfo=Z,this.recover=X}get deleted(){return(this.delInfo&R9)>0}get deletedBefore(){return(this.delInfo&(A9|B5))>0}get deletedAfter(){return(this.delInfo&(O9|B5))>0}get deletedAcross(){return(this.delInfo&B5)>0}}class V0{constructor(Q,Z=!1){if(this.ranges=Q,this.inverted=Z,!Q.length&&V0.empty)return V0.empty}recover(Q){let Z=0,X=F9(Q);if(!this.inverted)for(let J=0;J<X;J++)Z+=this.ranges[J*3+2]-this.ranges[J*3+1];return this.ranges[X*3]+Z+b2(Q)}mapResult(Q,Z=1){return this._map(Q,Z,!1)}map(Q,Z=1){return this._map(Q,Z,!0)}_map(Q,Z,X){let J=0,Y=this.inverted?2:1,q=this.inverted?1:2;for(let U=0;U<this.ranges.length;U+=3){let G=this.ranges[U]-(this.inverted?J:0);if(G>Q)break;let z=this.ranges[U+Y],V=this.ranges[U+q],K=G+z;if(Q<=K){let H=!z?Z:Q==G?-1:Q==K?1:Z,W=G+J+(H<0?0:V);if(X)return W;let B=Q==(Z<0?G:K)?null:y2(U/3,Q-G),L=Q==G?O9:Q==K?A9:B5;if(Z<0?Q!=G:Q!=K)L|=R9;return new _5(W,L,B)}J+=V-z}return X?Q+J:new _5(Q+J,0,null)}touches(Q,Z){let X=0,J=F9(Z),Y=this.inverted?2:1,q=this.inverted?1:2;for(let U=0;U<this.ranges.length;U+=3){let G=this.ranges[U]-(this.inverted?X:0);if(G>Q)break;let z=this.ranges[U+Y],V=G+z;if(Q<=V&&U==J*3)return!0;X+=this.ranges[U+q]-z}return!1}forEach(Q){let Z=this.inverted?2:1,X=this.inverted?1:2;for(let J=0,Y=0;J<this.ranges.length;J+=3){let q=this.ranges[J],U=q-(this.inverted?Y:0),G=q+(this.inverted?0:Y),z=this.ranges[J+Z],V=this.ranges[J+X];Q(U,U+z,G,G+V),Y+=V-z}}invert(){return new V0(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(Q){return Q==0?V0.empty:new V0(Q<0?[0,-Q,0]:[0,0,Q])}}V0.empty=new V0([]);class _1{constructor(Q,Z,X=0,J=Q?Q.length:0){this.mirror=Z,this.from=X,this.to=J,this._maps=Q||[],this.ownData=!(Q||Z)}get maps(){return this._maps}slice(Q=0,Z=this.maps.length){return new _1(this._maps,this.mirror,Q,Z)}appendMap(Q,Z){if(!this.ownData)this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0;if(this.to=this._maps.push(Q),Z!=null)this.setMirror(this._maps.length-1,Z)}appendMapping(Q){for(let Z=0,X=this._maps.length;Z<Q._maps.length;Z++){let J=Q.getMirror(Z);this.appendMap(Q._maps[Z],J!=null&&J<Z?X+J:void 0)}}getMirror(Q){if(this.mirror){for(let Z=0;Z<this.mirror.length;Z++)if(this.mirror[Z]==Q)return this.mirror[Z+(Z%2?-1:1)]}}setMirror(Q,Z){if(!this.mirror)this.mirror=[];this.mirror.push(Q,Z)}appendMappingInverted(Q){for(let Z=Q.maps.length-1,X=this._maps.length+Q._maps.length;Z>=0;Z--){let J=Q.getMirror(Z);this.appendMap(Q._maps[Z].invert(),J!=null&&J>Z?X-J-1:void 0)}}invert(){let Q=new _1;return Q.appendMappingInverted(this),Q}map(Q,Z=1){if(this.mirror)return this._map(Q,Z,!0);for(let X=this.from;X<this.to;X++)Q=this._maps[X].map(Q,Z);return Q}mapResult(Q,Z=1){return this._map(Q,Z,!1)}_map(Q,Z,X){let J=0;for(let Y=this.from;Y<this.to;Y++){let q=this._maps[Y],U=q.mapResult(Q,Z);if(U.recover!=null){let G=this.getMirror(Y);if(G!=null&&G>Y&&G<this.to){Y=G,Q=this._maps[G].recover(U.recover);continue}}J|=U.delInfo,Q=U.pos}return X?Q:new _5(Q,J,null)}}var z6=Object.create(null);class n{getMap(){return V0.empty}merge(Q){return null}static fromJSON(Q,Z){if(!Z||!Z.stepType)throw new RangeError("Invalid input for Step.fromJSON");let X=z6[Z.stepType];if(!X)throw new RangeError(`No step type ${Z.stepType} defined`);return X.fromJSON(Q,Z)}static jsonID(Q,Z){if(Q in z6)throw new RangeError("Duplicate use of step JSON ID "+Q);return z6[Q]=Z,Z.prototype.jsonID=Q,Z}}class l{constructor(Q,Z){this.doc=Q,this.failed=Z}static ok(Q){return new l(Q,null)}static fail(Q){return new l(null,Q)}static fromReplace(Q,Z,X,J){try{return l.ok(Q.replace(Z,X,J))}catch(Y){if(Y instanceof W1)return l.fail(Y.message);throw Y}}}class w0 extends n{constructor(Q,Z,X){super();this.from=Q,this.to=Z,this.mark=X}apply(Q){let Z=Q.slice(this.from,this.to),X=Q.resolve(this.from),J=X.node(X.sharedDepth(this.to)),Y=new j(W6(Z.content,(q,U)=>{if(!q.isAtom||!U.type.allowsMarkType(this.mark.type))return q;return q.mark(this.mark.addToSet(q.marks))},J),Z.openStart,Z.openEnd);return l.fromReplace(Q,this.from,this.to,Y)}invert(){return new E0(this.from,this.to,this.mark)}map(Q){let Z=Q.mapResult(this.from,1),X=Q.mapResult(this.to,-1);if(Z.deleted&&X.deleted||Z.pos>=X.pos)return null;return new w0(Z.pos,X.pos,this.mark)}merge(Q){if(Q instanceof w0&&Q.mark.eq(this.mark)&&this.from<=Q.to&&this.to>=Q.from)return new w0(Math.min(this.from,Q.from),Math.max(this.to,Q.to),this.mark);return null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(Q,Z){if(typeof Z.from!="number"||typeof Z.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new w0(Z.from,Z.to,Q.markFromJSON(Z.mark))}}n.jsonID("addMark",w0);class E0 extends n{constructor(Q,Z,X){super();this.from=Q,this.to=Z,this.mark=X}apply(Q){let Z=Q.slice(this.from,this.to),X=new j(W6(Z.content,(J)=>{return J.mark(this.mark.removeFromSet(J.marks))},Q),Z.openStart,Z.openEnd);return l.fromReplace(Q,this.from,this.to,X)}invert(){return new w0(this.from,this.to,this.mark)}map(Q){let Z=Q.mapResult(this.from,1),X=Q.mapResult(this.to,-1);if(Z.deleted&&X.deleted||Z.pos>=X.pos)return null;return new E0(Z.pos,X.pos,this.mark)}merge(Q){if(Q instanceof E0&&Q.mark.eq(this.mark)&&this.from<=Q.to&&this.to>=Q.from)return new E0(Math.min(this.from,Q.from),Math.max(this.to,Q.to),this.mark);return null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(Q,Z){if(typeof Z.from!="number"||typeof Z.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new E0(Z.from,Z.to,Q.markFromJSON(Z.mark))}}n.jsonID("removeMark",E0);class u0 extends n{constructor(Q,Z){super();this.pos=Q,this.mark=Z}apply(Q){let Z=Q.nodeAt(this.pos);if(!Z)return l.fail("No node at mark step's position");let X=Z.type.create(Z.attrs,null,this.mark.addToSet(Z.marks));return l.fromReplace(Q,this.pos,this.pos+1,new j(P.from(X),0,Z.isLeaf?0:1))}invert(Q){let Z=Q.nodeAt(this.pos);if(Z){let X=this.mark.addToSet(Z.marks);if(X.length==Z.marks.length){for(let J=0;J<Z.marks.length;J++)if(!Z.marks[J].isInSet(X))return new u0(this.pos,Z.marks[J]);return new u0(this.pos,this.mark)}}return new I1(this.pos,this.mark)}map(Q){let Z=Q.mapResult(this.pos,1);return Z.deletedAfter?null:new u0(Z.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(Q,Z){if(typeof Z.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new u0(Z.pos,Q.markFromJSON(Z.mark))}}n.jsonID("addNodeMark",u0);class I1 extends n{constructor(Q,Z){super();this.pos=Q,this.mark=Z}apply(Q){let Z=Q.nodeAt(this.pos);if(!Z)return l.fail("No node at mark step's position");let X=Z.type.create(Z.attrs,null,this.mark.removeFromSet(Z.marks));return l.fromReplace(Q,this.pos,this.pos+1,new j(P.from(X),0,Z.isLeaf?0:1))}invert(Q){let Z=Q.nodeAt(this.pos);if(!Z||!this.mark.isInSet(Z.marks))return this;return new u0(this.pos,this.mark)}map(Q){let Z=Q.mapResult(this.pos,1);return Z.deletedAfter?null:new I1(Z.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(Q,Z){if(typeof Z.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new I1(Z.pos,Q.markFromJSON(Z.mark))}}n.jsonID("removeNodeMark",I1);class h extends n{constructor(Q,Z,X,J=!1){super();this.from=Q,this.to=Z,this.slice=X,this.structure=J}apply(Q){if(this.structure&&H6(Q,this.from,this.to))return l.fail("Structure replace would overwrite content");return l.fromReplace(Q,this.from,this.to,this.slice)}getMap(){return new V0([this.from,this.to-this.from,this.slice.size])}invert(Q){return new h(this.from,this.from+this.slice.size,Q.slice(this.from,this.to))}map(Q){let Z=Q.mapResult(this.from,1),X=Q.mapResult(this.to,-1);if(Z.deletedAcross&&X.deletedAcross)return null;return new h(Z.pos,Math.max(Z.pos,X.pos),this.slice)}merge(Q){if(!(Q instanceof h)||Q.structure||this.structure)return null;if(this.from+this.slice.size==Q.from&&!this.slice.openEnd&&!Q.slice.openStart){let Z=this.slice.size+Q.slice.size==0?j.empty:new j(this.slice.content.append(Q.slice.content),this.slice.openStart,Q.slice.openEnd);return new h(this.from,this.to+(Q.to-Q.from),Z,this.structure)}else if(Q.to==this.from&&!this.slice.openStart&&!Q.slice.openEnd){let Z=this.slice.size+Q.slice.size==0?j.empty:new j(Q.slice.content.append(this.slice.content),Q.slice.openStart,this.slice.openEnd);return new h(Q.from,this.to,Z,this.structure)}else return null}toJSON(){let Q={stepType:"replace",from:this.from,to:this.to};if(this.slice.size)Q.slice=this.slice.toJSON();if(this.structure)Q.structure=!0;return Q}static fromJSON(Q,Z){if(typeof Z.from!="number"||typeof Z.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new h(Z.from,Z.to,j.fromJSON(Q,Z.slice),!!Z.structure)}}n.jsonID("replace",h);class u extends n{constructor(Q,Z,X,J,Y,q,U=!1){super();this.from=Q,this.to=Z,this.gapFrom=X,this.gapTo=J,this.slice=Y,this.insert=q,this.structure=U}apply(Q){if(this.structure&&(H6(Q,this.from,this.gapFrom)||H6(Q,this.gapTo,this.to)))return l.fail("Structure gap-replace would overwrite content");let Z=Q.slice(this.gapFrom,this.gapTo);if(Z.openStart||Z.openEnd)return l.fail("Gap is not a flat range");let X=this.slice.insertAt(this.insert,Z.content);if(!X)return l.fail("Content does not fit in gap");return l.fromReplace(Q,this.from,this.to,X)}getMap(){return new V0([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(Q){let Z=this.gapTo-this.gapFrom;return new u(this.from,this.from+this.slice.size+Z,this.from+this.insert,this.from+this.insert+Z,Q.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(Q){let Z=Q.mapResult(this.from,1),X=Q.mapResult(this.to,-1),J=this.from==this.gapFrom?Z.pos:Q.map(this.gapFrom,-1),Y=this.to==this.gapTo?X.pos:Q.map(this.gapTo,1);if(Z.deletedAcross&&X.deletedAcross||J<Z.pos||Y>X.pos)return null;return new u(Z.pos,X.pos,J,Y,this.slice,this.insert,this.structure)}toJSON(){let Q={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};if(this.slice.size)Q.slice=this.slice.toJSON();if(this.structure)Q.structure=!0;return Q}static fromJSON(Q,Z){if(typeof Z.from!="number"||typeof Z.to!="number"||typeof Z.gapFrom!="number"||typeof Z.gapTo!="number"||typeof Z.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new u(Z.from,Z.to,Z.gapFrom,Z.gapTo,j.fromJSON(Q,Z.slice),Z.insert,!!Z.structure)}}n.jsonID("replaceAround",u);class T9{constructor(Q,Z,X){this.$from=Q,this.$to=Z,this.unplaced=X,this.frontier=[],this.placed=P.empty;for(let J=0;J<=Q.depth;J++){let Y=Q.node(J);this.frontier.push({type:Y.type,match:Y.contentMatchAt(Q.indexAfter(J))})}for(let J=Q.depth;J>0;J--)this.placed=P.from(Q.node(J).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){while(this.unplaced.size){let z=this.findFittable();if(z)this.placeNodes(z);else this.openMore()||this.dropNode()}let Q=this.mustMoveInline(),Z=this.placed.size-this.depth-this.$from.depth,X=this.$from,J=this.close(Q<0?this.$to:X.doc.resolve(Q));if(!J)return null;let Y=this.placed,q=X.depth,U=J.depth;while(q&&U&&Y.childCount==1)Y=Y.firstChild.content,q--,U--;let G=new j(Y,q,U);if(Q>-1)return new u(X.pos,Q,this.$to.pos,this.$to.end(),G,Z);if(G.size||X.pos!=this.$to.pos)return new h(X.pos,J.pos,G);return null}findFittable(){let Q=this.unplaced.openStart;for(let Z=this.unplaced.content,X=0,J=this.unplaced.openEnd;X<Q;X++){let Y=Z.firstChild;if(Z.childCount>1)J=0;if(Y.type.spec.isolating&&J<=X){Q=X;break}Z=Y.content}for(let Z=1;Z<=2;Z++)for(let X=Z==1?Q:this.unplaced.openStart;X>=0;X--){let J,Y=null;if(X)Y=V6(this.unplaced.content,X-1).firstChild,J=Y.content;else J=this.unplaced.content;let q=J.firstChild;for(let U=this.depth;U>=0;U--){let{type:G,match:z}=this.frontier[U],V,K=null;if(Z==1&&(q?z.matchType(q.type)||(K=z.fillBefore(P.from(q),!1)):Y&&G.compatibleContent(Y.type)))return{sliceDepth:X,frontierDepth:U,parent:Y,inject:K};else if(Z==2&&q&&(V=z.findWrapping(q.type)))return{sliceDepth:X,frontierDepth:U,parent:Y,wrap:V};if(Y&&z.matchType(Y.type))break}}}openMore(){let{content:Q,openStart:Z,openEnd:X}=this.unplaced,J=V6(Q,Z);if(!J.childCount||J.firstChild.isLeaf)return!1;return this.unplaced=new j(Q,Z+1,Math.max(X,J.size+Z>=Q.size-X?Z+1:0)),!0}dropNode(){let{content:Q,openStart:Z,openEnd:X}=this.unplaced,J=V6(Q,Z);if(J.childCount<=1&&Z>0){let Y=Q.size-Z<=Z+J.size;this.unplaced=new j(m1(Q,Z-1,1),Z-1,Y?Z-1:X)}else this.unplaced=new j(m1(Q,Z,1),Z,X)}placeNodes({sliceDepth:Q,frontierDepth:Z,parent:X,inject:J,wrap:Y}){while(this.depth>Z)this.closeFrontierNode();if(Y)for(let L=0;L<Y.length;L++)this.openFrontierNode(Y[L]);let q=this.unplaced,U=X?X.content:q.content,G=q.openStart-Q,z=0,V=[],{match:K,type:H}=this.frontier[Z];if(J){for(let L=0;L<J.childCount;L++)V.push(J.child(L));K=K.matchFragment(J)}let W=U.size+Q-(q.content.size-q.openEnd);while(z<U.childCount){let L=U.child(z),_=K.matchType(L.type);if(!_)break;if(z++,z>1||G==0||L.content.size)K=_,V.push(k9(L.mark(H.allowedMarks(L.marks)),z==1?G:0,z==U.childCount?W:-1))}let B=z==U.childCount;if(!B)W=-1;if(this.placed=l1(this.placed,Z,P.from(V)),this.frontier[Z].match=K,B&&W<0&&X&&X.type==this.frontier[this.depth].type&&this.frontier.length>1)this.closeFrontierNode();for(let L=0,_=U;L<W;L++){let I=_.lastChild;this.frontier.push({type:I.type,match:I.contentMatchAt(I.childCount)}),_=I.content}this.unplaced=!B?new j(m1(q.content,Q,z),q.openStart,q.openEnd):Q==0?j.empty:new j(m1(q.content,Q-1,1),Q-1,W<0?q.openEnd:Q-1)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let Q=this.frontier[this.depth],Z;if(!Q.type.isTextblock||!K6(this.$to,this.$to.depth,Q.type,Q.match,!1)||this.$to.depth==this.depth&&(Z=this.findCloseLevel(this.$to))&&Z.depth==this.depth)return-1;let{depth:X}=this.$to,J=this.$to.after(X);while(X>1&&J==this.$to.end(--X))++J;return J}findCloseLevel(Q){Q:for(let Z=Math.min(this.depth,Q.depth);Z>=0;Z--){let{match:X,type:J}=this.frontier[Z],Y=Z<Q.depth&&Q.end(Z+1)==Q.pos+(Q.depth-(Z+1)),q=K6(Q,Z,J,X,Y);if(!q)continue;for(let U=Z-1;U>=0;U--){let{match:G,type:z}=this.frontier[U],V=K6(Q,U,z,G,!0);if(!V||V.childCount)continue Q}return{depth:Z,fit:q,move:Y?Q.doc.resolve(Q.after(Z+1)):Q}}}close(Q){let Z=this.findCloseLevel(Q);if(!Z)return null;while(this.depth>Z.depth)this.closeFrontierNode();if(Z.fit.childCount)this.placed=l1(this.placed,Z.depth,Z.fit);Q=Z.move;for(let X=Z.depth+1;X<=Q.depth;X++){let J=Q.node(X),Y=J.type.contentMatch.fillBefore(J.content,!0,Q.index(X));this.openFrontierNode(J.type,J.attrs,Y)}return Q}openFrontierNode(Q,Z=null,X){let J=this.frontier[this.depth];J.match=J.match.matchType(Q),this.placed=l1(this.placed,this.depth,P.from(Q.create(Z,X))),this.frontier.push({type:Q,match:Q.contentMatch})}closeFrontierNode(){let Z=this.frontier.pop().match.fillBefore(P.empty,!0);if(Z.childCount)this.placed=l1(this.placed,this.frontier.length,Z)}}class B1 extends n{constructor(Q,Z,X){super();this.pos=Q,this.attr=Z,this.value=X}apply(Q){let Z=Q.nodeAt(this.pos);if(!Z)return l.fail("No node at attribute step's position");let X=Object.create(null);for(let Y in Z.attrs)X[Y]=Z.attrs[Y];X[this.attr]=this.value;let J=Z.type.create(X,null,Z.marks);return l.fromReplace(Q,this.pos,this.pos+1,new j(P.from(J),0,Z.isLeaf?0:1))}getMap(){return V0.empty}invert(Q){return new B1(this.pos,this.attr,Q.nodeAt(this.pos).attrs[this.attr])}map(Q){let Z=Q.mapResult(this.pos,1);return Z.deletedAfter?null:new B1(Z.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(Q,Z){if(typeof Z.pos!="number"||typeof Z.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new B1(Z.pos,Z.attr,Z.value)}}n.jsonID("attr",B1);class c1 extends n{constructor(Q,Z){super();this.attr=Q,this.value=Z}apply(Q){let Z=Object.create(null);for(let J in Q.attrs)Z[J]=Q.attrs[J];Z[this.attr]=this.value;let X=Q.type.create(Z,Q.content,Q.marks);return l.ok(X)}getMap(){return V0.empty}invert(Q){return new c1(this.attr,Q.attrs[this.attr])}map(Q){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(Q,Z){if(typeof Z.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new c1(Z.attr,Z.value)}}n.jsonID("docAttr",c1);var F1=class extends Error{};F1=function Q(Z){let X=Error.call(this,Z);return X.__proto__=Q.prototype,X};F1.prototype=Object.create(Error.prototype);F1.prototype.constructor=F1;F1.prototype.name="TransformError";class E1{constructor(Q){this.doc=Q,this.steps=[],this.docs=[],this.mapping=new _1}get before(){return this.docs.length?this.docs[0]:this.doc}step(Q){let Z=this.maybeStep(Q);if(Z.failed)throw new F1(Z.failed);return this}maybeStep(Q){let Z=Q.apply(this.doc);if(!Z.failed)this.addStep(Q,Z.doc);return Z}get docChanged(){return this.steps.length>0}addStep(Q,Z){this.docs.push(this.doc),this.steps.push(Q),this.mapping.appendMap(Q.getMap()),this.doc=Z}replace(Q,Z=Q,X=j.empty){let J=p1(this.doc,Q,Z,X);if(J)this.step(J);return this}replaceWith(Q,Z,X){return this.replace(Q,Z,new j(P.from(X),0,0))}delete(Q,Z){return this.replace(Q,Z,j.empty)}insert(Q,Z){return this.replaceWith(Q,Q,Z)}replaceRange(Q,Z,X){return n2(this,Q,Z,X),this}replaceRangeWith(Q,Z,X){return r2(this,Q,Z,X),this}deleteRange(Q,Z){return o2(this,Q,Z),this}lift(Q,Z){return w2(this,Q,Z),this}join(Q,Z=1){return d2(this,Q,Z),this}wrap(Q,Z){return f2(this,Q,Z),this}setBlockType(Q,Z=Q,X,J=null){return h2(this,Q,Z,X,J),this}setNodeMarkup(Q,Z,X=null,J){return l2(this,Q,Z,X,J),this}setNodeAttribute(Q,Z,X){return this.step(new B1(Q,Z,X)),this}setDocAttribute(Q,Z){return this.step(new c1(Q,Z)),this}addNodeMark(Q,Z){return this.step(new u0(Q,Z)),this}removeNodeMark(Q,Z){if(!(Z instanceof b)){let X=this.doc.nodeAt(Q);if(!X)throw new RangeError("No node at position "+Q);if(Z=Z.isInSet(X.marks),!Z)return this}return this.step(new I1(Q,Z)),this}split(Q,Z=1,X){return c2(this,Q,Z,X),this}addMark(Q,Z,X){return $2(this,Q,Z,X),this}removeMark(Q,Z,X){return x2(this,Q,Z,X),this}clearIncompatible(Q,Z,X){return L6(this,Q,Z,X),this}}var $9=function(Q){if(!b9&&!Q.parent.inlineContent)b9=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+Q.parent.type.name+")")},A1=function(Q,Z,X,J,Y,q=!1){if(Z.inlineContent)return O.create(Q,X);for(let U=J-(Y>0?0:1);Y>0?U<Z.childCount:U>=0;U+=Y){let G=Z.child(U);if(!G.isAtom){let z=A1(Q,G,X+Y,Y<0?G.childCount:0,Y,q);if(z)return z}else if(!q&&R.isSelectable(G))return R.create(Q,X-(Y<0?G.nodeSize:0));X+=G.nodeSize*Y}return null},x9=function(Q,Z,X){let J=Q.steps.length-1;if(J<Z)return;let Y=Q.steps[J];if(!(Y instanceof h||Y instanceof u))return;let q=Q.mapping.maps[J],U;q.forEach((G,z,V,K)=>{if(U==null)U=K}),Q.setSelection(N.near(Q.doc.resolve(U),X))},u9=function(Q,Z){return!Z||!Q?Q:Q.bind(Z)},f9=function(Q,Z,X){for(let J in Q){let Y=Q[J];if(Y instanceof Function)Y=Y.bind(Z);else if(J=="handleDOMEvents")Y=f9(Y,Z,{});X[J]=Y}return X},h9=function(Q){if(Q in _6)return Q+"$"+ ++_6[Q];return _6[Q]=0,Q+"$"},B6=Object.create(null);class N{constructor(Q,Z,X){this.$anchor=Q,this.$head=Z,this.ranges=X||[new d1(Q.min(Z),Q.max(Z))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let Q=this.ranges;for(let Z=0;Z<Q.length;Z++)if(Q[Z].$from.pos!=Q[Z].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(Q,Z=j.empty){let X=Z.content.lastChild,J=null;for(let U=0;U<Z.openEnd;U++)J=X,X=X.lastChild;let Y=Q.steps.length,q=this.ranges;for(let U=0;U<q.length;U++){let{$from:G,$to:z}=q[U],V=Q.mapping.slice(Y);if(Q.replaceRange(V.map(G.pos),V.map(z.pos),U?j.empty:Z),U==0)x9(Q,Y,(X?X.isInline:J&&J.isTextblock)?-1:1)}}replaceWith(Q,Z){let X=Q.steps.length,J=this.ranges;for(let Y=0;Y<J.length;Y++){let{$from:q,$to:U}=J[Y],G=Q.mapping.slice(X),z=G.map(q.pos),V=G.map(U.pos);if(Y)Q.deleteRange(z,V);else Q.replaceRangeWith(z,V,Z),x9(Q,X,Z.isInline?-1:1)}}static findFrom(Q,Z,X=!1){let J=Q.parent.inlineContent?new O(Q):A1(Q.node(0),Q.parent,Q.pos,Q.index(),Z,X);if(J)return J;for(let Y=Q.depth-1;Y>=0;Y--){let q=Z<0?A1(Q.node(0),Q.node(Y),Q.before(Y+1),Q.index(Y),Z,X):A1(Q.node(0),Q.node(Y),Q.after(Y+1),Q.index(Y)+1,Z,X);if(q)return q}return null}static near(Q,Z=1){return this.findFrom(Q,Z)||this.findFrom(Q,-Z)||new r(Q.node(0))}static atStart(Q){return A1(Q,Q,0,0,1)||new r(Q)}static atEnd(Q){return A1(Q,Q,Q.content.size,Q.childCount,-1)||new r(Q)}static fromJSON(Q,Z){if(!Z||!Z.type)throw new RangeError("Invalid input for Selection.fromJSON");let X=B6[Z.type];if(!X)throw new RangeError(`No selection type ${Z.type} defined`);return X.fromJSON(Q,Z)}static jsonID(Q,Z){if(Q in B6)throw new RangeError("Duplicate use of selection JSON ID "+Q);return B6[Q]=Z,Z.prototype.jsonID=Q,Z}getBookmark(){return O.between(this.$anchor,this.$head).getBookmark()}}N.prototype.visible=!0;class d1{constructor(Q,Z){this.$from=Q,this.$to=Z}}var b9=!1;class O extends N{constructor(Q,Z=Q){$9(Q),$9(Z);super(Q,Z)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(Q,Z){let X=Q.resolve(Z.map(this.head));if(!X.parent.inlineContent)return N.near(X);let J=Q.resolve(Z.map(this.anchor));return new O(J.parent.inlineContent?J:X,X)}replace(Q,Z=j.empty){if(super.replace(Q,Z),Z==j.empty){let X=this.$from.marksAcross(this.$to);if(X)Q.ensureMarks(X)}}eq(Q){return Q instanceof O&&Q.anchor==this.anchor&&Q.head==this.head}getBookmark(){return new j5(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(Q,Z){if(typeof Z.anchor!="number"||typeof Z.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new O(Q.resolve(Z.anchor),Q.resolve(Z.head))}static create(Q,Z,X=Z){let J=Q.resolve(Z);return new this(J,X==Z?J:Q.resolve(X))}static between(Q,Z,X){let J=Q.pos-Z.pos;if(!X||J)X=J>=0?1:-1;if(!Z.parent.inlineContent){let Y=N.findFrom(Z,X,!0)||N.findFrom(Z,-X,!0);if(Y)Z=Y.$head;else return N.near(Z,X)}if(!Q.parent.inlineContent){if(J==0)Q=Z;else if(Q=(N.findFrom(Q,-X,!0)||N.findFrom(Q,X,!0)).$anchor,Q.pos<Z.pos!=J<0)Q=Z}return new O(Q,Z)}}N.jsonID("text",O);class j5{constructor(Q,Z){this.anchor=Q,this.head=Z}map(Q){return new j5(Q.map(this.anchor),Q.map(this.head))}resolve(Q){return O.between(Q.resolve(this.anchor),Q.resolve(this.head))}}class R extends N{constructor(Q){let Z=Q.nodeAfter,X=Q.node(0).resolve(Q.pos+Z.nodeSize);super(Q,X);this.node=Z}map(Q,Z){let{deleted:X,pos:J}=Z.mapResult(this.anchor),Y=Q.resolve(J);if(X)return N.near(Y);return new R(Y)}content(){return new j(P.from(this.node),0,0)}eq(Q){return Q instanceof R&&Q.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new I6(this.anchor)}static fromJSON(Q,Z){if(typeof Z.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new R(Q.resolve(Z.anchor))}static create(Q,Z){return new R(Q.resolve(Z))}static isSelectable(Q){return!Q.isText&&Q.type.spec.selectable!==!1}}R.prototype.visible=!1;N.jsonID("node",R);class I6{constructor(Q){this.anchor=Q}map(Q){let{deleted:Z,pos:X}=Q.mapResult(this.anchor);return Z?new j5(X,X):new I6(X)}resolve(Q){let Z=Q.resolve(this.anchor),X=Z.nodeAfter;if(X&&R.isSelectable(X))return new R(Z);return N.near(Z)}}class r extends N{constructor(Q){super(Q.resolve(0),Q.resolve(Q.content.size))}replace(Q,Z=j.empty){if(Z==j.empty){Q.delete(0,Q.doc.content.size);let X=N.atStart(Q.doc);if(!X.eq(Q.selection))Q.setSelection(X)}else super.replace(Q,Z)}toJSON(){return{type:"all"}}static fromJSON(Q){return new r(Q)}map(Q){return new r(Q)}eq(Q){return Q instanceof r}getBookmark(){return t2}}N.jsonID("all",r);var t2={map(){return this},resolve(Q){return new r(Q)}},g9=1,F5=2,w9=4;class v9 extends E1{constructor(Q){super(Q.doc);this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=Q.selection,this.storedMarks=Q.storedMarks}get selection(){if(this.curSelectionFor<this.steps.length)this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length;return this.curSelection}setSelection(Q){if(Q.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=Q,this.curSelectionFor=this.steps.length,this.updated=(this.updated|g9)&~F5,this.storedMarks=null,this}get selectionSet(){return(this.updated&g9)>0}setStoredMarks(Q){return this.storedMarks=Q,this.updated|=F5,this}ensureMarks(Q){if(!b.sameSet(this.storedMarks||this.selection.$from.marks(),Q))this.setStoredMarks(Q);return this}addStoredMark(Q){return this.ensureMarks(Q.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(Q){return this.ensureMarks(Q.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&F5)>0}addStep(Q,Z){super.addStep(Q,Z),this.updated=this.updated&~F5,this.storedMarks=null}setTime(Q){return this.time=Q,this}replaceSelection(Q){return this.selection.replace(this,Q),this}replaceSelectionWith(Q,Z=!0){let X=this.selection;if(Z)Q=Q.mark(this.storedMarks||(X.empty?X.$from.marks():X.$from.marksAcross(X.$to)||b.none));return X.replaceWith(this,Q),this}deleteSelection(){return this.selection.replace(this),this}insertText(Q,Z,X){let J=this.doc.type.schema;if(Z==null){if(!Q)return this.deleteSelection();return this.replaceSelectionWith(J.text(Q),!0)}else{if(X==null)X=Z;if(X=X==null?Z:X,!Q)return this.deleteRange(Z,X);let Y=this.storedMarks;if(!Y){let q=this.doc.resolve(Z);Y=X==Z?q.marks():q.marksAcross(this.doc.resolve(X))}if(this.replaceRangeWith(Z,X,J.text(Q,Y)),!this.selection.empty)this.setSelection(N.near(this.selection.$to));return this}}setMeta(Q,Z){return this.meta[typeof Q=="string"?Q:Q.key]=Z,this}getMeta(Q){return this.meta[typeof Q=="string"?Q:Q.key]}get isGeneric(){for(let Q in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=w9,this}get scrolledIntoView(){return(this.updated&w9)>0}}class O1{constructor(Q,Z,X){this.name=Q,this.init=u9(Z.init,X),this.apply=u9(Z.apply,X)}}var e2=[new O1("doc",{init(Q){return Q.doc||Q.schema.topNodeType.createAndFill()},apply(Q){return Q.doc}}),new O1("selection",{init(Q,Z){return Q.selection||N.atStart(Z.doc)},apply(Q){return Q.selection}}),new O1("storedMarks",{init(Q){return Q.storedMarks||null},apply(Q,Z,X,J){return J.selection.$cursor?Q.storedMarks:null}}),new O1("scrollToSelection",{init(){return 0},apply(Q,Z){return Q.scrolledIntoView?Z+1:Z}})];class P5{constructor(Q,Z){if(this.schema=Q,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=e2.slice(),Z)Z.forEach((X)=>{if(this.pluginsByKey[X.key])throw new RangeError("Adding different instances of a keyed plugin ("+X.key+")");if(this.plugins.push(X),this.pluginsByKey[X.key]=X,X.spec.state)this.fields.push(new O1(X.key,X.spec.state,X))})}}class e0{constructor(Q){this.config=Q}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(Q){return this.applyTransaction(Q).state}filterTransaction(Q,Z=-1){for(let X=0;X<this.config.plugins.length;X++)if(X!=Z){let J=this.config.plugins[X];if(J.spec.filterTransaction&&!J.spec.filterTransaction.call(J,Q,this))return!1}return!0}applyTransaction(Q){if(!this.filterTransaction(Q))return{state:this,transactions:[]};let Z=[Q],X=this.applyInner(Q),J=null;for(;;){let Y=!1;for(let q=0;q<this.config.plugins.length;q++){let U=this.config.plugins[q];if(U.spec.appendTransaction){let G=J?J[q].n:0,z=J?J[q].state:this,V=G<Z.length&&U.spec.appendTransaction.call(U,G?Z.slice(G):Z,z,X);if(V&&X.filterTransaction(V,q)){if(V.setMeta("appendedTransaction",Q),!J){J=[];for(let K=0;K<this.config.plugins.length;K++)J.push(K<q?{state:X,n:Z.length}:{state:this,n:0})}Z.push(V),X=X.applyInner(V),Y=!0}if(J)J[q]={state:X,n:Z.length}}}if(!Y)return{state:X,transactions:Z}}}applyInner(Q){if(!Q.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let Z=new e0(this.config),X=this.config.fields;for(let J=0;J<X.length;J++){let Y=X[J];Z[Y.name]=Y.apply(Q,this[Y.name],this,Z)}return Z}get tr(){return new v9(this)}static create(Q){let Z=new P5(Q.doc?Q.doc.type.schema:Q.schema,Q.plugins),X=new e0(Z);for(let J=0;J<Z.fields.length;J++)X[Z.fields[J].name]=Z.fields[J].init(Q,X);return X}reconfigure(Q){let Z=new P5(this.schema,Q.plugins),X=Z.fields,J=new e0(Z);for(let Y=0;Y<X.length;Y++){let q=X[Y].name;J[q]=this.hasOwnProperty(q)?this[q]:X[Y].init(Q,J)}return J}toJSON(Q){let Z={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks)Z.storedMarks=this.storedMarks.map((X)=>X.toJSON());if(Q&&typeof Q=="object")for(let X in Q){if(X=="doc"||X=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let J=Q[X],Y=J.spec.state;if(Y&&Y.toJSON)Z[X]=Y.toJSON.call(J,this[J.key])}return Z}static fromJSON(Q,Z,X){if(!Z)throw new RangeError("Invalid input for EditorState.fromJSON");if(!Q.schema)throw new RangeError("Required config field 'schema' missing");let J=new P5(Q.schema,Q.plugins),Y=new e0(J);return J.fields.forEach((q)=>{if(q.name=="doc")Y.doc=z0.fromJSON(Q.schema,Z.doc);else if(q.name=="selection")Y.selection=N.fromJSON(Y.doc,Z.selection);else if(q.name=="storedMarks"){if(Z.storedMarks)Y.storedMarks=Z.storedMarks.map(Q.schema.markFromJSON)}else{if(X)for(let U in X){let G=X[U],z=G.spec.state;if(G.key==q.name&&z&&z.fromJSON&&Object.prototype.hasOwnProperty.call(Z,U)){Y[q.name]=z.fromJSON.call(G,Q,Z[U],Y);return}}Y[q.name]=q.init(Q,Y)}}),Y}}class g{constructor(Q){if(this.spec=Q,this.props={},Q.props)f9(Q.props,this,this.props);this.key=Q.key?Q.key.key:h9("plugin")}getState(Q){return Q[this.key]}}var _6=Object.create(null);class c{constructor(Q="key"){this.key=h9(Q)}get(Q){return Q.config.pluginsByKey[this.key]}getState(Q){return Q[this.key]}}var m9=function(Q,Z,X,J,Y){for(;;){if(Q==X&&Z==J)return!0;if(Z==(Y<0?0:L0(Q))){let q=Q.parentNode;if(!q||q.nodeType!=1||t1(Q)||ZZ.test(Q.nodeName)||Q.contentEditable=="false")return!1;Z=o(Q)+(Y<0?0:1),Q=q}else if(Q.nodeType==1){if(Q=Q.childNodes[Z+(Y<0?-1:0)],Q.contentEditable=="false")return!1;Z=Y<0?L0(Q):0}else return!1}},L0=function(Q){return Q.nodeType==3?Q.nodeValue.length:Q.childNodes.length},XZ=function(Q,Z){for(;;){if(Q.nodeType==3&&Z)return Q;if(Q.nodeType==1&&Z>0){if(Q.contentEditable=="false")return null;Q=Q.childNodes[Z-1],Z=L0(Q)}else if(Q.parentNode&&!t1(Q))Z=o(Q),Q=Q.parentNode;else return null}},JZ=function(Q,Z){for(;;){if(Q.nodeType==3&&Z<Q.nodeValue.length)return Q;if(Q.nodeType==1&&Z<Q.childNodes.length){if(Q.contentEditable=="false")return null;Q=Q.childNodes[Z],Z=0}else if(Q.parentNode&&!t1(Q))Z=o(Q)+1,Q=Q.parentNode;else return null}},YZ=function(Q,Z,X){for(let J=Z==0,Y=Z==L0(Q);J||Y;){if(Q==X)return!0;let q=o(Q);if(Q=Q.parentNode,!Q)return!1;J=J&&q==0,Y=Y&&q==L0(Q)}},t1=function(Q){let Z;for(let X=Q;X;X=X.parentNode)if(Z=X.pmViewDesc)break;return Z&&Z.node&&Z.node.isBlock&&(Z.dom==Q||Z.contentDOM==Q)},Q1=function(Q,Z){let X=document.createEvent("Event");return X.initEvent("keydown",!0,!0),X.keyCode=Q,X.key=X.code=Z,X},qZ=function(Q){let Z=Q.activeElement;while(Z&&Z.shadowRoot)Z=Z.shadowRoot.activeElement;return Z},UZ=function(Q,Z,X){if(Q.caretPositionFromPoint)try{let J=Q.caretPositionFromPoint(Z,X);if(J)return{node:J.offsetNode,offset:Math.min(L0(J.offsetNode),J.offset)}}catch(J){}if(Q.caretRangeFromPoint){let J=Q.caretRangeFromPoint(Z,X);if(J)return{node:J.startContainer,offset:Math.min(L0(J.startContainer),J.startOffset)}}},VZ=function(Q){let Z=Q.defaultView&&Q.defaultView.visualViewport;if(Z)return{left:0,right:Z.width,top:0,bottom:Z.height};return{left:0,right:Q.documentElement.clientWidth,top:0,bottom:Q.documentElement.clientHeight}},k0=function(Q,Z){return typeof Q=="number"?Q:Q[Z]},KZ=function(Q){let Z=Q.getBoundingClientRect(),X=Z.width/Q.offsetWidth||1,J=Z.height/Q.offsetHeight||1;return{left:Z.left,right:Z.left+Q.clientWidth*X,top:Z.top,bottom:Z.top+Q.clientHeight*J}},c9=function(Q,Z,X){let J=Q.someProp("scrollThreshold")||0,Y=Q.someProp("scrollMargin")||5,q=Q.dom.ownerDocument;for(let U=X||Q.dom;;){if(!U)break;if(U.nodeType!=1){U=C1(U);continue}let G=U,z=G==q.body,V=z?VZ(q):KZ(G),K=0,H=0;if(Z.top<V.top+k0(J,"top"))H=-(V.top-Z.top+k0(Y,"top"));else if(Z.bottom>V.bottom-k0(J,"bottom"))H=Z.bottom-Z.top>V.bottom-V.top?Z.top+k0(Y,"top")-V.top:Z.bottom-V.bottom+k0(Y,"bottom");if(Z.left<V.left+k0(J,"left"))K=-(V.left-Z.left+k0(Y,"left"));else if(Z.right>V.right-k0(J,"right"))K=Z.right-V.right+k0(Y,"right");if(K||H)if(z)q.defaultView.scrollBy(K,H);else{let{scrollLeft:B,scrollTop:L}=G;if(H)G.scrollTop+=H;if(K)G.scrollLeft+=K;let _=G.scrollLeft-B,I=G.scrollTop-L;Z={left:Z.left-_,top:Z.top-I,right:Z.right-_,bottom:Z.bottom-I}}let W=z?"fixed":getComputedStyle(U).position;if(/^(fixed|sticky)$/.test(W))break;U=W=="absolute"?U.offsetParent:C1(U)}},HZ=function(Q){let Z=Q.dom.getBoundingClientRect(),X=Math.max(0,Z.top),J,Y;for(let q=(Z.left+Z.right)/2,U=X+1;U<Math.min(innerHeight,Z.bottom);U+=5){let G=Q.root.elementFromPoint(q,U);if(!G||G==Q.dom||!Q.dom.contains(G))continue;let z=G.getBoundingClientRect();if(z.top>=X-20){J=G,Y=z.top;break}}return{refDOM:J,refTop:Y,stack:OQ(Q.dom)}},OQ=function(Q){let Z=[],X=Q.ownerDocument;for(let J=Q;J;J=C1(J))if(Z.push({dom:J,top:J.scrollTop,left:J.scrollLeft}),Q==X)break;return Z},WZ=function({refDOM:Q,refTop:Z,stack:X}){let J=Q?Q.getBoundingClientRect().top:0;RQ(X,J==0?0:J-Z)},RQ=function(Q,Z){for(let X=0;X<Q.length;X++){let{dom:J,top:Y,left:q}=Q[X];if(J.scrollTop!=Y+Z)J.scrollTop=Y+Z;if(J.scrollLeft!=q)J.scrollLeft=q}},LZ=function(Q){if(Q.setActive)return Q.setActive();if(R1)return Q.focus(R1);let Z=OQ(Q);if(Q.focus(R1==null?{get preventScroll(){return R1={preventScroll:!0},!0}}:void 0),!R1)R1=!1,RQ(Z,0)},NQ=function(Q,Z){let X,J=200000000,Y,q=0,U=Z.top,G=Z.top,z,V;for(let K=Q.firstChild,H=0;K;K=K.nextSibling,H++){let W;if(K.nodeType==1)W=K.getClientRects();else if(K.nodeType==3)W=S0(K).getClientRects();else continue;for(let B=0;B<W.length;B++){let L=W[B];if(L.top<=U&&L.bottom>=G){U=Math.max(L.bottom,U),G=Math.min(L.top,G);let _=L.left>Z.left?L.left-Z.left:L.right<Z.left?Z.left-L.right:0;if(_<J){if(X=K,J=_,Y=_&&X.nodeType==3?{left:L.right<Z.left?L.right:L.left,top:Z.top}:Z,K.nodeType==1&&_)q=H+(Z.left>=(L.left+L.right)/2?1:0);continue}}else if(L.top>Z.top&&!z&&L.left<=Z.left&&L.right>=Z.left)z=K,V={left:Math.max(L.left,Math.min(L.right,Z.left)),top:L.top};if(!X&&(Z.left>=L.right&&Z.top>=L.top||Z.left>=L.left&&Z.top>=L.bottom))q=H+1}}if(!X&&z)X=z,Y=V,J=0;if(X&&X.nodeType==3)return BZ(X,Y);if(!X||J&&X.nodeType==1)return{node:Q,offset:q};return NQ(X,Y)},BZ=function(Q,Z){let X=Q.nodeValue.length,J=document.createRange();for(let Y=0;Y<X;Y++){J.setEnd(Q,Y+1),J.setStart(Q,Y);let q=v0(J,1);if(q.top==q.bottom)continue;if(b6(Z,q))return{node:Q,offset:Y+(Z.left>=(q.left+q.right)/2?1:0)}}return{node:Q,offset:0}},b6=function(Q,Z){return Q.left>=Z.left-1&&Q.left<=Z.right+1&&Q.top>=Z.top-1&&Q.top<=Z.bottom+1},_Z=function(Q,Z){let X=Q.parentNode;if(X&&/^li$/i.test(X.nodeName)&&Z.left<Q.getBoundingClientRect().left)return X;return Q},IZ=function(Q,Z,X){let{node:J,offset:Y}=NQ(Z,X),q=-1;if(J.nodeType==1&&!J.firstChild){let U=J.getBoundingClientRect();q=U.left!=U.right&&X.left>(U.left+U.right)/2?1:-1}return Q.docView.posFromDOM(J,Y,q)},FZ=function(Q,Z,X,J){let Y=-1;for(let q=Z,U=!1;;){if(q==Q.dom)break;let G=Q.docView.nearestDesc(q,!0),z;if(!G)return null;if(G.dom.nodeType==1&&(G.node.isBlock&&G.parent||!G.contentDOM)&&((z=G.dom.getBoundingClientRect()).width||z.height)){if(G.node.isBlock&&G.parent){if(!U&&z.left>J.left||z.top>J.top)Y=G.posBefore;else if(!U&&z.right<J.left||z.bottom<J.top)Y=G.posAfter;U=!0}if(!G.contentDOM&&Y<0&&!G.node.isText)return(G.node.isBlock?J.top<(z.top+z.bottom)/2:J.left<(z.left+z.right)/2)?G.posBefore:G.posAfter}q=G.dom.parentNode}return Y>-1?Y:Q.docView.posFromDOM(Z,X,-1)},DQ=function(Q,Z,X){let J=Q.childNodes.length;if(J&&X.top<X.bottom)for(let Y=Math.max(0,Math.min(J-1,Math.floor(J*(Z.top-X.top)/(X.bottom-X.top))-2)),q=Y;;){let U=Q.childNodes[q];if(U.nodeType==1){let G=U.getClientRects();for(let z=0;z<G.length;z++){let V=G[z];if(b6(Z,V))return DQ(U,Z,V)}}if((q=(q+1)%J)==Y)break}return Q},PZ=function(Q,Z){let X=Q.dom.ownerDocument,J,Y=0,q=UZ(X,Z.left,Z.top);if(q)({node:J,offset:Y}=q);let U=(Q.root.elementFromPoint?Q.root:X).elementFromPoint(Z.left,Z.top),G;if(!U||!Q.dom.contains(U.nodeType!=1?U.parentNode:U)){let V=Q.dom.getBoundingClientRect();if(!b6(Z,V))return null;if(U=DQ(Q.dom,Z,V),!U)return null}if(J0){for(let V=U;J&&V;V=C1(V))if(V.draggable)J=void 0}if(U=_Z(U,Z),J){if(I0&&J.nodeType==1){if(Y=Math.min(Y,J.childNodes.length),Y<J.childNodes.length){let K=J.childNodes[Y],H;if(K.nodeName=="IMG"&&(H=K.getBoundingClientRect()).right<=Z.left&&H.bottom>Z.top)Y++}}let V;if(e1&&Y&&J.nodeType==1&&(V=J.childNodes[Y-1]).nodeType==1&&V.contentEditable=="false"&&V.getBoundingClientRect().top>=Z.top)Y--;if(J==Q.dom&&Y==J.childNodes.length-1&&J.lastChild.nodeType==1&&Z.top>J.lastChild.getBoundingClientRect().bottom)G=Q.state.doc.content.size;else if(Y==0||J.nodeType!=1||J.childNodes[Y-1].nodeName!="BR")G=FZ(Q,J,Y,Z)}if(G==null)G=IZ(Q,U,Z);let z=Q.docView.nearestDesc(U,!0);return{pos:G,inside:z?z.posAtStart-z.border:-1}},p9=function(Q){return Q.top<Q.bottom||Q.left<Q.right},v0=function(Q,Z){let X=Q.getClientRects();if(X.length){let J=X[Z<0?0:X.length-1];if(p9(J))return J}return Array.prototype.find.call(X,p9)||Q.getBoundingClientRect()},MQ=function(Q,Z,X){let{node:J,offset:Y,atom:q}=Q.docView.domFromPos(Z,X<0?-1:1),U=e1||I0;if(J.nodeType==3)if(U&&(jZ.test(J.nodeValue)||(X<0?!Y:Y==J.nodeValue.length))){let z=v0(S0(J,Y,Y),X);if(I0&&Y&&/\s/.test(J.nodeValue[Y-1])&&Y<J.nodeValue.length){let V=v0(S0(J,Y-1,Y-1),-1);if(V.top==z.top){let K=v0(S0(J,Y,Y+1),-1);if(K.top!=z.top)return i1(K,K.left<V.left)}}return z}else{let z=Y,V=Y,K=X<0?1:-1;if(X<0&&!Y)V++,K=-1;else if(X>=0&&Y==J.nodeValue.length)z--,K=1;else if(X<0)z--;else V++;return i1(v0(S0(J,z,V),K),K<0)}if(!Q.state.doc.resolve(Z-(q||0)).parent.inlineContent){if(q==null&&Y&&(X<0||Y==L0(J))){let z=J.childNodes[Y-1];if(z.nodeType==1)return F6(z.getBoundingClientRect(),!1)}if(q==null&&Y<L0(J)){let z=J.childNodes[Y];if(z.nodeType==1)return F6(z.getBoundingClientRect(),!0)}return F6(J.getBoundingClientRect(),X>=0)}if(q==null&&Y&&(X<0||Y==L0(J))){let z=J.childNodes[Y-1],V=z.nodeType==3?S0(z,L0(z)-(U?0:1)):z.nodeType==1&&(z.nodeName!="BR"||!z.nextSibling)?z:null;if(V)return i1(v0(V,1),!1)}if(q==null&&Y<L0(J)){let z=J.childNodes[Y];while(z.pmViewDesc&&z.pmViewDesc.ignoreForCoords)z=z.nextSibling;let V=!z?null:z.nodeType==3?S0(z,0,U?0:1):z.nodeType==1?z:null;if(V)return i1(v0(V,-1),!0)}return i1(v0(J.nodeType==3?S0(J):J,-X),X>=0)},i1=function(Q,Z){if(Q.width==0)return Q;let X=Z?Q.left:Q.right;return{top:Q.top,bottom:Q.bottom,left:X,right:X}},F6=function(Q,Z){if(Q.height==0)return Q;let X=Z?Q.top:Q.bottom;return{top:X,bottom:X,left:Q.left,right:Q.right}},CQ=function(Q,Z,X){let J=Q.state,Y=Q.root.activeElement;if(J!=Z)Q.updateState(Z);if(Y!=Q.dom)Q.focus();try{return X()}finally{if(J!=Z)Q.updateState(J);if(Y!=Q.dom&&Y)Y.focus()}},EZ=function(Q,Z,X){let J=Z.selection,Y=X=="up"?J.$from:J.$to;return CQ(Q,Z,()=>{let{node:q}=Q.docView.domFromPos(Y.pos,X=="up"?-1:1);for(;;){let G=Q.docView.nearestDesc(q,!0);if(!G)break;if(G.node.isBlock){q=G.contentDOM||G.dom;break}q=G.dom.parentNode}let U=MQ(Q,Y.pos,1);for(let G=q.firstChild;G;G=G.nextSibling){let z;if(G.nodeType==1)z=G.getClientRects();else if(G.nodeType==3)z=S0(G,0,G.nodeValue.length).getClientRects();else continue;for(let V=0;V<z.length;V++){let K=z[V];if(K.bottom>K.top+1&&(X=="up"?U.top-K.top>(K.bottom-U.top)*2:K.bottom-U.bottom>(U.bottom-K.top)*2))return!1}}return!0})},OZ=function(Q,Z,X){let{$head:J}=Z.selection;if(!J.parent.isTextblock)return!1;let Y=J.parentOffset,q=!Y,U=Y==J.parent.content.size,G=Q.domSelection();if(!G)return J.pos==J.start()||J.pos==J.end();if(!AZ.test(J.parent.textContent)||!G.modify)return X=="left"||X=="backward"?q:U;return CQ(Q,Z,()=>{let{focusNode:z,focusOffset:V,anchorNode:K,anchorOffset:H}=Q.domSelectionRange(),W=G.caretBidiLevel;G.modify("move",X,"character");let B=J.depth?Q.docView.domAfterPos(J.before()):Q.dom,{focusNode:L,focusOffset:_}=Q.domSelectionRange(),I=L&&!B.contains(L.nodeType==1?L:L.parentNode)||z==L&&V==_;try{if(G.collapse(K,H),z&&(z!=K||V!=H)&&G.extend)G.extend(z,V)}catch(F){}if(W!=null)G.caretBidiLevel=W;return I})},RZ=function(Q,Z,X){if(d9==Z&&i9==X)return s9;return d9=Z,i9=X,s9=X=="up"||X=="down"?EZ(Q,Z,X):OZ(Q,Z,X)},n9=function(Q,Z,X,J,Y){bQ(J,Z,Q);let q=new c0(void 0,Q,Z,X,J,J,J,Y,0);if(q.contentDOM)q.updateChildren(Y,0);return q},SQ=function(Q,Z,X){let J=Q.firstChild,Y=!1;for(let q=0;q<Z.length;q++){let U=Z[q],G=U.dom;if(G.parentNode==Q){while(G!=J)J=r9(J),Y=!0;J=J.nextSibling}else Y=!0,Q.insertBefore(G,J);if(U instanceof U1){let z=J?J.previousSibling:Q.lastChild;SQ(U.contentDOM,U.children,X),J=z?z.nextSibling:Q.firstChild}}while(J)J=r9(J),Y=!0;if(Y&&X.trackWrites==Q)X.trackWrites=null},M6=function(Q,Z,X){if(Q.length==0)return X1;let J=X?X1[0]:new s1,Y=[J];for(let q=0;q<Q.length;q++){let U=Q[q].type.attrs;if(!U)continue;if(U.nodeName)Y.push(J=new s1(U.nodeName));for(let G in U){let z=U[G];if(z==null)continue;if(X&&Y.length==1)Y.push(J=new s1(Z.isInline?"span":"div"));if(G=="class")J.class=(J.class?J.class+" ":"")+z;else if(G=="style")J.style=(J.style?J.style+";":"")+z;else if(G!="nodeName")J[G]=z}}return Y},yQ=function(Q,Z,X,J){if(X==X1&&J==X1)return Z;let Y=Z;for(let q=0;q<J.length;q++){let U=J[q],G=X[q];if(q){let z;if(G&&G.nodeName==U.nodeName&&Y!=Q&&(z=Y.parentNode)&&z.nodeName.toLowerCase()==U.nodeName)Y=z;else z=document.createElement(U.nodeName),z.pmIsDeco=!0,z.appendChild(Y),G=X1[0],Y=z}NZ(Y,G||X1[0],U)}return Y},NZ=function(Q,Z,X){for(let J in Z)if(J!="class"&&J!="style"&&J!="nodeName"&&!(J in X))Q.removeAttribute(J);for(let J in X)if(J!="class"&&J!="style"&&J!="nodeName"&&X[J]!=Z[J])Q.setAttribute(J,X[J]);if(Z.class!=X.class){let J=Z.class?Z.class.split(" ").filter(Boolean):[],Y=X.class?X.class.split(" ").filter(Boolean):[];for(let q=0;q<J.length;q++)if(Y.indexOf(J[q])==-1)Q.classList.remove(J[q]);for(let q=0;q<Y.length;q++)if(J.indexOf(Y[q])==-1)Q.classList.add(Y[q]);if(Q.classList.length==0)Q.removeAttribute("class")}if(Z.style!=X.style){if(Z.style){let J=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,Y;while(Y=J.exec(Z.style))Q.style.removeProperty(Y[1])}if(X.style)Q.style.cssText+=X.style}},bQ=function(Q,Z,X){return yQ(Q,Q,X1,M6(Z,X,Q.nodeType!=1))},E5=function(Q,Z){if(Q.length!=Z.length)return!1;for(let X=0;X<Q.length;X++)if(!Q[X].type.eq(Z[X].type))return!1;return!0},r9=function(Q){let Z=Q.nextSibling;return Q.parentNode.removeChild(Q),Z},DZ=function(Q,Z){let X=Z,J=X.children.length,Y=Q.childCount,q=new Map,U=[];Q:while(Y>0){let G;for(;;)if(J){let V=X.children[J-1];if(V instanceof U1)X=V,J=V.children.length;else{G=V,J--;break}}else if(X==Z)break Q;else J=X.parent.children.indexOf(X),X=X.parent;let z=G.node;if(!z)continue;if(z!=Q.child(Y-1))break;--Y,q.set(G,Y),U.push(G)}return{index:Y,matched:q,matches:U.reverse()}},MZ=function(Q,Z){return Q.type.side-Z.type.side},CZ=function(Q,Z,X,J){let Y=Z.locals(Q),q=0;if(Y.length==0){for(let V=0;V<Q.childCount;V++){let K=Q.child(V);J(K,Y,Z.forChild(q,K),V),q+=K.nodeSize}return}let U=0,G=[],z=null;for(let V=0;;){let K,H;while(U<Y.length&&Y[U].to==q){let I=Y[U++];if(I.widget)if(!K)K=I;else(H||(H=[K])).push(I)}if(K)if(H){H.sort(MZ);for(let I=0;I<H.length;I++)X(H[I],V,!!z)}else X(K,V,!!z);let W,B;if(z)B=-1,W=z,z=null;else if(V<Q.childCount)B=V,W=Q.child(V++);else break;for(let I=0;I<G.length;I++)if(G[I].to<=q)G.splice(I--,1);while(U<Y.length&&Y[U].from<=q&&Y[U].to>q)G.push(Y[U++]);let L=q+W.nodeSize;if(W.isText){let I=L;if(U<Y.length&&Y[U].from<I)I=Y[U].from;for(let F=0;F<G.length;F++)if(G[F].to<I)I=G[F].to;if(I<L)z=W.cut(I-q),W=W.cut(0,I-q),L=I,B=-1}else while(U<Y.length&&Y[U].to<L)U++;let _=W.isInline&&!W.isLeaf?G.filter((I)=>!I.inline):G.slice();J(W,_,Z.forChild(q,W),B),q=L}},TZ=function(Q){if(Q.nodeName=="UL"||Q.nodeName=="OL"){let Z=Q.style.cssText;Q.style.cssText=Z+"; list-style: square !important",window.getComputedStyle(Q).listStyle,Q.style.cssText=Z}},kZ=function(Q,Z,X,J){for(let Y=0,q=0;Y<Q.childCount&&q<=J;){let U=Q.child(Y++),G=q;if(q+=U.nodeSize,!U.isText)continue;let z=U.text;while(Y<Q.childCount){let V=Q.child(Y++);if(q+=V.nodeSize,!V.isText)break;z+=V.text}if(q>=X){if(q>=J&&z.slice(J-Z.length-G,J-G)==Z)return J-Z.length;let V=G<J?z.lastIndexOf(Z,J-G-1):-1;if(V>=0&&V+Z.length+G>=X)return G+V;if(X==J&&z.length>=J+Z.length-G&&z.slice(J-G,J-G+Z.length)==Z)return J}}return-1},C6=function(Q,Z,X,J,Y){let q=[];for(let U=0,G=0;U<Q.length;U++){let z=Q[U],V=G,K=G+=z.size;if(V>=X||K<=Z)q.push(z);else{if(V<Z)q.push(z.slice(0,Z-V,J));if(Y)q.push(Y),Y=void 0;if(K>X)q.push(z.slice(X-V,z.size,J))}}return q},g6=function(Q,Z=null){let X=Q.domSelectionRange(),J=Q.state.doc;if(!X.focusNode)return null;let Y=Q.docView.nearestDesc(X.focusNode),q=Y&&Y.size==0,U=Q.docView.posFromDOM(X.focusNode,X.focusOffset,1);if(U<0)return null;let G=J.resolve(U),z,V;if(D5(X)){z=U;while(Y&&!Y.node)Y=Y.parent;let H=Y.node;if(Y&&H.isAtom&&R.isSelectable(H)&&Y.parent&&!(H.isInline&&YZ(X.focusNode,X.focusOffset,Y.dom))){let W=Y.posBefore;V=new R(U==W?G:J.resolve(W))}}else{if(X instanceof Q.dom.ownerDocument.defaultView.Selection&&X.rangeCount>1){let H=U,W=U;for(let B=0;B<X.rangeCount;B++){let L=X.getRangeAt(B);H=Math.min(H,Q.docView.posFromDOM(L.startContainer,L.startOffset,1)),W=Math.max(W,Q.docView.posFromDOM(L.endContainer,L.endOffset,-1))}if(H<0)return null;[z,U]=W==Q.state.selection.anchor?[W,H]:[H,W],G=J.resolve(U)}else z=Q.docView.posFromDOM(X.anchorNode,X.anchorOffset,1);if(z<0)return null}let K=J.resolve(z);if(!V){let H=Z=="pointer"||Q.state.selection.head<G.pos&&!q?1:-1;V=w6(Q,K,G,H)}return V},xQ=function(Q){return Q.editable?Q.hasFocus():wQ(Q)&&document.activeElement&&document.activeElement.contains(Q.dom)},b0=function(Q,Z=!1){let X=Q.state.selection;if(gQ(Q,X),!xQ(Q))return;if(!Z&&Q.input.mouseDown&&Q.input.mouseDown.allowDefault&&Z0){let J=Q.domSelectionRange(),Y=Q.domObserver.currentSelection;if(J.anchorNode&&Y.anchorNode&&q1(J.anchorNode,J.anchorOffset,Y.anchorNode,Y.anchorOffset)){Q.input.mouseDown.delayedSelectionSync=!0,Q.domObserver.setCurSelection();return}}if(Q.domObserver.disconnectSelection(),Q.cursorWrapper)yZ(Q);else{let{anchor:J,head:Y}=X,q,U;if(o9&&!(X instanceof O)){if(!X.$from.parent.inlineContent)q=t9(Q,X.from);if(!X.empty&&!X.$from.parent.inlineContent)U=t9(Q,X.to)}if(Q.docView.setSelection(J,Y,Q,Z),o9){if(q)e9(q);if(U)e9(U)}if(X.visible)Q.dom.classList.remove("ProseMirror-hideselection");else if(Q.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document)SZ(Q)}Q.domObserver.setCurSelection(),Q.domObserver.connectSelection()},t9=function(Q,Z){let{node:X,offset:J}=Q.docView.domFromPos(Z,0),Y=J<X.childNodes.length?X.childNodes[J]:null,q=J?X.childNodes[J-1]:null;if(J0&&Y&&Y.contentEditable=="false")return P6(Y);if((!Y||Y.contentEditable=="false")&&(!q||q.contentEditable=="false")){if(Y)return P6(Y);else if(q)return P6(q)}},P6=function(Q){if(Q.contentEditable="true",J0&&Q.draggable)Q.draggable=!1,Q.wasDraggable=!0;return Q},e9=function(Q){if(Q.contentEditable="false",Q.wasDraggable)Q.draggable=!0,Q.wasDraggable=null},SZ=function(Q){let Z=Q.dom.ownerDocument;Z.removeEventListener("selectionchange",Q.input.hideSelectionGuard);let X=Q.domSelectionRange(),J=X.anchorNode,Y=X.anchorOffset;Z.addEventListener("selectionchange",Q.input.hideSelectionGuard=()=>{if(X.anchorNode!=J||X.anchorOffset!=Y)Z.removeEventListener("selectionchange",Q.input.hideSelectionGuard),setTimeout(()=>{if(!xQ(Q)||Q.state.selection.visible)Q.dom.classList.remove("ProseMirror-hideselection")},20)})},yZ=function(Q){let Z=Q.domSelection(),X=document.createRange();if(!Z)return;let J=Q.cursorWrapper.dom,Y=J.nodeName=="IMG";if(Y)X.setStart(J.parentNode,o(J)+1);else X.setStart(J,0);if(X.collapse(!0),Z.removeAllRanges(),Z.addRange(X),!Y&&!Q.state.selection.visible&&U0&&l0<=11)J.disabled=!0,J.disabled=!1},gQ=function(Q,Z){if(Z instanceof R){let X=Q.docView.descAt(Z.from);if(X!=Q.lastSelectedViewDesc){if(QQ(Q),X)X.selectNode();Q.lastSelectedViewDesc=X}}else QQ(Q)},QQ=function(Q){if(Q.lastSelectedViewDesc){if(Q.lastSelectedViewDesc.parent)Q.lastSelectedViewDesc.deselectNode();Q.lastSelectedViewDesc=void 0}},w6=function(Q,Z,X,J){return Q.someProp("createSelectionBetween",(Y)=>Y(Q,Z,X))||O.between(Z,X,J)},ZQ=function(Q){if(Q.editable&&!Q.hasFocus())return!1;return wQ(Q)},wQ=function(Q){let Z=Q.domSelectionRange();if(!Z.anchorNode)return!1;try{return Q.dom.contains(Z.anchorNode.nodeType==3?Z.anchorNode.parentNode:Z.anchorNode)&&(Q.editable||Q.dom.contains(Z.focusNode.nodeType==3?Z.focusNode.parentNode:Z.focusNode))}catch(X){return!1}},bZ=function(Q){let Z=Q.docView.domFromPos(Q.state.selection.anchor,0),X=Q.domSelectionRange();return q1(Z.node,Z.offset,X.anchorNode,X.anchorOffset)},T6=function(Q,Z){let{$anchor:X,$head:J}=Q.selection,Y=Z>0?X.max(J):X.min(J),q=!Y.parent.inlineContent?Y:Y.depth?Q.doc.resolve(Z>0?Y.after():Y.before()):null;return q&&N.findFrom(q,Z)},f0=function(Q,Z){return Q.dispatch(Q.state.tr.setSelection(Z).scrollIntoView()),!0},XQ=function(Q,Z,X){let J=Q.state.selection;if(J instanceof O){if(X.indexOf("s")>-1){let{$head:Y}=J,q=Y.textOffset?null:Z<0?Y.nodeBefore:Y.nodeAfter;if(!q||q.isText||!q.isLeaf)return!1;let U=Q.state.doc.resolve(Y.pos+q.nodeSize*(Z<0?-1:1));return f0(Q,new O(J.$anchor,U))}else if(!J.empty)return!1;else if(Q.endOfTextblock(Z>0?"forward":"backward")){let Y=T6(Q.state,Z);if(Y&&Y instanceof R)return f0(Q,Y);return!1}else if(!(W0&&X.indexOf("m")>-1)){let Y=J.$head,q=Y.textOffset?null:Z<0?Y.nodeBefore:Y.nodeAfter,U;if(!q||q.isText)return!1;let G=Z<0?Y.pos-q.nodeSize:Y.pos;if(!(q.isAtom||(U=Q.docView.descAt(G))&&!U.contentDOM))return!1;if(R.isSelectable(q))return f0(Q,new R(Z<0?Q.state.doc.resolve(Y.pos-q.nodeSize):Y));else if(e1)return f0(Q,new O(Q.state.doc.resolve(Z<0?G:G+q.nodeSize)));else return!1}}else if(J instanceof R&&J.node.isInline)return f0(Q,new O(Z>0?J.$to:J.$from));else{let Y=T6(Q.state,Z);if(Y)return f0(Q,Y);return!1}},A5=function(Q){return Q.nodeType==3?Q.nodeValue.length:Q.childNodes.length},a1=function(Q,Z){let X=Q.pmViewDesc;return X&&X.size==0&&(Z<0||Q.nextSibling||Q.nodeName!="BR")},N1=function(Q,Z){return Z<0?$Z(Q):xZ(Q)},$Z=function(Q){let Z=Q.domSelectionRange(),X=Z.focusNode,J=Z.focusOffset;if(!X)return;let Y,q,U=!1;if(I0&&X.nodeType==1&&J<A5(X)&&a1(X.childNodes[J],-1))U=!0;for(;;)if(J>0)if(X.nodeType!=1)break;else{let G=X.childNodes[J-1];if(a1(G,-1))Y=X,q=--J;else if(G.nodeType==3)X=G,J=X.nodeValue.length;else break}else if(uQ(X))break;else{let G=X.previousSibling;while(G&&a1(G,-1))Y=X.parentNode,q=o(G),G=G.previousSibling;if(!G){if(X=X.parentNode,X==Q.dom)break;J=0}else X=G,J=A5(X)}if(U)k6(Q,X,J);else if(Y)k6(Q,Y,q)},xZ=function(Q){let Z=Q.domSelectionRange(),X=Z.focusNode,J=Z.focusOffset;if(!X)return;let Y=A5(X),q,U;for(;;)if(J<Y){if(X.nodeType!=1)break;let G=X.childNodes[J];if(a1(G,1))q=X,U=++J;else break}else if(uQ(X))break;else{let G=X.nextSibling;while(G&&a1(G,1))q=G.parentNode,U=o(G)+1,G=G.nextSibling;if(!G){if(X=X.parentNode,X==Q.dom)break;J=Y=0}else X=G,J=0,Y=A5(X)}if(q)k6(Q,q,U)},uQ=function(Q){let Z=Q.pmViewDesc;return Z&&Z.node&&Z.node.isBlock},gZ=function(Q,Z){while(Q&&Z==Q.childNodes.length&&!t1(Q))Z=o(Q)+1,Q=Q.parentNode;while(Q&&Z<Q.childNodes.length){let X=Q.childNodes[Z];if(X.nodeType==3)return X;if(X.nodeType==1&&X.contentEditable=="false")break;Q=X,Z=0}},wZ=function(Q,Z){while(Q&&!Z&&!t1(Q))Z=o(Q),Q=Q.parentNode;while(Q&&Z){let X=Q.childNodes[Z-1];if(X.nodeType==3)return X;if(X.nodeType==1&&X.contentEditable=="false")break;Q=X,Z=Q.childNodes.length}},k6=function(Q,Z,X){if(Z.nodeType!=3){let q,U;if(U=gZ(Z,X))Z=U,X=0;else if(q=wZ(Z,X))Z=q,X=q.nodeValue.length}let J=Q.domSelection();if(!J)return;if(D5(J)){let q=document.createRange();q.setEnd(Z,X),q.setStart(Z,X),J.removeAllRanges(),J.addRange(q)}else if(J.extend)J.extend(Z,X);Q.domObserver.setCurSelection();let{state:Y}=Q;setTimeout(()=>{if(Q.state==Y)b0(Q)},50)},JQ=function(Q,Z){let X=Q.state.doc.resolve(Z);if(!(Z0||GZ)&&X.parent.inlineContent){let Y=Q.coordsAtPos(Z);if(Z>X.start()){let q=Q.coordsAtPos(Z-1),U=(q.top+q.bottom)/2;if(U>Y.top&&U<Y.bottom&&Math.abs(q.left-Y.left)>1)return q.left<Y.left?"ltr":"rtl"}if(Z<X.end()){let q=Q.coordsAtPos(Z+1),U=(q.top+q.bottom)/2;if(U>Y.top&&U<Y.bottom&&Math.abs(q.left-Y.left)>1)return q.left>Y.left?"ltr":"rtl"}}return getComputedStyle(Q.dom).direction=="rtl"?"rtl":"ltr"},YQ=function(Q,Z,X){let J=Q.state.selection;if(J instanceof O&&!J.empty||X.indexOf("s")>-1)return!1;if(W0&&X.indexOf("m")>-1)return!1;let{$from:Y,$to:q}=J;if(!Y.parent.inlineContent||Q.endOfTextblock(Z<0?"up":"down")){let U=T6(Q.state,Z);if(U&&U instanceof R)return f0(Q,U)}if(!Y.parent.inlineContent){let U=Z<0?Y:q,G=J instanceof r?N.near(U,Z):N.findFrom(U,Z);return G?f0(Q,G):!1}return!1},qQ=function(Q,Z){if(!(Q.state.selection instanceof O))return!0;let{$head:X,$anchor:J,empty:Y}=Q.state.selection;if(!X.sameParent(J))return!0;if(!Y)return!1;if(Q.endOfTextblock(Z>0?"forward":"backward"))return!0;let q=!X.textOffset&&(Z<0?X.nodeBefore:X.nodeAfter);if(q&&!q.isText){let U=Q.state.tr;if(Z<0)U.delete(X.pos-q.nodeSize,X.pos);else U.delete(X.pos,X.pos+q.nodeSize);return Q.dispatch(U),!0}return!1},UQ=function(Q,Z,X){Q.domObserver.stop(),Z.contentEditable=X,Q.domObserver.start()},uZ=function(Q){if(!J0||Q.state.selection.$head.parentOffset>0)return!1;let{focusNode:Z,focusOffset:X}=Q.domSelectionRange();if(Z&&Z.nodeType==1&&X==0&&Z.firstChild&&Z.firstChild.contentEditable=="false"){let J=Z.firstChild;UQ(Q,J,"true"),setTimeout(()=>UQ(Q,J,"false"),20)}return!1},vZ=function(Q){let Z="";if(Q.ctrlKey)Z+="c";if(Q.metaKey)Z+="m";if(Q.altKey)Z+="a";if(Q.shiftKey)Z+="s";return Z},fZ=function(Q,Z){let X=Z.keyCode,J=vZ(Z);if(X==8||W0&&X==72&&J=="c")return qQ(Q,-1)||N1(Q,-1);else if(X==46&&!Z.shiftKey||W0&&X==68&&J=="c")return qQ(Q,1)||N1(Q,1);else if(X==13||X==27)return!0;else if(X==37||W0&&X==66&&J=="c"){let Y=X==37?JQ(Q,Q.state.selection.from)=="ltr"?-1:1:-1;return XQ(Q,Y,J)||N1(Q,Y)}else if(X==39||W0&&X==70&&J=="c"){let Y=X==39?JQ(Q,Q.state.selection.from)=="ltr"?1:-1:1;return XQ(Q,Y,J)||N1(Q,Y)}else if(X==38||W0&&X==80&&J=="c")return YQ(Q,-1,J)||N1(Q,-1);else if(X==40||W0&&X==78&&J=="c")return uZ(Q)||YQ(Q,1,J)||N1(Q,1);else if(J==(W0?"m":"c")&&(X==66||X==73||X==89||X==90))return!0;return!1},u6=function(Q,Z){Q.someProp("transformCopied",(B)=>{Z=B(Z,Q)});let X=[],{content:J,openStart:Y,openEnd:q}=Z;while(Y>1&&q>1&&J.childCount==1&&J.firstChild.childCount==1){Y--,q--;let B=J.firstChild;X.push(B.type.name,B.attrs!=B.type.defaultAttrs?B.attrs:null),J=B.content}let U=Q.someProp("clipboardSerializer")||C0.fromSchema(Q.state.schema),G=cQ(),z=G.createElement("div");z.appendChild(U.serializeFragment(J,{document:G}));let V=z.firstChild,K,H=0;while(V&&V.nodeType==1&&(K=lQ[V.nodeName.toLowerCase()])){for(let B=K.length-1;B>=0;B--){let L=G.createElement(K[B]);while(z.firstChild)L.appendChild(z.firstChild);z.appendChild(L),H++}V=z.firstChild}if(V&&V.nodeType==1)V.setAttribute("data-pm-slice",`${Y} ${q}${H?` -${H}`:""} ${JSON.stringify(X)}`);let W=Q.someProp("clipboardTextSerializer",(B)=>B(Z,Q))||Z.content.textBetween(0,Z.content.size,"\n\n");return{dom:z,text:W,slice:Z}},vQ=function(Q,Z,X,J,Y){let q=Y.parent.type.spec.code,U,G;if(!X&&!Z)return null;let z=Z&&(J||q||!X);if(z){if(Q.someProp("transformPastedText",(W)=>{Z=W(Z,q||J,Q)}),q)return Z?new j(P.from(Q.state.schema.text(Z.replace(/\r\n?/g,"\n"))),0,0):j.empty;let H=Q.someProp("clipboardTextParser",(W)=>W(Z,Y,J,Q));if(H)G=H;else{let W=Y.marks(),{schema:B}=Q.state,L=C0.fromSchema(B);U=document.createElement("div"),Z.split(/(?:\r\n?|\n)+/).forEach((_)=>{let I=U.appendChild(document.createElement("p"));if(_)I.appendChild(L.serializeNode(B.text(_,W)))})}}else if(Q.someProp("transformPastedHTML",(H)=>{X=H(X,Q)}),U=cZ(X),e1)pZ(U);let V=U&&U.querySelector("[data-pm-slice]"),K=V&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(V.getAttribute("data-pm-slice")||"");if(K&&K[3])for(let H=+K[3];H>0;H--){let W=U.firstChild;while(W&&W.nodeType!=1)W=W.nextSibling;if(!W)break;U=W}if(!G)G=(Q.someProp("clipboardParser")||Q.someProp("domParser")||j0.fromSchema(Q.state.schema)).parseSlice(U,{preserveWhitespace:!!(z||K),context:Y,ruleFromNode(W){if(W.nodeName=="BR"&&!W.nextSibling&&W.parentNode&&!hZ.test(W.parentNode.nodeName))return{ignore:!0};return null}});if(K)G=dZ(GQ(G,+K[1],+K[2]),K[4]);else if(G=j.maxOpen(mZ(G.content,Y),!0),G.openStart||G.openEnd){let H=0,W=0;for(let B=G.content.firstChild;H<G.openStart&&!B.type.spec.isolating;H++,B=B.firstChild);for(let B=G.content.lastChild;W<G.openEnd&&!B.type.spec.isolating;W++,B=B.lastChild);G=GQ(G,H,W)}return Q.someProp("transformPasted",(H)=>{G=H(G,Q)}),G},mZ=function(Q,Z){if(Q.childCount<2)return Q;for(let X=Z.depth;X>=0;X--){let Y=Z.node(X).contentMatchAt(Z.index(X)),q,U=[];if(Q.forEach((G)=>{if(!U)return;let z=Y.findWrapping(G.type),V;if(!z)return U=null;if(V=U.length&&q.length&&hQ(z,q,G,U[U.length-1],0))U[U.length-1]=V;else{if(U.length)U[U.length-1]=mQ(U[U.length-1],q.length);let K=fQ(G,z);U.push(K),Y=Y.matchType(K.type),q=z}}),U)return P.from(U)}return Q},fQ=function(Q,Z,X=0){for(let J=Z.length-1;J>=X;J--)Q=Z[J].create(null,P.from(Q));return Q},hQ=function(Q,Z,X,J,Y){if(Y<Q.length&&Y<Z.length&&Q[Y]==Z[Y]){let q=hQ(Q,Z,X,J.lastChild,Y+1);if(q)return J.copy(J.content.replaceChild(J.childCount-1,q));if(J.contentMatchAt(J.childCount).matchType(Y==Q.length-1?X.type:Q[Y+1]))return J.copy(J.content.append(P.from(fQ(X,Q,Y+1))))}},mQ=function(Q,Z){if(Z==0)return Q;let X=Q.content.replaceChild(Q.childCount-1,mQ(Q.lastChild,Z-1)),J=Q.contentMatchAt(Q.childCount).fillBefore(P.empty,!0);return Q.copy(X.append(J))},S6=function(Q,Z,X,J,Y,q){let U=Z<0?Q.firstChild:Q.lastChild,G=U.content;if(Q.childCount>1)q=0;if(Y<J-1)G=S6(G,Z,X,J,Y+1,q);if(Y>=X)G=Z<0?U.contentMatchAt(0).fillBefore(G,q<=Y).append(G):G.append(U.contentMatchAt(U.childCount).fillBefore(P.empty,!0));return Q.replaceChild(Z<0?0:Q.childCount-1,U.copy(G))},GQ=function(Q,Z,X){if(Z<Q.openStart)Q=new j(S6(Q.content,-1,Z,Q.openStart,0,Q.openEnd),Z,Q.openEnd);if(X<Q.openEnd)Q=new j(S6(Q.content,1,X,Q.openEnd,0,0),Q.openStart,X);return Q},cQ=function(){return zQ||(zQ=document.implementation.createHTMLDocument("title"))},lZ=function(Q){let Z=window.trustedTypes;if(!Z)return Q;if(!j6)j6=Z.createPolicy("ProseMirrorClipboard",{createHTML:(X)=>X});return j6.createHTML(Q)},cZ=function(Q){let Z=/^(\s*<meta [^>]*>)*/.exec(Q);if(Z)Q=Q.slice(Z[0].length);let X=cQ().createElement("div"),J=/<([a-z][^>\s]+)/i.exec(Q),Y;if(Y=J&&lQ[J[1].toLowerCase()])Q=Y.map((q)=>"<"+q+">").join("")+Q+Y.map((q)=>"</"+q+">").reverse().join("");if(X.innerHTML=lZ(Q),Y)for(let q=0;q<Y.length;q++)X=X.querySelector(Y[q])||X;return X},pZ=function(Q){let Z=Q.querySelectorAll(Z0?"span:not([class]):not([style])":"span.Apple-converted-space");for(let X=0;X<Z.length;X++){let J=Z[X];if(J.childNodes.length==1&&J.textContent=="\xA0"&&J.parentNode)J.parentNode.replaceChild(Q.ownerDocument.createTextNode(" "),J)}},dZ=function(Q,Z){if(!Q.size)return Q;let X=Q.content.firstChild.type.schema,J;try{J=JSON.parse(Z)}catch(G){return Q}let{content:Y,openStart:q,openEnd:U}=Q;for(let G=J.length-2;G>=0;G-=2){let z=X.nodes[J[G]];if(!z||z.hasRequiredAttrs())break;Y=P.from(z.create(J[G+1],Y)),q++,U++}return new j(Y,q,U)},sZ=function(Q){for(let Z in Y0){let X=Y0[Z];Q.dom.addEventListener(Z,Q.input.eventHandlers[Z]=(J)=>{if(nZ(Q,J)&&!v6(Q,J)&&(Q.editable||!(J.type in q0)))X(Q,J)},iZ[Z]?{passive:!0}:void 0)}if(J0)Q.dom.addEventListener("input",()=>null);y6(Q)},m0=function(Q,Z){Q.input.lastSelectionOrigin=Z,Q.input.lastSelectionTime=Date.now()},aZ=function(Q){Q.domObserver.stop();for(let Z in Q.input.eventHandlers)Q.dom.removeEventListener(Z,Q.input.eventHandlers[Z]);clearTimeout(Q.input.composingTimeout),clearTimeout(Q.input.lastIOSEnterFallbackTimeout)},y6=function(Q){Q.someProp("handleDOMEvents",(Z)=>{for(let X in Z)if(!Q.input.eventHandlers[X])Q.dom.addEventListener(X,Q.input.eventHandlers[X]=(J)=>v6(Q,J))})},v6=function(Q,Z){return Q.someProp("handleDOMEvents",(X)=>{let J=X[Z.type];return J?J(Q,Z)||Z.defaultPrevented:!1})},nZ=function(Q,Z){if(!Z.bubbles)return!0;if(Z.defaultPrevented)return!1;for(let X=Z.target;X!=Q.dom;X=X.parentNode)if(!X||X.nodeType==11||X.pmViewDesc&&X.pmViewDesc.stopEvent(Z))return!1;return!0},rZ=function(Q,Z){if(!v6(Q,Z)&&Y0[Z.type]&&(Q.editable||!(Z.type in q0)))Y0[Z.type](Q,Z)},C5=function(Q){return{left:Q.clientX,top:Q.clientY}},oZ=function(Q,Z){let X=Z.x-Q.clientX,J=Z.y-Q.clientY;return X*X+J*J<100},f6=function(Q,Z,X,J,Y){if(J==-1)return!1;let q=Q.state.doc.resolve(J);for(let U=q.depth+1;U>0;U--)if(Q.someProp(Z,(G)=>U>q.depth?G(Q,X,q.nodeAfter,q.before(U),Y,!0):G(Q,X,q.node(U),q.before(U),Y,!1)))return!0;return!1},M1=function(Q,Z,X){if(!Q.focused)Q.focus();if(Q.state.selection.eq(Z))return;let J=Q.state.tr.setSelection(Z);if(X=="pointer")J.setMeta("pointer",!0);Q.dispatch(J)},tZ=function(Q,Z){if(Z==-1)return!1;let X=Q.state.doc.resolve(Z),J=X.nodeAfter;if(J&&J.isAtom&&R.isSelectable(J))return M1(Q,new R(X),"pointer"),!0;return!1},eZ=function(Q,Z){if(Z==-1)return!1;let X=Q.state.selection,J,Y;if(X instanceof R)J=X.node;let q=Q.state.doc.resolve(Z);for(let U=q.depth+1;U>0;U--){let G=U>q.depth?q.nodeAfter:q.node(U);if(R.isSelectable(G)){if(J&&X.$from.depth>0&&U>=X.$from.depth&&q.before(X.$from.depth+1)==X.$from.pos)Y=q.before(X.$from.depth);else Y=q.before(U);break}}if(Y!=null)return M1(Q,R.create(Q.state.doc,Y),"pointer"),!0;else return!1},QX=function(Q,Z,X,J,Y){return f6(Q,"handleClickOn",Z,X,J)||Q.someProp("handleClick",(q)=>q(Q,Z,J))||(Y?eZ(Q,X):tZ(Q,X))},ZX=function(Q,Z,X,J){return f6(Q,"handleDoubleClickOn",Z,X,J)||Q.someProp("handleDoubleClick",(Y)=>Y(Q,Z,J))},XX=function(Q,Z,X,J){return f6(Q,"handleTripleClickOn",Z,X,J)||Q.someProp("handleTripleClick",(Y)=>Y(Q,Z,J))||JX(Q,X,J)},JX=function(Q,Z,X){if(X.button!=0)return!1;let J=Q.state.doc;if(Z==-1){if(J.inlineContent)return M1(Q,O.create(J,0,J.content.size),"pointer"),!0;return!1}let Y=J.resolve(Z);for(let q=Y.depth+1;q>0;q--){let U=q>Y.depth?Y.nodeAfter:Y.node(q),G=Y.before(q);if(U.inlineContent)M1(Q,O.create(J,G+1,G+1+U.content.size),"pointer");else if(R.isSelectable(U))M1(Q,R.create(J,G),"pointer");else continue;return!0}},h6=function(Q){return O5(Q)},sQ=function(Q,Z){if(Q.composing)return!0;if(J0&&Math.abs(Z.timeStamp-Q.input.compositionEndedAt)<500)return Q.input.compositionEndedAt=-200000000,!0;return!1},aQ=function(Q,Z){if(clearTimeout(Q.input.composingTimeout),Z>-1)Q.input.composingTimeout=setTimeout(()=>O5(Q),Z)},nQ=function(Q){if(Q.composing)Q.input.composing=!1,Q.input.compositionEndedAt=UX();while(Q.input.compositionNodes.length>0)Q.input.compositionNodes.pop().markParentsDirty()},qX=function(Q){let Z=Q.domSelectionRange();if(!Z.focusNode)return null;let X=XZ(Z.focusNode,Z.focusOffset),J=JZ(Z.focusNode,Z.focusOffset);if(X&&J&&X!=J){let Y=J.pmViewDesc,q=Q.domObserver.lastChangedTextNode;if(X==q||J==q)return q;if(!Y||!Y.isText(J.nodeValue))return J;else if(Q.input.compositionNode==J){let U=X.pmViewDesc;if(!(!U||!U.isText(X.nodeValue)))return J}}return X||J},UX=function(){let Q=document.createEvent("Event");return Q.initEvent("event",!0,!0),Q.timeStamp},O5=function(Q,Z=!1){if(y0&&Q.domObserver.flushingSoon>=0)return;if(Q.domObserver.forceFlush(),nQ(Q),Z||Q.docView&&Q.docView.dirty){let X=g6(Q);if(X&&!X.eq(Q.state.selection))Q.dispatch(Q.state.tr.setSelection(X));else if((Q.markCursor||Z)&&!Q.state.selection.empty)Q.dispatch(Q.state.tr.deleteSelection());else Q.updateState(Q.state);return!0}return!1},GX=function(Q,Z){if(!Q.dom.parentNode)return;let X=Q.dom.parentNode.appendChild(document.createElement("div"));X.appendChild(Z),X.style.cssText="position: fixed; left: -10000px; top: 10px";let J=getSelection(),Y=document.createRange();Y.selectNodeContents(Z),Q.dom.blur(),J.removeAllRanges(),J.addRange(Y),setTimeout(()=>{if(X.parentNode)X.parentNode.removeChild(X);Q.focus()},50)},zX=function(Q){return Q.openStart==0&&Q.openEnd==0&&Q.content.childCount==1?Q.content.firstChild:null},VX=function(Q,Z){if(!Q.dom.parentNode)return;let X=Q.input.shiftKey||Q.state.selection.$from.parent.type.spec.code,J=Q.dom.parentNode.appendChild(document.createElement(X?"textarea":"div"));if(!X)J.contentEditable="true";J.style.cssText="position: fixed; left: -10000px; top: 10px",J.focus();let Y=Q.input.shiftKey&&Q.input.lastKeyCode!=45;setTimeout(()=>{if(Q.focus(),J.parentNode)J.parentNode.removeChild(J);if(X)r1(Q,J.value,null,Y,Z);else r1(Q,J.textContent,J.innerHTML,Y,Z)},50)},r1=function(Q,Z,X,J,Y){let q=vQ(Q,Z,X,J,Q.state.selection.$from);if(Q.someProp("handlePaste",(z)=>z(Q,Y,q||j.empty)))return!0;if(!q)return!1;let U=zX(q),G=U?Q.state.tr.replaceSelectionWith(U,J):Q.state.tr.replaceSelection(q);return Q.dispatch(G.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0},rQ=function(Q){let Z=Q.getData("text/plain")||Q.getData("Text");if(Z)return Z;let X=Q.getData("text/uri-list");return X?X.replace(/\r?\n/g," "):""},o1=function(Q,Z){if(Q==Z)return!0;for(let X in Q)if(Q[X]!==Z[X])return!1;for(let X in Z)if(!(X in Q))return!1;return!0},KX=function(Q,Z,X,J,Y,q,U){let G=Q.slice();for(let V=0,K=q;V<X.maps.length;V++){let H=0;X.maps[V].forEach((W,B,L,_)=>{let I=_-L-(B-W);for(let F=0;F<G.length;F+=3){let E=G[F+1];if(E<0||W>E+K-H)continue;let M=G[F]+K-H;if(B>=M)G[F+1]=W<=M?-2:-1;else if(W>=K&&I)G[F]+=I,G[F+1]+=I}H+=I}),K=X.maps[V].map(K,-1)}let z=!1;for(let V=0;V<G.length;V+=3)if(G[V+1]<0){if(G[V+1]==-2){z=!0,G[V+1]=-1;continue}let K=X.map(Q[V]+q),H=K-Y;if(H<0||H>=J.content.size){z=!0;continue}let W=X.map(Q[V+1]+q,-1),B=W-Y,{index:L,offset:_}=J.content.findIndex(H),I=J.maybeChild(L);if(I&&_==H&&_+I.nodeSize==B){let F=G[V+2].mapInner(X,I,K+1,Q[V]+q+1,U);if(F!=Q0)G[V]=H,G[V+1]=B,G[V+2]=F;else G[V+1]=-2,z=!0}else z=!0}if(z){let V=HX(G,Q,Z,X,Y,q,U),K=N5(V,J,0,U);Z=K.local;for(let H=0;H<G.length;H+=3)if(G[H+1]<0)G.splice(H,3),H-=3;for(let H=0,W=0;H<K.children.length;H+=3){let B=K.children[H];while(W<G.length&&G[W]<B)W+=3;G.splice(W,0,K.children[H],K.children[H+1],K.children[H+2])}}return new w(Z.sort(Y1),G)},tQ=function(Q,Z){if(!Z||!Q.length)return Q;let X=[];for(let J=0;J<Q.length;J++){let Y=Q[J];X.push(new s(Y.from+Z,Y.to+Z,Y.type))}return X},HX=function(Q,Z,X,J,Y,q,U){function G(z,V){for(let K=0;K<z.local.length;K++){let H=z.local[K].map(J,Y,V);if(H)X.push(H);else if(U.onRemove)U.onRemove(z.local[K].spec)}for(let K=0;K<z.children.length;K+=3)G(z.children[K+2],z.children[K]+V+1)}for(let z=0;z<Q.length;z+=3)if(Q[z+1]==-1)G(Q[z+2],Z[z]+q+1);return X},eQ=function(Q,Z,X){if(Z.isLeaf)return null;let J=X+Z.nodeSize,Y=null;for(let q=0,U;q<Q.length;q++)if((U=Q[q])&&U.from>X&&U.to<J)(Y||(Y=[])).push(U),Q[q]=null;return Y},Q4=function(Q){let Z=[];for(let X=0;X<Q.length;X++)if(Q[X]!=null)Z.push(Q[X]);return Z},N5=function(Q,Z,X,J){let Y=[],q=!1;Z.forEach((G,z)=>{let V=eQ(Q,G,z+X);if(V){q=!0;let K=N5(V,G,X+z+1,J);if(K!=Q0)Y.push(z,z+G.nodeSize,K)}});let U=tQ(q?Q4(Q):Q,-X).sort(Y1);for(let G=0;G<U.length;G++)if(!U[G].type.valid(Z,U[G])){if(J.onRemove)J.onRemove(U[G].spec);U.splice(G--,1)}return U.length||Y.length?new w(U,Y):Q0},Y1=function(Q,Z){return Q.from-Z.from||Q.to-Z.to},c6=function(Q){let Z=Q;for(let X=0;X<Z.length-1;X++){let J=Z[X];if(J.from!=J.to)for(let Y=X+1;Y<Z.length;Y++){let q=Z[Y];if(q.from==J.from){if(q.to!=J.to){if(Z==Q)Z=Q.slice();Z[Y]=q.copy(q.from,J.to),VQ(Z,Y+1,q.copy(J.to,q.to))}continue}else{if(q.from<J.to){if(Z==Q)Z=Q.slice();Z[X]=J.copy(J.from,q.from),VQ(Z,Y,J.copy(q.from,J.to))}break}}}return Z},VQ=function(Q,Z,X){while(Z<Q.length&&Y1(X,Q[Z])>0)Z++;Q.splice(Z,0,X)},E6=function(Q){let Z=[];if(Q.someProp("decorations",(X)=>{let J=X(Q.state);if(J&&J!=Q0)Z.push(J)}),Q.cursorWrapper)Z.push(w.create(Q.state.doc,[Q.cursorWrapper.deco]));return h0.from(Z)},BX=function(Q){if(KQ.has(Q))return;if(KQ.set(Q,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(Q.dom).whiteSpace)!==-1){if(Q.requiresGeckoHackNode=I0,HQ)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),HQ=!0}},WQ=function(Q,Z){let{startContainer:X,startOffset:J,endContainer:Y,endOffset:q}=Z,U=Q.domAtPos(Q.state.selection.anchor);if(q1(U.node,U.offset,Y,q))[X,J,Y,q]=[Y,q,X,J];return{anchorNode:X,anchorOffset:J,focusNode:Y,focusOffset:q}},_X=function(Q,Z){if(Z.getComposedRanges){let Y=Z.getComposedRanges(Q.root)[0];if(Y)return WQ(Q,Y)}let X;function J(Y){Y.preventDefault(),Y.stopImmediatePropagation(),X=Y.getTargetRanges()[0]}return Q.dom.addEventListener("beforeinput",J,!0),document.execCommand("indent"),Q.dom.removeEventListener("beforeinput",J,!0),X?WQ(Q,X):null},IX=function(Q,Z){for(let X=Z.parentNode;X&&X!=Q.dom;X=X.parentNode){let J=Q.docView.nearestDesc(X,!0);if(J&&J.node.isBlock)return X}return null},FX=function(Q,Z,X){let{node:J,fromOffset:Y,toOffset:q,from:U,to:G}=Q.docView.parseRange(Z,X),z=Q.domSelectionRange(),V,K=z.anchorNode;if(K&&Q.dom.contains(K.nodeType==1?K:K.parentNode)){if(V=[{node:K,offset:z.anchorOffset}],!D5(z))V.push({node:z.focusNode,offset:z.focusOffset})}if(Z0&&Q.input.lastKeyCode===8)for(let I=q;I>Y;I--){let F=J.childNodes[I-1],E=F.pmViewDesc;if(F.nodeName=="BR"&&!E){q=I;break}if(!E||E.size)break}let H=Q.state.doc,W=Q.someProp("domParser")||j0.fromSchema(Q.state.schema),B=H.resolve(U),L=null,_=W.parse(J,{topNode:B.parent,topMatch:B.parent.contentMatchAt(B.index()),topOpen:!0,from:Y,to:q,preserveWhitespace:B.parent.type.whitespace=="pre"?"full":!0,findPositions:V,ruleFromNode:PX,context:B});if(V&&V[0].pos!=null){let I=V[0].pos,F=V[1]&&V[1].pos;if(F==null)F=I;L={anchor:I+U,head:F+U}}return{doc:_,sel:L,from:U,to:G}},PX=function(Q){let Z=Q.pmViewDesc;if(Z)return Z.parseRule();else if(Q.nodeName=="BR"&&Q.parentNode){if(J0&&/^(ul|ol)$/i.test(Q.parentNode.nodeName)){let X=document.createElement("div");return X.appendChild(document.createElement("li")),{skip:X}}else if(Q.parentNode.lastChild==Q||J0&&/^(tr|table)$/i.test(Q.parentNode.nodeName))return{ignore:!0}}else if(Q.nodeName=="IMG"&&Q.getAttribute("mark-placeholder"))return{ignore:!0};return null},EX=function(Q,Z,X,J,Y){let q=Q.input.compositionPendingChanges||(Q.composing?Q.input.compositionID:0);if(Q.input.compositionPendingChanges=0,Z<0){let S=Q.input.lastSelectionTime>Date.now()-50?Q.input.lastSelectionOrigin:null,g0=g6(Q,S);if(g0&&!Q.state.selection.eq(g0)){if(Z0&&y0&&Q.input.lastKeyCode===13&&Date.now()-100<Q.input.lastKeyCodeTime&&Q.someProp("handleKeyDown",(K2)=>K2(Q,Q1(13,"Enter"))))return;let U5=Q.state.tr.setSelection(g0);if(S=="pointer")U5.setMeta("pointer",!0);else if(S=="key")U5.scrollIntoView();if(q)U5.setMeta("composition",q);Q.dispatch(U5)}return}let U=Q.state.doc.resolve(Z),G=U.sharedDepth(X);Z=U.before(G+1),X=Q.state.doc.resolve(X).after(G+1);let z=Q.state.selection,V=FX(Q,Z,X),K=Q.state.doc,H=K.slice(V.from,V.to),W,B;if(Q.input.lastKeyCode===8&&Date.now()-100<Q.input.lastKeyCodeTime)W=Q.state.selection.to,B="end";else W=Q.state.selection.from,B="start";Q.input.lastKeyCode=null;let L=RX(H.content,V.doc.content,V.from,W,B);if(L)Q.input.domChangeCount++;if((T1&&Q.input.lastIOSEnter>Date.now()-225||y0)&&Y.some((S)=>S.nodeType==1&&!jX.test(S.nodeName))&&(!L||L.endA>=L.endB)&&Q.someProp("handleKeyDown",(S)=>S(Q,Q1(13,"Enter")))){Q.input.lastIOSEnter=0;return}if(!L)if(J&&z instanceof O&&!z.empty&&z.$head.sameParent(z.$anchor)&&!Q.composing&&!(V.sel&&V.sel.anchor!=V.sel.head))L={start:z.from,endA:z.to,endB:z.to};else{if(V.sel){let S=LQ(Q,Q.state.doc,V.sel);if(S&&!S.eq(Q.state.selection)){let g0=Q.state.tr.setSelection(S);if(q)g0.setMeta("composition",q);Q.dispatch(g0)}}return}if(Q.state.selection.from<Q.state.selection.to&&L.start==L.endB&&Q.state.selection instanceof O){if(L.start>Q.state.selection.from&&L.start<=Q.state.selection.from+2&&Q.state.selection.from>=V.from)L.start=Q.state.selection.from;else if(L.endA<Q.state.selection.to&&L.endA>=Q.state.selection.to-2&&Q.state.selection.to<=V.to)L.endB+=Q.state.selection.to-L.endA,L.endA=Q.state.selection.to}if(U0&&l0<=11&&L.endB==L.start+1&&L.endA==L.start&&L.start>V.from&&V.doc.textBetween(L.start-V.from-1,L.start-V.from+1)==" \xA0")L.start--,L.endA--,L.endB--;let _=V.doc.resolveNoCache(L.start-V.from),I=V.doc.resolveNoCache(L.endB-V.from),F=K.resolve(L.start),E=_.sameParent(I)&&_.parent.inlineContent&&F.end()>=L.endA,M;if((T1&&Q.input.lastIOSEnter>Date.now()-225&&(!E||Y.some((S)=>S.nodeName=="DIV"||S.nodeName=="P"))||!E&&_.pos<V.doc.content.size&&!_.sameParent(I)&&(M=N.findFrom(V.doc.resolve(_.pos+1),1,!0))&&M.head==I.pos)&&Q.someProp("handleKeyDown",(S)=>S(Q,Q1(13,"Enter")))){Q.input.lastIOSEnter=0;return}if(Q.state.selection.anchor>L.start&&OX(K,L.start,L.endA,_,I)&&Q.someProp("handleKeyDown",(S)=>S(Q,Q1(8,"Backspace")))){if(y0&&Z0)Q.domObserver.suppressSelectionUpdates();return}if(Z0&&L.endB==L.start)Q.input.lastChromeDelete=Date.now();if(y0&&!E&&_.start()!=I.start()&&I.parentOffset==0&&_.depth==I.depth&&V.sel&&V.sel.anchor==V.sel.head&&V.sel.head==L.endA)L.endB-=2,I=V.doc.resolveNoCache(L.endB-V.from),setTimeout(()=>{Q.someProp("handleKeyDown",function(S){return S(Q,Q1(13,"Enter"))})},20);let{start:$,endA:k}=L,y,m,d;if(E){if(_.pos==I.pos){if(U0&&l0<=11&&_.parentOffset==0)Q.domObserver.suppressSelectionUpdates(),setTimeout(()=>b0(Q),20);y=Q.state.tr.delete($,k),m=K.resolve(L.start).marksAcross(K.resolve(L.endA))}else if(L.endA==L.endB&&(d=AX(_.parent.content.cut(_.parentOffset,I.parentOffset),F.parent.content.cut(F.parentOffset,L.endA-F.start()))))if(y=Q.state.tr,d.type=="add")y.addMark($,k,d.mark);else y.removeMark($,k,d.mark);else if(_.parent.child(_.index()).isText&&_.index()==I.index()-(I.textOffset?0:1)){let S=_.parent.textBetween(_.parentOffset,I.parentOffset);if(Q.someProp("handleTextInput",(g0)=>g0(Q,$,k,S)))return;y=Q.state.tr.insertText(S,$,k)}}if(!y)y=Q.state.tr.replace($,k,V.doc.slice(L.start-V.from,L.endB-V.from));if(V.sel){let S=LQ(Q,y.doc,V.sel);if(S&&!(Z0&&Q.composing&&S.empty&&(L.start!=L.endB||Q.input.lastChromeDelete<Date.now()-100)&&(S.head==$||S.head==y.mapping.map(k)-1)||U0&&S.empty&&S.head==$))y.setSelection(S)}if(m)y.ensureMarks(m);if(q)y.setMeta("composition",q);Q.dispatch(y.scrollIntoView())},LQ=function(Q,Z,X){if(Math.max(X.anchor,X.head)>Z.content.size)return null;return w6(Q,Z.resolve(X.anchor),Z.resolve(X.head))},AX=function(Q,Z){let X=Q.firstChild.marks,J=Z.firstChild.marks,Y=X,q=J,U,G,z;for(let K=0;K<J.length;K++)Y=J[K].removeFromSet(Y);for(let K=0;K<X.length;K++)q=X[K].removeFromSet(q);if(Y.length==1&&q.length==0)G=Y[0],U="add",z=(K)=>K.mark(G.addToSet(K.marks));else if(Y.length==0&&q.length==1)G=q[0],U="remove",z=(K)=>K.mark(G.removeFromSet(K.marks));else return null;let V=[];for(let K=0;K<Z.childCount;K++)V.push(z(Z.child(K)));if(P.from(V).eq(Q))return{mark:G,type:U}},OX=function(Q,Z,X,J,Y){if(X-Z<=Y.pos-J.pos||A6(J,!0,!1)<Y.pos)return!1;let q=Q.resolve(Z);if(!J.parent.isTextblock){let G=q.nodeAfter;return G!=null&&X==Z+G.nodeSize}if(q.parentOffset<q.parent.content.size||!q.parent.isTextblock)return!1;let U=Q.resolve(A6(q,!0,!0));if(!U.parent.isTextblock||U.pos>X||A6(U,!0,!1)<X)return!1;return J.parent.content.cut(J.parentOffset).eq(U.parent.content)},A6=function(Q,Z,X){let J=Q.depth,Y=Z?Q.end():Q.pos;while(J>0&&(Z||Q.indexAfter(J)==Q.node(J).childCount))J--,Y++,Z=!1;if(X){let q=Q.node(J).maybeChild(Q.indexAfter(J));while(q&&!q.isLeaf)q=q.firstChild,Y++}return Y},RX=function(Q,Z,X,J,Y){let q=Q.findDiffStart(Z,X);if(q==null)return null;let{a:U,b:G}=Q.findDiffEnd(Z,X+Q.size,X+Z.size);if(Y=="end"){let z=Math.max(0,q-Math.min(U,G));J-=U+z-q}if(U<q&&Q.size<Z.size){let z=J<=q&&J>=U?q-J:0;if(q-=z,q&&q<Z.size&&BQ(Z.textBetween(q-1,q+1)))q+=z?1:-1;G=q+(G-U),U=q}else if(G<q){let z=J<=q&&J>=G?q-J:0;if(q-=z,q&&q<Q.size&&BQ(Q.textBetween(q-1,q+1)))q+=z?1:-1;U=q+(U-G),G=q}return{start:q,endA:U,endB:G}},BQ=function(Q){if(Q.length!=2)return!1;let Z=Q.charCodeAt(0),X=Q.charCodeAt(1);return Z>=56320&&Z<=57343&&X>=55296&&X<=56319},_Q=function(Q){let Z=Object.create(null);if(Z.class="ProseMirror",Z.contenteditable=String(Q.editable),Q.someProp("attributes",(X)=>{if(typeof X=="function")X=X(Q.state);if(X){for(let J in X)if(J=="class")Z.class+=" "+X[J];else if(J=="style")Z.style=(Z.style?Z.style+";":"")+X[J];else if(!Z[J]&&J!="contenteditable"&&J!="nodeName")Z[J]=String(X[J])}}),!Z.translate)Z.translate="no";return[s.node(0,Q.state.doc.content.size,Z)]},IQ=function(Q){if(Q.markCursor){let Z=document.createElement("img");Z.className="ProseMirror-separator",Z.setAttribute("mark-placeholder","true"),Z.setAttribute("alt",""),Q.cursorWrapper={dom:Z,deco:s.widget(Q.state.selection.from,Z,{raw:!0,marks:Q.markCursor})}}else Q.cursorWrapper=null},FQ=function(Q){return!Q.someProp("editable",(Z)=>Z(Q.state)===!1)},NX=function(Q,Z){let X=Math.min(Q.$anchor.sharedDepth(Q.head),Z.$anchor.sharedDepth(Z.head));return Q.$anchor.start(X)!=Z.$anchor.start(X)},PQ=function(Q){let Z=Object.create(null);function X(J){for(let Y in J)if(!Object.prototype.hasOwnProperty.call(Z,Y))Z[Y]=J[Y]}return Q.someProp("nodeViews",X),Q.someProp("markViews",X),Z},DX=function(Q,Z){let X=0,J=0;for(let Y in Q){if(Q[Y]!=Z[Y])return!0;X++}for(let Y in Z)J++;return X!=J},jQ=function(Q){if(Q.spec.state||Q.spec.filterTransaction||Q.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")},o=function(Q){for(var Z=0;;Z++)if(Q=Q.previousSibling,!Q)return Z},C1=function(Q){let Z=Q.assignedSlot||Q.parentNode;return Z&&Z.nodeType==11?Z.host:Z},O6=null,S0=function(Q,Z,X){let J=O6||(O6=document.createRange());return J.setEnd(Q,X==null?Q.nodeValue.length:X),J.setStart(Q,Z||0),J},QZ=function(){O6=null},q1=function(Q,Z,X,J){return X&&(m9(Q,Z,X,J,-1)||m9(Q,Z,X,J,1))},ZZ=/^(img|br|input|textarea|hr)$/i,D5=function(Q){return Q.focusNode&&q1(Q.focusNode,Q.focusOffset,Q.anchorNode,Q.anchorOffset)},A0=typeof navigator!="undefined"?navigator:null,l9=typeof document!="undefined"?document:null,d0=A0&&A0.userAgent||"",R6=/Edge\/(\d+)/.exec(d0),EQ=/MSIE \d/.exec(d0),N6=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(d0),U0=!!(EQ||N6||R6),l0=EQ?document.documentMode:N6?+N6[1]:R6?+R6[1]:0,I0=!U0&&/gecko\/(\d+)/i.test(d0);I0&&+(/Firefox\/(\d+)/.exec(d0)||[0,0])[1];var D6=!U0&&/Chrome\/(\d+)/.exec(d0),Z0=!!D6,AQ=D6?+D6[1]:0,J0=!U0&&!!A0&&/Apple Computer/.test(A0.vendor),T1=J0&&(/Mobile\/\w+/.test(d0)||!!A0&&A0.maxTouchPoints>2),W0=T1||(A0?/Mac/.test(A0.platform):!1),GZ=A0?/Win/.test(A0.platform):!1,y0=/Android \d/.test(d0),e1=!!l9&&"webkitFontSmoothing"in l9.documentElement.style,zZ=e1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,R1=null,jZ=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,AZ=/[\u0590-\u08ac]/,d9=null,i9=null,s9=!1,B0=0,a9=1,Z1=2,O0=3;class k1{constructor(Q,Z,X,J){this.parent=Q,this.children=Z,this.dom=X,this.contentDOM=J,this.dirty=B0,X.pmViewDesc=this}matchesWidget(Q){return!1}matchesMark(Q){return!1}matchesNode(Q,Z,X){return!1}matchesHack(Q){return!1}parseRule(){return null}stopEvent(Q){return!1}get size(){let Q=0;for(let Z=0;Z<this.children.length;Z++)Q+=this.children[Z].size;return Q}get border(){return 0}destroy(){if(this.parent=void 0,this.dom.pmViewDesc==this)this.dom.pmViewDesc=void 0;for(let Q=0;Q<this.children.length;Q++)this.children[Q].destroy()}posBeforeChild(Q){for(let Z=0,X=this.posAtStart;;Z++){let J=this.children[Z];if(J==Q)return X;X+=J.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(Q,Z,X){if(this.contentDOM&&this.contentDOM.contains(Q.nodeType==1?Q:Q.parentNode))if(X<0){let Y,q;if(Q==this.contentDOM)Y=Q.childNodes[Z-1];else{while(Q.parentNode!=this.contentDOM)Q=Q.parentNode;Y=Q.previousSibling}while(Y&&!((q=Y.pmViewDesc)&&q.parent==this))Y=Y.previousSibling;return Y?this.posBeforeChild(q)+q.size:this.posAtStart}else{let Y,q;if(Q==this.contentDOM)Y=Q.childNodes[Z];else{while(Q.parentNode!=this.contentDOM)Q=Q.parentNode;Y=Q.nextSibling}while(Y&&!((q=Y.pmViewDesc)&&q.parent==this))Y=Y.nextSibling;return Y?this.posBeforeChild(q):this.posAtEnd}let J;if(Q==this.dom&&this.contentDOM)J=Z>o(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))J=Q.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(Z==0)for(let Y=Q;;Y=Y.parentNode){if(Y==this.dom){J=!1;break}if(Y.previousSibling)break}if(J==null&&Z==Q.childNodes.length)for(let Y=Q;;Y=Y.parentNode){if(Y==this.dom){J=!0;break}if(Y.nextSibling)break}}return(J==null?X>0:J)?this.posAtEnd:this.posAtStart}nearestDesc(Q,Z=!1){for(let X=!0,J=Q;J;J=J.parentNode){let Y=this.getDesc(J),q;if(Y&&(!Z||Y.node))if(X&&(q=Y.nodeDOM)&&!(q.nodeType==1?q.contains(Q.nodeType==1?Q:Q.parentNode):q==Q))X=!1;else return Y}}getDesc(Q){let Z=Q.pmViewDesc;for(let X=Z;X;X=X.parent)if(X==this)return Z}posFromDOM(Q,Z,X){for(let J=Q;J;J=J.parentNode){let Y=this.getDesc(J);if(Y)return Y.localPosFromDOM(Q,Z,X)}return-1}descAt(Q){for(let Z=0,X=0;Z<this.children.length;Z++){let J=this.children[Z],Y=X+J.size;if(X==Q&&Y!=X){while(!J.border&&J.children.length)for(let q=0;q<J.children.length;q++){let U=J.children[q];if(U.size){J=U;break}}return J}if(Q<Y)return J.descAt(Q-X-J.border);X=Y}}domFromPos(Q,Z){if(!this.contentDOM)return{node:this.dom,offset:0,atom:Q+1};let X=0,J=0;for(let Y=0;X<this.children.length;X++){let q=this.children[X],U=Y+q.size;if(U>Q||q instanceof x6){J=Q-Y;break}Y=U}if(J)return this.children[X].domFromPos(J-this.children[X].border,Z);for(let Y;X&&!(Y=this.children[X-1]).size&&Y instanceof $6&&Y.side>=0;X--);if(Z<=0){let Y,q=!0;for(;;X--,q=!1)if(Y=X?this.children[X-1]:null,!Y||Y.dom.parentNode==this.contentDOM)break;if(Y&&Z&&q&&!Y.border&&!Y.domAtom)return Y.domFromPos(Y.size,Z);return{node:this.contentDOM,offset:Y?o(Y.dom)+1:0}}else{let Y,q=!0;for(;;X++,q=!1)if(Y=X<this.children.length?this.children[X]:null,!Y||Y.dom.parentNode==this.contentDOM)break;if(Y&&q&&!Y.border&&!Y.domAtom)return Y.domFromPos(0,Z);return{node:this.contentDOM,offset:Y?o(Y.dom):this.contentDOM.childNodes.length}}}parseRange(Q,Z,X=0){if(this.children.length==0)return{node:this.contentDOM,from:Q,to:Z,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let J=-1,Y=-1;for(let q=X,U=0;;U++){let G=this.children[U],z=q+G.size;if(J==-1&&Q<=z){let V=q+G.border;if(Q>=V&&Z<=z-G.border&&G.node&&G.contentDOM&&this.contentDOM.contains(G.contentDOM))return G.parseRange(Q,Z,V);Q=q;for(let K=U;K>0;K--){let H=this.children[K-1];if(H.size&&H.dom.parentNode==this.contentDOM&&!H.emptyChildAt(1)){J=o(H.dom)+1;break}Q-=H.size}if(J==-1)J=0}if(J>-1&&(z>Z||U==this.children.length-1)){Z=z;for(let V=U+1;V<this.children.length;V++){let K=this.children[V];if(K.size&&K.dom.parentNode==this.contentDOM&&!K.emptyChildAt(-1)){Y=o(K.dom);break}Z+=K.size}if(Y==-1)Y=this.contentDOM.childNodes.length;break}q=z}return{node:this.contentDOM,from:Q,to:Z,fromOffset:J,toOffset:Y}}emptyChildAt(Q){if(this.border||!this.contentDOM||!this.children.length)return!1;let Z=this.children[Q<0?0:this.children.length-1];return Z.size==0||Z.emptyChildAt(Q)}domAfterPos(Q){let{node:Z,offset:X}=this.domFromPos(Q,0);if(Z.nodeType!=1||X==Z.childNodes.length)throw new RangeError("No node after pos "+Q);return Z.childNodes[X]}setSelection(Q,Z,X,J=!1){let Y=Math.min(Q,Z),q=Math.max(Q,Z);for(let W=0,B=0;W<this.children.length;W++){let L=this.children[W],_=B+L.size;if(Y>B&&q<_)return L.setSelection(Q-B-L.border,Z-B-L.border,X,J);B=_}let U=this.domFromPos(Q,Q?-1:1),G=Z==Q?U:this.domFromPos(Z,Z?-1:1),z=X.root.getSelection(),V=X.domSelectionRange(),K=!1;if((I0||J0)&&Q==Z){let{node:W,offset:B}=U;if(W.nodeType==3){if(K=!!(B&&W.nodeValue[B-1]=="\n"),K&&B==W.nodeValue.length)for(let L=W,_;L;L=L.parentNode){if(_=L.nextSibling){if(_.nodeName=="BR")U=G={node:_.parentNode,offset:o(_)+1};break}let I=L.pmViewDesc;if(I&&I.node&&I.node.isBlock)break}}else{let L=W.childNodes[B-1];K=L&&(L.nodeName=="BR"||L.contentEditable=="false")}}if(I0&&V.focusNode&&V.focusNode!=G.node&&V.focusNode.nodeType==1){let W=V.focusNode.childNodes[V.focusOffset];if(W&&W.contentEditable=="false")J=!0}if(!(J||K&&J0)&&q1(U.node,U.offset,V.anchorNode,V.anchorOffset)&&q1(G.node,G.offset,V.focusNode,V.focusOffset))return;let H=!1;if((z.extend||Q==Z)&&!K){z.collapse(U.node,U.offset);try{if(Q!=Z)z.extend(G.node,G.offset);H=!0}catch(W){}}if(!H){if(Q>Z){let B=U;U=G,G=B}let W=document.createRange();W.setEnd(G.node,G.offset),W.setStart(U.node,U.offset),z.removeAllRanges(),z.addRange(W)}}ignoreMutation(Q){return!this.contentDOM&&Q.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(Q,Z){for(let X=0,J=0;J<this.children.length;J++){let Y=this.children[J],q=X+Y.size;if(X==q?Q<=q&&Z>=X:Q<q&&Z>X){let U=X+Y.border,G=q-Y.border;if(Q>=U&&Z<=G){if(this.dirty=Q==X||Z==q?Z1:a9,Q==U&&Z==G&&(Y.contentLost||Y.dom.parentNode!=this.contentDOM))Y.dirty=O0;else Y.markDirty(Q-U,Z-U);return}else Y.dirty=Y.dom==Y.contentDOM&&Y.dom.parentNode==this.contentDOM&&!Y.children.length?Z1:O0}X=q}this.dirty=Z1}markParentsDirty(){let Q=1;for(let Z=this.parent;Z;Z=Z.parent,Q++){let X=Q==1?Z1:a9;if(Z.dirty<X)Z.dirty=X}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(Q){return!1}}class $6 extends k1{constructor(Q,Z,X,J){let Y,q=Z.type.toDOM;if(typeof q=="function")q=q(X,()=>{if(!Y)return J;if(Y.parent)return Y.parent.posBeforeChild(Y)});if(!Z.type.spec.raw){if(q.nodeType!=1){let U=document.createElement("span");U.appendChild(q),q=U}q.contentEditable="false",q.classList.add("ProseMirror-widget")}super(Q,[],q,null);this.widget=Z,this.widget=Z,Y=this}matchesWidget(Q){return this.dirty==B0&&Q.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(Q){let Z=this.widget.spec.stopEvent;return Z?Z(Q):!1}ignoreMutation(Q){return Q.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class TQ extends k1{constructor(Q,Z,X,J){super(Q,[],Z,null);this.textDOM=X,this.text=J}get size(){return this.text.length}localPosFromDOM(Q,Z){if(Q!=this.textDOM)return this.posAtStart+(Z?this.size:0);return this.posAtStart+Z}domFromPos(Q){return{node:this.textDOM,offset:Q}}ignoreMutation(Q){return Q.type==="characterData"&&Q.target.nodeValue==Q.oldValue}}class U1 extends k1{constructor(Q,Z,X,J,Y){super(Q,[],X,J);this.mark=Z,this.spec=Y}static create(Q,Z,X,J){let Y=J.nodeViews[Z.type.name],q=Y&&Y(Z,J,X);if(!q||!q.dom)q=C0.renderSpec(document,Z.type.spec.toDOM(Z,X),null,Z.attrs);return new U1(Q,Z,q.dom,q.contentDOM||q.dom,q)}parseRule(){if(this.dirty&O0||this.mark.type.spec.reparseInView)return null;return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(Q){return this.dirty!=O0&&this.mark.eq(Q)}markDirty(Q,Z){if(super.markDirty(Q,Z),this.dirty!=B0){let X=this.parent;while(!X.node)X=X.parent;if(X.dirty<this.dirty)X.dirty=this.dirty;this.dirty=B0}}slice(Q,Z,X){let J=U1.create(this.parent,this.mark,!0,X),Y=this.children,q=this.size;if(Z<q)Y=C6(Y,Z,q,X);if(Q>0)Y=C6(Y,0,Q,X);for(let U=0;U<Y.length;U++)Y[U].parent=J;return J.children=Y,J}ignoreMutation(Q){return this.spec.ignoreMutation?this.spec.ignoreMutation(Q):super.ignoreMutation(Q)}destroy(){if(this.spec.destroy)this.spec.destroy();super.destroy()}}class c0 extends k1{constructor(Q,Z,X,J,Y,q,U,G,z){super(Q,[],Y,q);this.node=Z,this.outerDeco=X,this.innerDeco=J,this.nodeDOM=U}static create(Q,Z,X,J,Y,q){let U=Y.nodeViews[Z.type.name],G,z=U&&U(Z,Y,()=>{if(!G)return q;if(G.parent)return G.parent.posBeforeChild(G)},X,J),V=z&&z.dom,K=z&&z.contentDOM;if(Z.isText){if(!V)V=document.createTextNode(Z.text);else if(V.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else if(!V)({dom:V,contentDOM:K}=C0.renderSpec(document,Z.type.spec.toDOM(Z),null,Z.attrs));if(!K&&!Z.isText&&V.nodeName!="BR"){if(!V.hasAttribute("contenteditable"))V.contentEditable="false";if(Z.type.spec.draggable)V.draggable=!0}let H=V;if(V=bQ(V,X,Z),z)return G=new kQ(Q,Z,X,J,V,K||null,H,z,Y,q+1);else if(Z.isText)return new M5(Q,Z,X,J,V,H,Y);else return new c0(Q,Z,X,J,V,K||null,H,Y,q+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let Q={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre")Q.preserveWhitespace="full";if(!this.contentDOM)Q.getContent=()=>this.node.content;else if(!this.contentLost)Q.contentElement=this.contentDOM;else{for(let Z=this.children.length-1;Z>=0;Z--){let X=this.children[Z];if(this.dom.contains(X.dom.parentNode)){Q.contentElement=X.dom.parentNode;break}}if(!Q.contentElement)Q.getContent=()=>P.empty}return Q}matchesNode(Q,Z,X){return this.dirty==B0&&Q.eq(this.node)&&E5(Z,this.outerDeco)&&X.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(Q,Z){let X=this.node.inlineContent,J=Z,Y=Q.composing?this.localCompositionInfo(Q,Z):null,q=Y&&Y.pos>-1?Y:null,U=Y&&Y.pos<0,G=new $Q(this,q&&q.node,Q);if(CZ(this.node,this.innerDeco,(z,V,K)=>{if(z.spec.marks)G.syncToMarks(z.spec.marks,X,Q);else if(z.type.side>=0&&!K)G.syncToMarks(V==this.node.childCount?b.none:this.node.child(V).marks,X,Q);G.placeWidget(z,Q,J)},(z,V,K,H)=>{G.syncToMarks(z.marks,X,Q);let W;if(G.findNodeMatch(z,V,K,H));else if(U&&Q.state.selection.from>J&&Q.state.selection.to<J+z.nodeSize&&(W=G.findIndexWithChild(Y.node))>-1&&G.updateNodeAt(z,V,K,W,Q));else if(G.updateNextNode(z,V,K,Q,H,J));else G.addNode(z,V,K,Q,J);J+=z.nodeSize}),G.syncToMarks([],X,Q),this.node.isTextblock)G.addTextblockHacks();if(G.destroyRest(),G.changed||this.dirty==Z1){if(q)this.protectLocalComposition(Q,q);if(SQ(this.contentDOM,this.children,Q),T1)TZ(this.dom)}}localCompositionInfo(Q,Z){let{from:X,to:J}=Q.state.selection;if(!(Q.state.selection instanceof O)||X<Z||J>Z+this.node.content.size)return null;let Y=Q.input.compositionNode;if(!Y||!this.dom.contains(Y.parentNode))return null;if(this.node.inlineContent){let q=Y.nodeValue,U=kZ(this.node.content,q,X-Z,J-Z);return U<0?null:{node:Y,pos:U,text:q}}else return{node:Y,pos:-1,text:""}}protectLocalComposition(Q,{node:Z,pos:X,text:J}){if(this.getDesc(Z))return;let Y=Z;for(;;Y=Y.parentNode){if(Y.parentNode==this.contentDOM)break;while(Y.previousSibling)Y.parentNode.removeChild(Y.previousSibling);while(Y.nextSibling)Y.parentNode.removeChild(Y.nextSibling);if(Y.pmViewDesc)Y.pmViewDesc=void 0}let q=new TQ(this,Y,Z,J);Q.input.compositionNodes.push(q),this.children=C6(this.children,X,X+J.length,Q,q)}update(Q,Z,X,J){if(this.dirty==O0||!Q.sameMarkup(this.node))return!1;return this.updateInner(Q,Z,X,J),!0}updateInner(Q,Z,X,J){if(this.updateOuterDeco(Z),this.node=Q,this.innerDeco=X,this.contentDOM)this.updateChildren(J,this.posAtStart);this.dirty=B0}updateOuterDeco(Q){if(E5(Q,this.outerDeco))return;let Z=this.nodeDOM.nodeType!=1,X=this.dom;if(this.dom=yQ(this.dom,this.nodeDOM,M6(this.outerDeco,this.node,Z),M6(Q,this.node,Z)),this.dom!=X)X.pmViewDesc=void 0,this.dom.pmViewDesc=this;this.outerDeco=Q}selectNode(){if(this.nodeDOM.nodeType==1)this.nodeDOM.classList.add("ProseMirror-selectednode");if(this.contentDOM||!this.node.type.spec.draggable)this.dom.draggable=!0}deselectNode(){if(this.nodeDOM.nodeType==1){if(this.nodeDOM.classList.remove("ProseMirror-selectednode"),this.contentDOM||!this.node.type.spec.draggable)this.dom.removeAttribute("draggable")}}get domAtom(){return this.node.isAtom}}class M5 extends c0{constructor(Q,Z,X,J,Y,q,U){super(Q,Z,X,J,Y,null,q,U,0)}parseRule(){let Q=this.nodeDOM.parentNode;while(Q&&Q!=this.dom&&!Q.pmIsDeco)Q=Q.parentNode;return{skip:Q||!0}}update(Q,Z,X,J){if(this.dirty==O0||this.dirty!=B0&&!this.inParent()||!Q.sameMarkup(this.node))return!1;if(this.updateOuterDeco(Z),(this.dirty!=B0||Q.text!=this.node.text)&&Q.text!=this.nodeDOM.nodeValue){if(this.nodeDOM.nodeValue=Q.text,J.trackWrites==this.nodeDOM)J.trackWrites=null}return this.node=Q,this.dirty=B0,!0}inParent(){let Q=this.parent.contentDOM;for(let Z=this.nodeDOM;Z;Z=Z.parentNode)if(Z==Q)return!0;return!1}domFromPos(Q){return{node:this.nodeDOM,offset:Q}}localPosFromDOM(Q,Z,X){if(Q==this.nodeDOM)return this.posAtStart+Math.min(Z,this.node.text.length);return super.localPosFromDOM(Q,Z,X)}ignoreMutation(Q){return Q.type!="characterData"&&Q.type!="selection"}slice(Q,Z,X){let J=this.node.cut(Q,Z),Y=document.createTextNode(J.text);return new M5(this.parent,J,this.outerDeco,this.innerDeco,Y,Y,X)}markDirty(Q,Z){if(super.markDirty(Q,Z),this.dom!=this.nodeDOM&&(Q==0||Z==this.nodeDOM.nodeValue.length))this.dirty=O0}get domAtom(){return!1}isText(Q){return this.node.text==Q}}class x6 extends k1{parseRule(){return{ignore:!0}}matchesHack(Q){return this.dirty==B0&&this.dom.nodeName==Q}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class kQ extends c0{constructor(Q,Z,X,J,Y,q,U,G,z,V){super(Q,Z,X,J,Y,q,U,z,V);this.spec=G}update(Q,Z,X,J){if(this.dirty==O0)return!1;if(this.spec.update&&(this.node.type==Q.type||this.spec.multiType)){let Y=this.spec.update(Q,Z,X);if(Y)this.updateInner(Q,Z,X,J);return Y}else if(!this.contentDOM&&!Q.isLeaf)return!1;else return super.update(Q,Z,X,J)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(Q,Z,X,J){this.spec.setSelection?this.spec.setSelection(Q,Z,X.root):super.setSelection(Q,Z,X,J)}destroy(){if(this.spec.destroy)this.spec.destroy();super.destroy()}stopEvent(Q){return this.spec.stopEvent?this.spec.stopEvent(Q):!1}ignoreMutation(Q){return this.spec.ignoreMutation?this.spec.ignoreMutation(Q):super.ignoreMutation(Q)}}var s1=function(Q){if(Q)this.nodeName=Q};s1.prototype=Object.create(null);var X1=[new s1];class $Q{constructor(Q,Z,X){this.lock=Z,this.view=X,this.index=0,this.stack=[],this.changed=!1,this.top=Q,this.preMatch=DZ(Q.node.content,Q)}destroyBetween(Q,Z){if(Q==Z)return;for(let X=Q;X<Z;X++)this.top.children[X].destroy();this.top.children.splice(Q,Z-Q),this.changed=!0}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(Q,Z,X){let J=0,Y=this.stack.length>>1,q=Math.min(Y,Q.length);while(J<q&&(J==Y-1?this.top:this.stack[J+1<<1]).matchesMark(Q[J])&&Q[J].type.spec.spanning!==!1)J++;while(J<Y)this.destroyRest(),this.top.dirty=B0,this.index=this.stack.pop(),this.top=this.stack.pop(),Y--;while(Y<Q.length){this.stack.push(this.top,this.index+1);let U=-1;for(let G=this.index;G<Math.min(this.index+3,this.top.children.length);G++){let z=this.top.children[G];if(z.matchesMark(Q[Y])&&!this.isLocked(z.dom)){U=G;break}}if(U>-1){if(U>this.index)this.changed=!0,this.destroyBetween(this.index,U);this.top=this.top.children[this.index]}else{let G=U1.create(this.top,Q[Y],Z,X);this.top.children.splice(this.index,0,G),this.top=G,this.changed=!0}this.index=0,Y++}}findNodeMatch(Q,Z,X,J){let Y=-1,q;if(J>=this.preMatch.index&&(q=this.preMatch.matches[J-this.preMatch.index]).parent==this.top&&q.matchesNode(Q,Z,X))Y=this.top.children.indexOf(q,this.index);else for(let U=this.index,G=Math.min(this.top.children.length,U+5);U<G;U++){let z=this.top.children[U];if(z.matchesNode(Q,Z,X)&&!this.preMatch.matched.has(z)){Y=U;break}}if(Y<0)return!1;return this.destroyBetween(this.index,Y),this.index++,!0}updateNodeAt(Q,Z,X,J,Y){let q=this.top.children[J];if(q.dirty==O0&&q.dom==q.contentDOM)q.dirty=Z1;if(!q.update(Q,Z,X,Y))return!1;return this.destroyBetween(this.index,J),this.index++,!0}findIndexWithChild(Q){for(;;){let Z=Q.parentNode;if(!Z)return-1;if(Z==this.top.contentDOM){let X=Q.pmViewDesc;if(X){for(let J=this.index;J<this.top.children.length;J++)if(this.top.children[J]==X)return J}return-1}Q=Z}}updateNextNode(Q,Z,X,J,Y,q){for(let U=this.index;U<this.top.children.length;U++){let G=this.top.children[U];if(G instanceof c0){let z=this.preMatch.matched.get(G);if(z!=null&&z!=Y)return!1;let V=G.dom,K,H=this.isLocked(V)&&!(Q.isText&&G.node&&G.node.isText&&G.nodeDOM.nodeValue==Q.text&&G.dirty!=O0&&E5(Z,G.outerDeco));if(!H&&G.update(Q,Z,X,J)){if(this.destroyBetween(this.index,U),G.dom!=V)this.changed=!0;return this.index++,!0}else if(!H&&(K=this.recreateWrapper(G,Q,Z,X,J,q))){if(this.destroyBetween(this.index,U),this.top.children[this.index]=K,K.contentDOM)K.dirty=Z1,K.updateChildren(J,q+1),K.dirty=B0;return this.changed=!0,this.index++,!0}break}}return!1}recreateWrapper(Q,Z,X,J,Y,q){if(Q.dirty||Z.isAtom||!Q.children.length||!Q.node.content.eq(Z.content)||!E5(X,Q.outerDeco)||!J.eq(Q.innerDeco))return null;let U=c0.create(this.top,Z,X,J,Y,q);if(U.contentDOM){U.children=Q.children,Q.children=[];for(let G of U.children)G.parent=U}return Q.destroy(),U}addNode(Q,Z,X,J,Y){let q=c0.create(this.top,Q,Z,X,J,Y);if(q.contentDOM)q.updateChildren(J,Y+1);this.top.children.splice(this.index++,0,q),this.changed=!0}placeWidget(Q,Z,X){let J=this.index<this.top.children.length?this.top.children[this.index]:null;if(J&&J.matchesWidget(Q)&&(Q==J.widget||!J.widget.type.toDOM.parentNode))this.index++;else{let Y=new $6(this.top,Q,Z,X);this.top.children.splice(this.index++,0,Y),this.changed=!0}}addTextblockHacks(){let Q=this.top.children[this.index-1],Z=this.top;while(Q instanceof U1)Z=Q,Q=Z.children[Z.children.length-1];if(!Q||!(Q instanceof M5)||/\n$/.test(Q.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(Q.node.text)){if((J0||Z0)&&Q&&Q.dom.contentEditable=="false")this.addHackNode("IMG",Z);this.addHackNode("BR",this.top)}}addHackNode(Q,Z){if(Z==this.top&&this.index<Z.children.length&&Z.children[this.index].matchesHack(Q))this.index++;else{let X=document.createElement(Q);if(Q=="IMG")X.className="ProseMirror-separator",X.alt="";if(Q=="BR")X.className="ProseMirror-trailingBreak";let J=new x6(this.top,[],X,null);if(Z!=this.top)Z.children.push(J);else Z.children.splice(this.index++,0,J);this.changed=!0}}isLocked(Q){return this.lock&&(Q==this.lock||Q.nodeType==1&&Q.contains(this.lock.parentNode))}}var o9=J0||Z0&&AQ<63,hZ=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i,lQ={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},zQ=null,j6=null,Y0={},q0={},iZ={touchstart:!0,touchmove:!0};class pQ{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-200000000,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}q0.keydown=(Q,Z)=>{let X=Z;if(Q.input.shiftKey=X.keyCode==16||X.shiftKey,sQ(Q,X))return;if(Q.input.lastKeyCode=X.keyCode,Q.input.lastKeyCodeTime=Date.now(),y0&&Z0&&X.keyCode==13)return;if(X.keyCode!=229)Q.domObserver.forceFlush();if(T1&&X.keyCode==13&&!X.ctrlKey&&!X.altKey&&!X.metaKey){let J=Date.now();Q.input.lastIOSEnter=J,Q.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{if(Q.input.lastIOSEnter==J)Q.someProp("handleKeyDown",(Y)=>Y(Q,Q1(13,"Enter"))),Q.input.lastIOSEnter=0},200)}else if(Q.someProp("handleKeyDown",(J)=>J(Q,X))||fZ(Q,X))X.preventDefault();else m0(Q,"key")};q0.keyup=(Q,Z)=>{if(Z.keyCode==16)Q.input.shiftKey=!1};q0.keypress=(Q,Z)=>{let X=Z;if(sQ(Q,X)||!X.charCode||X.ctrlKey&&!X.altKey||W0&&X.metaKey)return;if(Q.someProp("handleKeyPress",(Y)=>Y(Q,X))){X.preventDefault();return}let J=Q.state.selection;if(!(J instanceof O)||!J.$from.sameParent(J.$to)){let Y=String.fromCharCode(X.charCode);if(!/[\r\n]/.test(Y)&&!Q.someProp("handleTextInput",(q)=>q(Q,J.$from.pos,J.$to.pos,Y)))Q.dispatch(Q.state.tr.insertText(Y).scrollIntoView());X.preventDefault()}};var dQ=W0?"metaKey":"ctrlKey";Y0.mousedown=(Q,Z)=>{let X=Z;Q.input.shiftKey=X.shiftKey;let J=h6(Q),Y=Date.now(),q="singleClick";if(Y-Q.input.lastClick.time<500&&oZ(X,Q.input.lastClick)&&!X[dQ]){if(Q.input.lastClick.type=="singleClick")q="doubleClick";else if(Q.input.lastClick.type=="doubleClick")q="tripleClick"}Q.input.lastClick={time:Y,x:X.clientX,y:X.clientY,type:q};let U=Q.posAtCoords(C5(X));if(!U)return;if(q=="singleClick"){if(Q.input.mouseDown)Q.input.mouseDown.done();Q.input.mouseDown=new iQ(Q,U,X,!!J)}else if((q=="doubleClick"?ZX:XX)(Q,U.pos,U.inside,X))X.preventDefault();else m0(Q,"pointer")};class iQ{constructor(Q,Z,X,J){this.view=Q,this.pos=Z,this.event=X,this.flushed=J,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=Q.state.doc,this.selectNode=!!X[dQ],this.allowDefault=X.shiftKey;let Y,q;if(Z.inside>-1)Y=Q.state.doc.nodeAt(Z.inside),q=Z.inside;else{let V=Q.state.doc.resolve(Z.pos);Y=V.parent,q=V.depth?V.before():0}const U=J?null:X.target,G=U?Q.docView.nearestDesc(U,!0):null;this.target=G&&G.dom.nodeType==1?G.dom:null;let{selection:z}=Q.state;if(X.button==0&&Y.type.spec.draggable&&Y.type.spec.selectable!==!1||z instanceof R&&z.from<=q&&z.to>q)this.mightDrag={node:Y,pos:q,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&I0&&!this.target.hasAttribute("contentEditable"))};if(this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)){if(this.view.domObserver.stop(),this.mightDrag.addAttr)this.target.draggable=!0;if(this.mightDrag.setUneditable)setTimeout(()=>{if(this.view.input.mouseDown==this)this.target.setAttribute("contentEditable","false")},20);this.view.domObserver.start()}Q.root.addEventListener("mouseup",this.up=this.up.bind(this)),Q.root.addEventListener("mousemove",this.move=this.move.bind(this)),m0(Q,"pointer")}done(){if(this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target){if(this.view.domObserver.stop(),this.mightDrag.addAttr)this.target.removeAttribute("draggable");if(this.mightDrag.setUneditable)this.target.removeAttribute("contentEditable");this.view.domObserver.start()}if(this.delayedSelectionSync)setTimeout(()=>b0(this.view));this.view.input.mouseDown=null}up(Q){if(this.done(),!this.view.dom.contains(Q.target))return;let Z=this.pos;if(this.view.state.doc!=this.startDoc)Z=this.view.posAtCoords(C5(Q));if(this.updateAllowDefault(Q),this.allowDefault||!Z)m0(this.view,"pointer");else if(QX(this.view,Z.pos,Z.inside,Q,this.selectNode))Q.preventDefault();else if(Q.button==0&&(this.flushed||J0&&this.mightDrag&&!this.mightDrag.node.isAtom||Z0&&!this.view.state.selection.visible&&Math.min(Math.abs(Z.pos-this.view.state.selection.from),Math.abs(Z.pos-this.view.state.selection.to))<=2))M1(this.view,N.near(this.view.state.doc.resolve(Z.pos)),"pointer"),Q.preventDefault();else m0(this.view,"pointer")}move(Q){if(this.updateAllowDefault(Q),m0(this.view,"pointer"),Q.buttons==0)this.done()}updateAllowDefault(Q){if(!this.allowDefault&&(Math.abs(this.event.x-Q.clientX)>4||Math.abs(this.event.y-Q.clientY)>4))this.allowDefault=!0}}Y0.touchstart=(Q)=>{Q.input.lastTouch=Date.now(),h6(Q),m0(Q,"pointer")};Y0.touchmove=(Q)=>{Q.input.lastTouch=Date.now(),m0(Q,"pointer")};Y0.contextmenu=(Q)=>h6(Q);var YX=y0?5000:-1;q0.compositionstart=q0.compositionupdate=(Q)=>{if(!Q.composing){Q.domObserver.flush();let{state:Z}=Q,X=Z.selection.$to;if(Z.selection instanceof O&&(Z.storedMarks||!X.textOffset&&X.parentOffset&&X.nodeBefore.marks.some((J)=>J.type.spec.inclusive===!1)))Q.markCursor=Q.state.storedMarks||X.marks(),O5(Q,!0),Q.markCursor=null;else if(O5(Q,!Z.selection.empty),I0&&Z.selection.empty&&X.parentOffset&&!X.textOffset&&X.nodeBefore.marks.length){let J=Q.domSelectionRange();for(let{focusNode:Y,focusOffset:q}=J;Y&&Y.nodeType==1&&q!=0;){let U=q<0?Y.lastChild:Y.childNodes[q-1];if(!U)break;if(U.nodeType==3){let G=Q.domSelection();if(G)G.collapse(U,U.nodeValue.length);break}else Y=U,q=-1}}Q.input.composing=!0}aQ(Q,YX)};q0.compositionend=(Q,Z)=>{if(Q.composing){if(Q.input.composing=!1,Q.input.compositionEndedAt=Z.timeStamp,Q.input.compositionPendingChanges=Q.domObserver.pendingRecords().length?Q.input.compositionID:0,Q.input.compositionNode=null,Q.input.compositionPendingChanges)Promise.resolve().then(()=>Q.domObserver.flush());Q.input.compositionID++,aQ(Q,20)}};var n1=U0&&l0<15||T1&&zZ<604;Y0.copy=q0.cut=(Q,Z)=>{let X=Z,J=Q.state.selection,Y=X.type=="cut";if(J.empty)return;let q=n1?null:X.clipboardData,U=J.content(),{dom:G,text:z}=u6(Q,U);if(q)X.preventDefault(),q.clearData(),q.setData("text/html",G.innerHTML),q.setData("text/plain",z);else GX(Q,G);if(Y)Q.dispatch(Q.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};q0.paste=(Q,Z)=>{let X=Z;if(Q.composing&&!y0)return;let J=n1?null:X.clipboardData,Y=Q.input.shiftKey&&Q.input.lastKeyCode!=45;if(J&&r1(Q,rQ(J),J.getData("text/html"),Y,X))X.preventDefault();else VX(Q,X)};class m6{constructor(Q,Z,X){this.slice=Q,this.move=Z,this.node=X}}var oQ=W0?"altKey":"ctrlKey";Y0.dragstart=(Q,Z)=>{let X=Z,J=Q.input.mouseDown;if(J)J.done();if(!X.dataTransfer)return;let Y=Q.state.selection,q=Y.empty?null:Q.posAtCoords(C5(X)),U;if(q&&q.pos>=Y.from&&q.pos<=(Y instanceof R?Y.to-1:Y.to));else if(J&&J.mightDrag)U=R.create(Q.state.doc,J.mightDrag.pos);else if(X.target&&X.target.nodeType==1){let H=Q.docView.nearestDesc(X.target,!0);if(H&&H.node.type.spec.draggable&&H!=Q.docView)U=R.create(Q.state.doc,H.posBefore)}let G=(U||Q.state.selection).content(),{dom:z,text:V,slice:K}=u6(Q,G);if(!X.dataTransfer.files.length||!Z0||AQ>120)X.dataTransfer.clearData();if(X.dataTransfer.setData(n1?"Text":"text/html",z.innerHTML),X.dataTransfer.effectAllowed="copyMove",!n1)X.dataTransfer.setData("text/plain",V);Q.dragging=new m6(K,!X[oQ],U)};Y0.dragend=(Q)=>{let Z=Q.dragging;window.setTimeout(()=>{if(Q.dragging==Z)Q.dragging=null},50)};q0.dragover=q0.dragenter=(Q,Z)=>Z.preventDefault();q0.drop=(Q,Z)=>{let X=Z,J=Q.dragging;if(Q.dragging=null,!X.dataTransfer)return;let Y=Q.posAtCoords(C5(X));if(!Y)return;let q=Q.state.doc.resolve(Y.pos),U=J&&J.slice;if(U)Q.someProp("transformPasted",(L)=>{U=L(U,Q)});else U=vQ(Q,rQ(X.dataTransfer),n1?null:X.dataTransfer.getData("text/html"),!1,q);let G=!!(J&&!X[oQ]);if(Q.someProp("handleDrop",(L)=>L(Q,X,U||j.empty,G))){X.preventDefault();return}if(!U)return;X.preventDefault();let z=U?I5(Q.state.doc,q.pos,U):q.pos;if(z==null)z=q.pos;let V=Q.state.tr;if(G){let{node:L}=J;if(L)L.replace(V);else V.deleteSelection()}let K=V.mapping.map(z),H=U.openStart==0&&U.openEnd==0&&U.content.childCount==1,W=V.doc;if(H)V.replaceRangeWith(K,K,U.content.firstChild);else V.replaceRange(K,K,U);if(V.doc.eq(W))return;let B=V.doc.resolve(K);if(H&&R.isSelectable(U.content.firstChild)&&B.nodeAfter&&B.nodeAfter.sameMarkup(U.content.firstChild))V.setSelection(new R(B));else{let L=V.mapping.map(z);V.mapping.maps[V.mapping.maps.length-1].forEach((_,I,F,E)=>L=E),V.setSelection(w6(Q,B,V.doc.resolve(L)))}Q.focus(),Q.dispatch(V.setMeta("uiEvent","drop"))};Y0.focus=(Q)=>{if(Q.input.lastFocus=Date.now(),!Q.focused)Q.domObserver.stop(),Q.dom.classList.add("ProseMirror-focused"),Q.domObserver.start(),Q.focused=!0,setTimeout(()=>{if(Q.docView&&Q.hasFocus()&&!Q.domObserver.currentSelection.eq(Q.domSelectionRange()))b0(Q)},20)};Y0.blur=(Q,Z)=>{let X=Z;if(Q.focused){if(Q.domObserver.stop(),Q.dom.classList.remove("ProseMirror-focused"),Q.domObserver.start(),X.relatedTarget&&Q.dom.contains(X.relatedTarget))Q.domObserver.currentSelection.clear();Q.focused=!1}};Y0.beforeinput=(Q,Z)=>{if(Z0&&y0&&Z.inputType=="deleteContentBackward"){Q.domObserver.flushSoon();let{domChangeCount:J}=Q.input;setTimeout(()=>{if(Q.input.domChangeCount!=J)return;if(Q.dom.blur(),Q.focus(),Q.someProp("handleKeyDown",(q)=>q(Q,Q1(8,"Backspace"))))return;let{$cursor:Y}=Q.state.selection;if(Y&&Y.pos>0)Q.dispatch(Q.state.tr.delete(Y.pos-1,Y.pos).scrollIntoView())},50)}};for(let Q in q0)Y0[Q]=q0[Q];class R5{constructor(Q,Z){this.toDOM=Q,this.spec=Z||J1,this.side=this.spec.side||0}map(Q,Z,X,J){let{pos:Y,deleted:q}=Q.mapResult(Z.from+J,this.side<0?-1:1);return q?null:new s(Y-X,Y-X,this)}valid(){return!0}eq(Q){return this==Q||Q instanceof R5&&(this.spec.key&&this.spec.key==Q.spec.key||this.toDOM==Q.toDOM&&o1(this.spec,Q.spec))}destroy(Q){if(this.spec.destroy)this.spec.destroy(Q)}}class p0{constructor(Q,Z){this.attrs=Q,this.spec=Z||J1}map(Q,Z,X,J){let Y=Q.map(Z.from+J,this.spec.inclusiveStart?-1:1)-X,q=Q.map(Z.to+J,this.spec.inclusiveEnd?1:-1)-X;return Y>=q?null:new s(Y,q,this)}valid(Q,Z){return Z.from<Z.to}eq(Q){return this==Q||Q instanceof p0&&o1(this.attrs,Q.attrs)&&o1(this.spec,Q.spec)}static is(Q){return Q.type instanceof p0}destroy(){}}class l6{constructor(Q,Z){this.attrs=Q,this.spec=Z||J1}map(Q,Z,X,J){let Y=Q.mapResult(Z.from+J,1);if(Y.deleted)return null;let q=Q.mapResult(Z.to+J,-1);if(q.deleted||q.pos<=Y.pos)return null;return new s(Y.pos-X,q.pos-X,this)}valid(Q,Z){let{index:X,offset:J}=Q.content.findIndex(Z.from),Y;return J==Z.from&&!(Y=Q.child(X)).isText&&J+Y.nodeSize==Z.to}eq(Q){return this==Q||Q instanceof l6&&o1(this.attrs,Q.attrs)&&o1(this.spec,Q.spec)}destroy(){}}class s{constructor(Q,Z,X){this.from=Q,this.to=Z,this.type=X}copy(Q,Z){return new s(Q,Z,this.type)}eq(Q,Z=0){return this.type.eq(Q.type)&&this.from+Z==Q.from&&this.to+Z==Q.to}map(Q,Z,X){return this.type.map(Q,this,Z,X)}static widget(Q,Z,X){return new s(Q,Q,new R5(Z,X))}static inline(Q,Z,X,J){return new s(Q,Z,new p0(X,J))}static node(Q,Z,X,J){return new s(Q,Z,new l6(X,J))}get spec(){return this.type.spec}get inline(){return this.type instanceof p0}get widget(){return this.type instanceof R5}}var D1=[],J1={};class w{constructor(Q,Z){this.local=Q.length?Q:D1,this.children=Z.length?Z:D1}static create(Q,Z){return Z.length?N5(Z,Q,0,J1):Q0}find(Q,Z,X){let J=[];return this.findInner(Q==null?0:Q,Z==null?1e9:Z,J,0,X),J}findInner(Q,Z,X,J,Y){for(let q=0;q<this.local.length;q++){let U=this.local[q];if(U.from<=Z&&U.to>=Q&&(!Y||Y(U.spec)))X.push(U.copy(U.from+J,U.to+J))}for(let q=0;q<this.children.length;q+=3)if(this.children[q]<Z&&this.children[q+1]>Q){let U=this.children[q]+1;this.children[q+2].findInner(Q-U,Z-U,X,J+U,Y)}}map(Q,Z,X){if(this==Q0||Q.maps.length==0)return this;return this.mapInner(Q,Z,0,0,X||J1)}mapInner(Q,Z,X,J,Y){let q;for(let U=0;U<this.local.length;U++){let G=this.local[U].map(Q,X,J);if(G&&G.type.valid(Z,G))(q||(q=[])).push(G);else if(Y.onRemove)Y.onRemove(this.local[U].spec)}if(this.children.length)return KX(this.children,q||[],Q,Z,X,J,Y);else return q?new w(q.sort(Y1),D1):Q0}add(Q,Z){if(!Z.length)return this;if(this==Q0)return w.create(Q,Z);return this.addInner(Q,Z,0)}addInner(Q,Z,X){let J,Y=0;Q.forEach((U,G)=>{let z=G+X,V;if(!(V=eQ(Z,U,z)))return;if(!J)J=this.children.slice();while(Y<J.length&&J[Y]<G)Y+=3;if(J[Y]==G)J[Y+2]=J[Y+2].addInner(U,V,z+1);else J.splice(Y,0,G,G+U.nodeSize,N5(V,U,z+1,J1));Y+=3});let q=tQ(Y?Q4(Z):Z,-X);for(let U=0;U<q.length;U++)if(!q[U].type.valid(Q,q[U]))q.splice(U--,1);return new w(q.length?this.local.concat(q).sort(Y1):this.local,J||this.children)}remove(Q){if(Q.length==0||this==Q0)return this;return this.removeInner(Q,0)}removeInner(Q,Z){let X=this.children,J=this.local;for(let Y=0;Y<X.length;Y+=3){let q,U=X[Y]+Z,G=X[Y+1]+Z;for(let V=0,K;V<Q.length;V++)if(K=Q[V]){if(K.from>U&&K.to<G)Q[V]=null,(q||(q=[])).push(K)}if(!q)continue;if(X==this.children)X=this.children.slice();let z=X[Y+2].removeInner(q,U+1);if(z!=Q0)X[Y+2]=z;else X.splice(Y,3),Y-=3}if(J.length){for(let Y=0,q;Y<Q.length;Y++)if(q=Q[Y]){for(let U=0;U<J.length;U++)if(J[U].eq(q,Z)){if(J==this.local)J=this.local.slice();J.splice(U--,1)}}}if(X==this.children&&J==this.local)return this;return J.length||X.length?new w(J,X):Q0}forChild(Q,Z){if(this==Q0)return this;if(Z.isLeaf)return w.empty;let X,J;for(let U=0;U<this.children.length;U+=3)if(this.children[U]>=Q){if(this.children[U]==Q)X=this.children[U+2];break}let Y=Q+1,q=Y+Z.content.size;for(let U=0;U<this.local.length;U++){let G=this.local[U];if(G.from<q&&G.to>Y&&G.type instanceof p0){let z=Math.max(Y,G.from)-Y,V=Math.min(q,G.to)-Y;if(z<V)(J||(J=[])).push(G.copy(z,V))}}if(J){let U=new w(J.sort(Y1),D1);return X?new h0([U,X]):U}return X||Q0}eq(Q){if(this==Q)return!0;if(!(Q instanceof w)||this.local.length!=Q.local.length||this.children.length!=Q.children.length)return!1;for(let Z=0;Z<this.local.length;Z++)if(!this.local[Z].eq(Q.local[Z]))return!1;for(let Z=0;Z<this.children.length;Z+=3)if(this.children[Z]!=Q.children[Z]||this.children[Z+1]!=Q.children[Z+1]||!this.children[Z+2].eq(Q.children[Z+2]))return!1;return!0}locals(Q){return c6(this.localsInner(Q))}localsInner(Q){if(this==Q0)return D1;if(Q.inlineContent||!this.local.some(p0.is))return this.local;let Z=[];for(let X=0;X<this.local.length;X++)if(!(this.local[X].type instanceof p0))Z.push(this.local[X]);return Z}forEachSet(Q){Q(this)}}w.empty=new w([],[]);w.removeOverlap=c6;var Q0=w.empty;class h0{constructor(Q){this.members=Q}map(Q,Z){const X=this.members.map((J)=>J.map(Q,Z,J1));return h0.from(X)}forChild(Q,Z){if(Z.isLeaf)return w.empty;let X=[];for(let J=0;J<this.members.length;J++){let Y=this.members[J].forChild(Q,Z);if(Y==Q0)continue;if(Y instanceof h0)X=X.concat(Y.members);else X.push(Y)}return h0.from(X)}eq(Q){if(!(Q instanceof h0)||Q.members.length!=this.members.length)return!1;for(let Z=0;Z<this.members.length;Z++)if(!this.members[Z].eq(Q.members[Z]))return!1;return!0}locals(Q){let Z,X=!0;for(let J=0;J<this.members.length;J++){let Y=this.members[J].localsInner(Q);if(!Y.length)continue;if(!Z)Z=Y;else{if(X)Z=Z.slice(),X=!1;for(let q=0;q<Y.length;q++)Z.push(Y[q])}}return Z?c6(X?Z:Z.sort(Y1)):D1}static from(Q){switch(Q.length){case 0:return Q0;case 1:return Q[0];default:return new h0(Q.every((Z)=>Z instanceof w)?Q:Q.reduce((Z,X)=>Z.concat(X instanceof w?X:X.members),[]))}}forEachSet(Q){for(let Z=0;Z<this.members.length;Z++)this.members[Z].forEachSet(Q)}}var WX={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},LX=U0&&l0<=11;class Z4{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(Q){this.anchorNode=Q.anchorNode,this.anchorOffset=Q.anchorOffset,this.focusNode=Q.focusNode,this.focusOffset=Q.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(Q){return Q.anchorNode==this.anchorNode&&Q.anchorOffset==this.anchorOffset&&Q.focusNode==this.focusNode&&Q.focusOffset==this.focusOffset}}class X4{constructor(Q,Z){if(this.view=Q,this.handleDOMChange=Z,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Z4,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver((X)=>{for(let J=0;J<X.length;J++)this.queue.push(X[J]);if(U0&&l0<=11&&X.some((J)=>J.type=="childList"&&J.removedNodes.length||J.type=="characterData"&&J.oldValue.length>J.target.nodeValue.length))this.flushSoon();else this.flush()}),LX)this.onCharData=(X)=>{this.queue.push({target:X.target,type:"characterData",oldValue:X.prevValue}),this.flushSoon()};this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){if(this.flushingSoon<0)this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20)}forceFlush(){if(this.flushingSoon>-1)window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush()}start(){if(this.observer)this.observer.takeRecords(),this.observer.observe(this.view.dom,WX);if(this.onCharData)this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.connectSelection()}stop(){if(this.observer){let Q=this.observer.takeRecords();if(Q.length){for(let Z=0;Z<Q.length;Z++)this.queue.push(Q[Z]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}if(this.onCharData)this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData);this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(!ZQ(this.view))return;if(this.suppressingSelectionUpdates)return b0(this.view);if(U0&&l0<=11&&!this.view.state.selection.empty){let Q=this.view.domSelectionRange();if(Q.focusNode&&q1(Q.focusNode,Q.focusOffset,Q.anchorNode,Q.anchorOffset))return this.flushSoon()}this.flush()}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(Q){if(!Q.focusNode)return!0;let Z=new Set,X;for(let Y=Q.focusNode;Y;Y=C1(Y))Z.add(Y);for(let Y=Q.anchorNode;Y;Y=C1(Y))if(Z.has(Y)){X=Y;break}let J=X&&this.view.docView.nearestDesc(X);if(J&&J.ignoreMutation({type:"selection",target:X.nodeType==3?X.parentNode:X}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let Q of this.observer.takeRecords())this.queue.push(Q);return this.queue}flush(){let{view:Q}=this;if(!Q.docView||this.flushingSoon>-1)return;let Z=this.pendingRecords();if(Z.length)this.queue=[];let X=Q.domSelectionRange(),J=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(X)&&ZQ(Q)&&!this.ignoreSelectionChange(X),Y=-1,q=-1,U=!1,G=[];if(Q.editable)for(let V=0;V<Z.length;V++){let K=this.registerMutation(Z[V],G);if(K){if(Y=Y<0?K.from:Math.min(K.from,Y),q=q<0?K.to:Math.max(K.to,q),K.typeOver)U=!0}}if(I0&&G.length){let V=G.filter((K)=>K.nodeName=="BR");if(V.length==2){let[K,H]=V;if(K.parentNode&&K.parentNode.parentNode==H.parentNode)H.remove();else K.remove()}else{let{focusNode:K}=this.currentSelection;for(let H of V){let W=H.parentNode;if(W&&W.nodeName=="LI"&&(!K||IX(Q,K)!=W))H.remove()}}}let z=null;if(Y<0&&J&&Q.input.lastFocus>Date.now()-200&&Math.max(Q.input.lastTouch,Q.input.lastClick.time)<Date.now()-300&&D5(X)&&(z=g6(Q))&&z.eq(N.near(Q.state.doc.resolve(0),1)))Q.input.lastFocus=0,b0(Q),this.currentSelection.set(X),Q.scrollToSelection();else if(Y>-1||J){if(Y>-1)Q.docView.markDirty(Y,q),BX(Q);if(this.handleDOMChange(Y,q,U,G),Q.docView&&Q.docView.dirty)Q.updateState(Q.state);else if(!this.currentSelection.eq(X))b0(Q);this.currentSelection.set(X)}}registerMutation(Q,Z){if(Z.indexOf(Q.target)>-1)return null;let X=this.view.docView.nearestDesc(Q.target);if(Q.type=="attributes"&&(X==this.view.docView||Q.attributeName=="contenteditable"||Q.attributeName=="style"&&!Q.oldValue&&!Q.target.getAttribute("style")))return null;if(!X||X.ignoreMutation(Q))return null;if(Q.type=="childList"){for(let V=0;V<Q.addedNodes.length;V++){let K=Q.addedNodes[V];if(Z.push(K),K.nodeType==3)this.lastChangedTextNode=K}if(X.contentDOM&&X.contentDOM!=X.dom&&!X.contentDOM.contains(Q.target))return{from:X.posBefore,to:X.posAfter};let{previousSibling:J,nextSibling:Y}=Q;if(U0&&l0<=11&&Q.addedNodes.length)for(let V=0;V<Q.addedNodes.length;V++){let{previousSibling:K,nextSibling:H}=Q.addedNodes[V];if(!K||Array.prototype.indexOf.call(Q.addedNodes,K)<0)J=K;if(!H||Array.prototype.indexOf.call(Q.addedNodes,H)<0)Y=H}let q=J&&J.parentNode==Q.target?o(J)+1:0,U=X.localPosFromDOM(Q.target,q,-1),G=Y&&Y.parentNode==Q.target?o(Y):Q.target.childNodes.length,z=X.localPosFromDOM(Q.target,G,1);return{from:U,to:z}}else if(Q.type=="attributes")return{from:X.posAtStart-X.border,to:X.posAtEnd+X.border};else return this.lastChangedTextNode=Q.target,{from:X.posAtStart,to:X.posAtEnd,typeOver:Q.target.nodeValue==Q.oldValue}}}var KQ=new WeakMap,HQ=!1,jX=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;class p6{constructor(Q,Z){if(this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new pQ,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=Z,this.state=Z.state,this.directPlugins=Z.plugins||[],this.directPlugins.forEach(jQ),this.dispatch=this.dispatch.bind(this),this.dom=Q&&Q.mount||document.createElement("div"),Q){if(Q.appendChild)Q.appendChild(this.dom);else if(typeof Q=="function")Q(this.dom);else if(Q.mount)this.mounted=!0}this.editable=FQ(this),IQ(this),this.nodeViews=PQ(this),this.docView=n9(this.state.doc,_Q(this),E6(this),this.dom,this),this.domObserver=new X4(this,(X,J,Y,q)=>EX(this,X,J,Y,q)),this.domObserver.start(),sZ(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let Q=this._props;this._props={};for(let Z in Q)this._props[Z]=Q[Z];this._props.state=this.state}return this._props}update(Q){if(Q.handleDOMEvents!=this._props.handleDOMEvents)y6(this);let Z=this._props;if(this._props=Q,Q.plugins)Q.plugins.forEach(jQ),this.directPlugins=Q.plugins;this.updateStateInner(Q.state,Z)}setProps(Q){let Z={};for(let X in this._props)Z[X]=this._props[X];Z.state=this.state;for(let X in Q)Z[X]=Q[X];this.update(Z)}updateState(Q){this.updateStateInner(Q,this._props)}updateStateInner(Q,Z){var X;let J=this.state,Y=!1,q=!1;if(Q.storedMarks&&this.composing)nQ(this),q=!0;this.state=Q;let U=J.plugins!=Q.plugins||this._props.plugins!=Z.plugins;if(U||this._props.plugins!=Z.plugins||this._props.nodeViews!=Z.nodeViews){let W=PQ(this);if(DX(W,this.nodeViews))this.nodeViews=W,Y=!0}if(U||Z.handleDOMEvents!=this._props.handleDOMEvents)y6(this);this.editable=FQ(this),IQ(this);let G=E6(this),z=_Q(this),V=J.plugins!=Q.plugins&&!J.doc.eq(Q.doc)?"reset":Q.scrollToSelection>J.scrollToSelection?"to selection":"preserve",K=Y||!this.docView.matchesNode(Q.doc,z,G);if(K||!Q.selection.eq(J.selection))q=!0;let H=V=="preserve"&&q&&this.dom.style.overflowAnchor==null&&HZ(this);if(q){this.domObserver.stop();let W=K&&(U0||Z0)&&!this.composing&&!J.selection.empty&&!Q.selection.empty&&NX(J.selection,Q.selection);if(K){let B=Z0?this.trackWrites=this.domSelectionRange().focusNode:null;if(this.composing)this.input.compositionNode=qX(this);if(Y||!this.docView.update(Q.doc,z,G,this))this.docView.updateOuterDeco(z),this.docView.destroy(),this.docView=n9(Q.doc,z,G,this.dom,this);if(B&&!this.trackWrites)W=!0}if(W||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&bZ(this)))b0(this,W);else gQ(this,Q.selection),this.domObserver.setCurSelection();this.domObserver.start()}if(this.updatePluginViews(J),((X=this.dragging)===null||X===void 0?void 0:X.node)&&!J.doc.eq(Q.doc))this.updateDraggedNode(this.dragging,J);if(V=="reset")this.dom.scrollTop=0;else if(V=="to selection")this.scrollToSelection();else if(H)WZ(H)}scrollToSelection(){let Q=this.domSelectionRange().focusNode;if(!Q||!this.dom.contains(Q.nodeType==1?Q:Q.parentNode));else if(this.someProp("handleScrollToSelection",(Z)=>Z(this)));else if(this.state.selection instanceof R){let Z=this.docView.domAfterPos(this.state.selection.from);if(Z.nodeType==1)c9(this,Z.getBoundingClientRect(),Q)}else c9(this,this.coordsAtPos(this.state.selection.head,1),Q)}destroyPluginViews(){let Q;while(Q=this.pluginViews.pop())if(Q.destroy)Q.destroy()}updatePluginViews(Q){if(!Q||Q.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let Z=0;Z<this.directPlugins.length;Z++){let X=this.directPlugins[Z];if(X.spec.view)this.pluginViews.push(X.spec.view(this))}for(let Z=0;Z<this.state.plugins.length;Z++){let X=this.state.plugins[Z];if(X.spec.view)this.pluginViews.push(X.spec.view(this))}}else for(let Z=0;Z<this.pluginViews.length;Z++){let X=this.pluginViews[Z];if(X.update)X.update(this,Q)}}updateDraggedNode(Q,Z){let X=Q.node,J=-1;if(this.state.doc.nodeAt(X.from)==X.node)J=X.from;else{let Y=X.from+(this.state.doc.content.size-Z.doc.content.size);if((Y>0&&this.state.doc.nodeAt(Y))==X.node)J=Y}this.dragging=new m6(Q.slice,Q.move,J<0?void 0:R.create(this.state.doc,J))}someProp(Q,Z){let X=this._props&&this._props[Q],J;if(X!=null&&(J=Z?Z(X):X))return J;for(let q=0;q<this.directPlugins.length;q++){let U=this.directPlugins[q].props[Q];if(U!=null&&(J=Z?Z(U):U))return J}let Y=this.state.plugins;if(Y)for(let q=0;q<Y.length;q++){let U=Y[q].props[Q];if(U!=null&&(J=Z?Z(U):U))return J}}hasFocus(){if(U0){let Q=this.root.activeElement;if(Q==this.dom)return!0;if(!Q||!this.dom.contains(Q))return!1;while(Q&&this.dom!=Q&&this.dom.contains(Q)){if(Q.contentEditable=="false")return!1;Q=Q.parentElement}return!0}return this.root.activeElement==this.dom}focus(){if(this.domObserver.stop(),this.editable)LZ(this.dom);b0(this),this.domObserver.start()}get root(){let Q=this._root;if(Q==null){for(let Z=this.dom.parentNode;Z;Z=Z.parentNode)if(Z.nodeType==9||Z.nodeType==11&&Z.host){if(!Z.getSelection)Object.getPrototypeOf(Z).getSelection=()=>Z.ownerDocument.getSelection();return this._root=Z}}return Q||document}updateRoot(){this._root=null}posAtCoords(Q){return PZ(this,Q)}coordsAtPos(Q,Z=1){return MQ(this,Q,Z)}domAtPos(Q,Z=0){return this.docView.domFromPos(Q,Z)}nodeDOM(Q){let Z=this.docView.descAt(Q);return Z?Z.nodeDOM:null}posAtDOM(Q,Z,X=-1){let J=this.docView.posFromDOM(Q,Z,X);if(J==null)throw new RangeError("DOM position not inside the editor");return J}endOfTextblock(Q,Z){return RZ(this,Z||this.state,Q)}pasteHTML(Q,Z){return r1(this,"",Q,!1,Z||new ClipboardEvent("paste"))}pasteText(Q,Z){return r1(this,Q,null,!0,Z||new ClipboardEvent("paste"))}serializeForClipboard(Q){return u6(this,Q)}destroy(){if(!this.docView)return;if(aZ(this),this.destroyPluginViews(),this.mounted)this.docView.update(this.state.doc,[],E6(this),this),this.dom.textContent="";else if(this.dom.parentNode)this.dom.parentNode.removeChild(this.dom);this.docView.destroy(),this.docView=null,QZ()}get isDestroyed(){return this.docView==null}dispatchEvent(Q){return rZ(this,Q)}dispatch(Q){let Z=this._props.dispatchTransaction;if(Z)Z.call(this,Q);else this.updateState(this.state.apply(Q))}domSelectionRange(){let Q=this.domSelection();if(!Q)return{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0};return J0&&this.root.nodeType===11&&qZ(this.dom.ownerDocument)==this.dom&&_X(this,Q)||Q}domSelection(){return this.root.getSelection()}}function J4(Q){var Z=MX&&Q.metaKey&&Q.shiftKey&&!Q.ctrlKey&&!Q.altKey||CX&&Q.shiftKey&&Q.key&&Q.key.length==1||Q.key=="Unidentified",X=!Z&&Q.key||(Q.shiftKey?k5:$0)[Q.keyCode]||Q.key||"Unidentified";if(X=="Esc")X="Escape";if(X=="Del")X="Delete";if(X=="Left")X="ArrowLeft";if(X=="Up")X="ArrowUp";if(X=="Right")X="ArrowRight";if(X=="Down")X="ArrowDown";return X}var $0={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},k5={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:"\""},MX=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),CX=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(p=0;p<10;p++)$0[48+p]=$0[96+p]=String(p);var p;for(p=1;p<=24;p++)$0[p+111]="F"+p;var p;for(p=65;p<=90;p++)$0[p]=String.fromCharCode(p+32),k5[p]=String.fromCharCode(p);var p;for(T5 in $0)if(!k5.hasOwnProperty(T5))k5[T5]=$0[T5];var T5;var kX=function(Q){let Z=Q.split(/-(?!$)/),X=Z[Z.length-1];if(X=="Space")X=" ";let J,Y,q,U;for(let G=0;G<Z.length-1;G++){let z=Z[G];if(/^(cmd|meta|m)$/i.test(z))U=!0;else if(/^a(lt)?$/i.test(z))J=!0;else if(/^(c|ctrl|control)$/i.test(z))Y=!0;else if(/^s(hift)?$/i.test(z))q=!0;else if(/^mod$/i.test(z))if(TX)U=!0;else Y=!0;else throw new Error("Unrecognized modifier name: "+z)}if(J)X="Alt-"+X;if(Y)X="Ctrl-"+X;if(U)X="Meta-"+X;if(q)X="Shift-"+X;return X},SX=function(Q){let Z=Object.create(null);for(let X in Q)Z[kX(X)]=Q[X];return Z},d6=function(Q,Z,X=!0){if(Z.altKey)Q="Alt-"+Q;if(Z.ctrlKey)Q="Ctrl-"+Q;if(Z.metaKey)Q="Meta-"+Q;if(X&&Z.shiftKey)Q="Shift-"+Q;return Q},Y4=function(Q){return new g({props:{handleKeyDown:Q5(Q)}})},Q5=function(Q){let Z=SX(Q);return function(X,J){let Y=J4(J),q,U=Z[d6(Y,J)];if(U&&U(X.state,X.dispatch,X))return!0;if(Y.length==1&&Y!=" "){if(J.shiftKey){let G=Z[d6(Y,J,!1)];if(G&&G(X.state,X.dispatch,X))return!0}if((J.shiftKey||J.altKey||J.metaKey||Y.charCodeAt(0)>127)&&(q=$0[J.keyCode])&&q!=Y){let G=Z[d6(q,J)];if(G&&G(X.state,X.dispatch,X))return!0}}return!1}},TX=typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;var U4=function(Q,Z){let{$cursor:X}=Q.selection;if(!X||(Z?!Z.endOfTextblock("backward",Q):X.parentOffset>0))return null;return X},V4=function(Q,Z,X){let J=Z.nodeBefore,Y=J,q=Z.pos-1;for(;!Y.isTextblock;q--){if(Y.type.spec.isolating)return!1;let K=Y.lastChild;if(!K)return!1;Y=K}let U=Z.nodeAfter,G=U,z=Z.pos+1;for(;!G.isTextblock;z++){if(G.type.spec.isolating)return!1;let K=G.firstChild;if(!K)return!1;G=K}let V=p1(Q.doc,q,z,j.empty);if(!V||V.from!=q||V instanceof h&&V.slice.size>=z-q)return!1;if(X){let K=Q.tr.step(V);K.setSelection(O.create(K.doc,q)),X(K.scrollIntoView())}return!0},S1=function(Q,Z,X=!1){for(let J=Q;J;J=Z=="start"?J.firstChild:J.lastChild){if(J.isTextblock)return!0;if(X&&J.childCount!=1)return!1}return!1},n6=function(Q){if(!Q.parent.type.spec.isolating)for(let Z=Q.depth-1;Z>=0;Z--){if(Q.index(Z)>0)return Q.doc.resolve(Q.before(Z+1));if(Q.node(Z).type.spec.isolating)break}return null},K4=function(Q,Z){let{$cursor:X}=Q.selection;if(!X||(Z?!Z.endOfTextblock("forward",Q):X.parentOffset<X.parent.content.size))return null;return X},t6=function(Q){if(!Q.parent.type.spec.isolating)for(let Z=Q.depth-1;Z>=0;Z--){let X=Q.node(Z);if(Q.index(Z)+1<X.childCount)return Q.doc.resolve(Q.after(Z+1));if(X.type.spec.isolating)break}return null},Q7=function(Q){for(let Z=0;Z<Q.edgeCount;Z++){let{type:X}=Q.edge(Z);if(X.isTextblock&&!X.hasRequiredAttrs())return X}return null},yX=function(Q){return(Z,X)=>{let{$from:J,$to:Y}=Z.selection;if(Z.selection instanceof R&&Z.selection.node.isBlock){if(!J.parentOffset||!H0(Z.doc,J.pos))return!1;if(X)X(Z.tr.split(J.pos).scrollIntoView());return!0}if(!J.depth)return!1;let q=[],U,G,z=!1,V=!1;for(let B=J.depth;;B--)if(J.node(B).isBlock){z=J.end(B)==J.pos+(J.depth-B),V=J.start(B)==J.pos-(J.depth-B),G=Q7(J.node(B-1).contentMatchAt(J.indexAfter(B-1)));let _=Q&&Q(Y.parent,z,J);q.unshift(_||(z&&G?{type:G}:null)),U=B;break}else{if(B==1)return!1;q.unshift(null)}let K=Z.tr;if(Z.selection instanceof O||Z.selection instanceof r)K.deleteSelection();let H=K.mapping.map(J.pos),W=H0(K.doc,H,q.length,q);if(!W)q[0]=G?{type:G}:null,W=H0(K.doc,H,q.length,q);if(K.split(H,q.length,q),!z&&V&&J.node(U).type!=G){let B=K.mapping.map(J.before(U)),L=K.doc.resolve(B);if(G&&J.node(U-1).canReplaceWith(L.index(),L.index()+1,G))K.setNodeMarkup(K.mapping.map(J.before(U)),G)}if(X)X(K.scrollIntoView());return!0}},xX=function(Q,Z,X){let{nodeBefore:J,nodeAfter:Y}=Z,q=Z.index();if(!J||!Y||!J.type.compatibleContent(Y.type))return!1;if(!J.content.size&&Z.parent.canReplace(q-1,q)){if(X)X(Q.tr.delete(Z.pos-J.nodeSize,Z.pos).scrollIntoView());return!0}if(!Z.parent.canReplace(q,q+1)||!(Y.isTextblock||_0(Q.doc,Z.pos)))return!1;if(X)X(Q.tr.join(Z.pos).scrollIntoView());return!0},_4=function(Q,Z,X,J){let{nodeBefore:Y,nodeAfter:q}=Z,U,G,z=Y.type.spec.isolating||q.type.spec.isolating;if(!z&&xX(Q,Z,X))return!0;let V=!z&&Z.parent.canReplace(Z.index(),Z.index()+1);if(V&&(U=(G=Y.contentMatchAt(Y.childCount)).findWrapping(q.type))&&G.matchType(U[0]||q.type).validEnd){if(X){let B=Z.pos+q.nodeSize,L=P.empty;for(let F=U.length-1;F>=0;F--)L=P.from(U[F].create(null,L));L=P.from(Y.copy(L));let _=Q.tr.step(new u(Z.pos-1,B,Z.pos,B,new j(L,1,0),U.length,!0)),I=_.doc.resolve(B+2*U.length);if(I.nodeAfter&&I.nodeAfter.type==Y.type&&_0(_.doc,I.pos))_.join(I.pos);X(_.scrollIntoView())}return!0}let K=q.type.spec.isolating||J>0&&z?null:N.findFrom(Z,1),H=K&&K.$from.blockRange(K.$to),W=H&&T0(H);if(W!=null&&W>=Z.depth){if(X)X(Q.tr.lift(H,W).scrollIntoView());return!0}if(V&&S1(q,"start",!0)&&S1(Y,"end")){let B=Y,L=[];for(;;){if(L.push(B),B.isTextblock)break;B=B.lastChild}let _=q,I=1;for(;!_.isTextblock;_=_.firstChild)I++;if(B.canReplace(B.childCount,B.childCount,_.content)){if(X){let F=P.empty;for(let M=L.length-1;M>=0;M--)F=P.from(L[M].copy(F));let E=Q.tr.step(new u(Z.pos-L.length,Z.pos+q.nodeSize,Z.pos+I,Z.pos+q.nodeSize-I,new j(F,L.length,0),0,!0));X(E.scrollIntoView())}return!0}}return!1},I4=function(Q){return function(Z,X){let J=Z.selection,Y=Q<0?J.$from:J.$to,q=Y.depth;while(Y.node(q).isInline){if(!q)return!1;q--}if(!Y.node(q).isTextblock)return!1;if(X)X(Z.tr.setSelection(O.create(Z.doc,Q<0?Y.start(q):Y.end(q))));return!0}},F4=function(Q,Z=null){return function(X,J){let{$from:Y,$to:q}=X.selection,U=Y.blockRange(q),G=U&&P1(U,Q,Z);if(!G)return!1;if(J)J(X.tr.wrap(U,G).scrollIntoView());return!0}},U7=function(Q,Z=null){return function(X,J){let Y=!1;for(let q=0;q<X.selection.ranges.length&&!Y;q++){let{$from:{pos:U},$to:{pos:G}}=X.selection.ranges[q];X.doc.nodesBetween(U,G,(z,V)=>{if(Y)return!1;if(!z.isTextblock||z.hasMarkup(Q,Z))return;if(z.type==Q)Y=!0;else{let K=X.doc.resolve(V),H=K.index();Y=K.parent.canReplaceWith(H,H+1,Q)}})}if(!Y)return!1;if(J){let q=X.tr;for(let U=0;U<X.selection.ranges.length;U++){let{$from:{pos:G},$to:{pos:z}}=X.selection.ranges[U];q.setBlockType(G,z,Q,Z)}J(q.scrollIntoView())}return!0}};var G7=function(...Q){return function(Z,X,J){for(let Y=0;Y<Q.length;Y++)if(Q[Y](Z,X,J))return!0;return!1}},S5=(Q,Z)=>{if(Q.selection.empty)return!1;if(Z)Z(Q.tr.deleteSelection().scrollIntoView());return!0},s6=(Q,Z,X)=>{let J=U4(Q,X);if(!J)return!1;let Y=n6(J);if(!Y){let U=J.blockRange(),G=U&&T0(U);if(G==null)return!1;if(Z)Z(Q.tr.lift(U,G).scrollIntoView());return!0}let q=Y.nodeBefore;if(_4(Q,Y,Z,-1))return!0;if(J.parent.content.size==0&&(S1(q,"end")||R.isSelectable(q)))for(let U=J.depth;;U--){let G=p1(Q.doc,J.before(U),J.after(U),j.empty);if(G&&G.slice.size<G.to-G.from){if(Z){let z=Q.tr.step(G);z.setSelection(S1(q,"end")?N.findFrom(z.doc.resolve(z.mapping.map(Y.pos,-1)),-1):R.create(z.doc,Y.pos-q.nodeSize)),Z(z.scrollIntoView())}return!0}if(U==1||J.node(U-1).childCount>1)break}if(q.isAtom&&Y.depth==J.depth-1){if(Z)Z(Q.tr.delete(Y.pos-q.nodeSize,Y.pos).scrollIntoView());return!0}return!1},G4=(Q,Z,X)=>{let J=U4(Q,X);if(!J)return!1;let Y=n6(J);return Y?V4(Q,Y,Z):!1},z4=(Q,Z,X)=>{let J=K4(Q,X);if(!J)return!1;let Y=t6(J);return Y?V4(Q,Y,Z):!1},a6=(Q,Z,X)=>{let{$head:J,empty:Y}=Q.selection,q=J;if(!Y)return!1;if(J.parent.isTextblock){if(X?!X.endOfTextblock("backward",Q):J.parentOffset>0)return!1;q=n6(J)}let U=q&&q.nodeBefore;if(!U||!R.isSelectable(U))return!1;if(Z)Z(Q.tr.setSelection(R.create(Q.doc,q.pos-U.nodeSize)).scrollIntoView());return!0},r6=(Q,Z,X)=>{let J=K4(Q,X);if(!J)return!1;let Y=t6(J);if(!Y)return!1;let q=Y.nodeAfter;if(_4(Q,Y,Z,1))return!0;if(J.parent.content.size==0&&(S1(q,"start")||R.isSelectable(q))){let U=p1(Q.doc,J.before(),J.after(),j.empty);if(U&&U.slice.size<U.to-U.from){if(Z){let G=Q.tr.step(U);G.setSelection(S1(q,"start")?N.findFrom(G.doc.resolve(G.mapping.map(Y.pos)),1):R.create(G.doc,G.mapping.map(Y.pos))),Z(G.scrollIntoView())}return!0}}if(q.isAtom&&Y.depth==J.depth-1){if(Z)Z(Q.tr.delete(Y.pos,Y.pos+q.nodeSize).scrollIntoView());return!0}return!1},o6=(Q,Z,X)=>{let{$head:J,empty:Y}=Q.selection,q=J;if(!Y)return!1;if(J.parent.isTextblock){if(X?!X.endOfTextblock("forward",Q):J.parentOffset<J.parent.content.size)return!1;q=t6(J)}let U=q&&q.nodeAfter;if(!U||!R.isSelectable(U))return!1;if(Z)Z(Q.tr.setSelection(R.create(Q.doc,q.pos)).scrollIntoView());return!0},H4=(Q,Z)=>{let X=Q.selection,J=X instanceof R,Y;if(J){if(X.node.isTextblock||!_0(Q.doc,X.from))return!1;Y=X.from}else if(Y=j1(Q.doc,X.from,-1),Y==null)return!1;if(Z){let q=Q.tr.join(Y);if(J)q.setSelection(R.create(q.doc,Y-Q.doc.resolve(Y).nodeBefore.nodeSize));Z(q.scrollIntoView())}return!0},W4=(Q,Z)=>{let X=Q.selection,J;if(X instanceof R){if(X.node.isTextblock||!_0(Q.doc,X.to))return!1;J=X.to}else if(J=j1(Q.doc,X.to,1),J==null)return!1;if(Z)Z(Q.tr.join(J).scrollIntoView());return!0},L4=(Q,Z)=>{let{$from:X,$to:J}=Q.selection,Y=X.blockRange(J),q=Y&&T0(Y);if(q==null)return!1;if(Z)Z(Q.tr.lift(Y,q).scrollIntoView());return!0},e6=(Q,Z)=>{let{$head:X,$anchor:J}=Q.selection;if(!X.parent.type.spec.code||!X.sameParent(J))return!1;if(Z)Z(Q.tr.insertText("\n").scrollIntoView());return!0},Z7=(Q,Z)=>{let{$head:X,$anchor:J}=Q.selection;if(!X.parent.type.spec.code||!X.sameParent(J))return!1;let Y=X.node(-1),q=X.indexAfter(-1),U=Q7(Y.contentMatchAt(q));if(!U||!Y.canReplaceWith(q,q,U))return!1;if(Z){let G=X.after(),z=Q.tr.replaceWith(G,G,U.createAndFill());z.setSelection(N.near(z.doc.resolve(G),1)),Z(z.scrollIntoView())}return!0},X7=(Q,Z)=>{let X=Q.selection,{$from:J,$to:Y}=X;if(X instanceof r||J.parent.inlineContent||Y.parent.inlineContent)return!1;let q=Q7(Y.parent.contentMatchAt(Y.indexAfter()));if(!q||!q.isTextblock)return!1;if(Z){let U=(!J.parentOffset&&Y.index()<Y.parent.childCount?J:Y).pos,G=Q.tr.insert(U,q.createAndFill());G.setSelection(O.create(G.doc,U+1)),Z(G.scrollIntoView())}return!0},J7=(Q,Z)=>{let{$cursor:X}=Q.selection;if(!X||X.parent.content.size)return!1;if(X.depth>1&&X.after()!=X.end(-1)){let q=X.before();if(H0(Q.doc,q)){if(Z)Z(Q.tr.split(q).scrollIntoView());return!0}}let J=X.blockRange(),Y=J&&T0(J);if(Y==null)return!1;if(Z)Z(Q.tr.lift(J,Y).scrollIntoView());return!0},bX=yX();var B4=(Q,Z)=>{let{$from:X,to:J}=Q.selection,Y,q=X.sharedDepth(J);if(q==0)return!1;if(Y=X.before(q),Z)Z(Q.tr.setSelection(R.create(Q.doc,Y)));return!0},$X=(Q,Z)=>{if(Z)Z(Q.tr.setSelection(new r(Q.doc)));return!0},Y7=I4(-1),q7=I4(1),i6=G7(S5,s6,a6),q4=G7(S5,r6,o6),i0={Enter:G7(e6,X7,J7,bX),"Mod-Enter":Z7,Backspace:i6,"Mod-Backspace":i6,"Shift-Backspace":i6,Delete:q4,"Mod-Delete":q4,"Mod-a":$X},gX={"Ctrl-h":i0.Backspace,"Alt-Backspace":i0["Mod-Backspace"],"Ctrl-d":i0.Delete,"Ctrl-Alt-Backspace":i0["Mod-Delete"],"Alt-Delete":i0["Mod-Delete"],"Alt-d":i0["Mod-Delete"],"Ctrl-a":Y7,"Ctrl-e":q7};for(let Q in i0)gX[Q]=i0[Q];var R3=typeof navigator!="undefined"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os!="undefined"&&os.platform?os.platform()=="darwin":!1;var P4=function(Q,Z=null){return function(X,J){let{$from:Y,$to:q}=X.selection,U=Y.blockRange(q);if(!U)return!1;let G=J?X.tr:null;if(!wX(G,U,Q,Z))return!1;if(J)J(G.scrollIntoView());return!0}},wX=function(Q,Z,X,J=null){let Y=!1,q=Z,U=Z.$from.doc;if(Z.depth>=2&&Z.$from.node(Z.depth-1).type.compatibleContent(X)&&Z.startIndex==0){if(Z.$from.index(Z.depth-1)==0)return!1;let z=U.resolve(Z.start-2);if(q=new L1(z,z,Z.depth),Z.endIndex<Z.parent.childCount)Z=new L1(Z.$from,U.resolve(Z.$to.end(Z.depth)),Z.depth);Y=!0}let G=P1(q,X,J,Z);if(!G)return!1;if(Q)uX(Q,Z,G,Y,X);return!0},uX=function(Q,Z,X,J,Y){let q=P.empty;for(let K=X.length-1;K>=0;K--)q=P.from(X[K].type.create(X[K].attrs,q));Q.step(new u(Z.start-(J?2:0),Z.end,Z.start,Z.end,new j(q,0,0),X.length,!0));let U=0;for(let K=0;K<X.length;K++)if(X[K].type==Y)U=K+1;let G=X.length-U,z=Z.start+X.length-(J?2:0),V=Z.parent;for(let{startIndex:K,endIndex:H}=Z,W=!0;K<H;K++,W=!1){if(!W&&H0(Q.doc,z,G))Q.split(z,G),z+=2*G;z+=V.child(K).nodeSize}return Q};var j4=function(Q){return function(Z,X){let{$from:J,$to:Y}=Z.selection,q=J.blockRange(Y,(U)=>U.childCount>0&&U.firstChild.type==Q);if(!q)return!1;if(!X)return!0;if(J.node(q.depth-1).type==Q)return vX(Z,X,Q,q);else return fX(Z,X,q)}},vX=function(Q,Z,X,J){let Y=Q.tr,q=J.end,U=J.$to.end(J.depth);if(q<U)Y.step(new u(q-1,U,q,U,new j(P.from(X.create(null,J.parent.copy())),1,0),1,!0)),J=new L1(Y.doc.resolve(J.$from.pos),Y.doc.resolve(U),J.depth);const G=T0(J);if(G==null)return!1;Y.lift(J,G);let z=Y.doc.resolve(Y.mapping.map(q,-1)-1);if(_0(Y.doc,z.pos)&&z.nodeBefore.type==z.nodeAfter.type)Y.join(z.pos);return Z(Y.scrollIntoView()),!0},fX=function(Q,Z,X){let J=Q.tr,Y=X.parent;for(let B=X.end,L=X.endIndex-1,_=X.startIndex;L>_;L--)B-=Y.child(L).nodeSize,J.delete(B-1,B+1);let q=J.doc.resolve(X.start),U=q.nodeAfter;if(J.mapping.map(X.end)!=X.start+q.nodeAfter.nodeSize)return!1;let G=X.startIndex==0,z=X.endIndex==Y.childCount,V=q.node(-1),K=q.index(-1);if(!V.canReplace(K+(G?0:1),K+1,U.content.append(z?P.empty:P.from(Y))))return!1;let H=q.pos,W=H+U.nodeSize;return J.step(new u(H-(G?1:0),W+(z?1:0),H+1,W-1,new j((G?P.empty:P.from(Y.copy(P.empty))).append(z?P.empty:P.from(Y.copy(P.empty))),G?0:1,z?0:1),G?0:1)),Z(J.scrollIntoView()),!0},E4=function(Q){return function(Z,X){let{$from:J,$to:Y}=Z.selection,q=J.blockRange(Y,(V)=>V.childCount>0&&V.firstChild.type==Q);if(!q)return!1;let U=q.startIndex;if(U==0)return!1;let G=q.parent,z=G.child(U-1);if(z.type!=Q)return!1;if(X){let V=z.lastChild&&z.lastChild.type==G.type,K=P.from(V?Q.create():null),H=new j(P.from(Q.create(null,P.from(G.type.create(null,K)))),V?3:1,0),W=q.start,B=q.end;X(Z.tr.step(new u(W-(V?3:1),B,W,B,H,1,!0)).scrollIntoView())}return!0}};var v5=function(Q){const{state:Z,transaction:X}=Q;let{selection:J}=X,{doc:Y}=X,{storedMarks:q}=X;return{...Z,apply:Z.apply.bind(Z),applyTransaction:Z.applyTransaction.bind(Z),plugins:Z.plugins,schema:Z.schema,reconfigure:Z.reconfigure.bind(Z),toJSON:Z.toJSON.bind(Z),get storedMarks(){return q},get selection(){return J},get doc(){return Y},get tr(){return J=X.selection,Y=X.doc,q=X.storedMarks,X}}},A=function(Q,Z,X){if(Q.config[Z]===void 0&&Q.parent)return A(Q.parent,Z,X);if(typeof Q.config[Z]==="function")return Q.config[Z].bind({...X,parent:Q.parent?A(Q.parent,Z,X):null});return Q.config[Z]},f5=function(Q){const Z=Q.filter((Y)=>Y.type==="extension"),X=Q.filter((Y)=>Y.type==="node"),J=Q.filter((Y)=>Y.type==="mark");return{baseExtensions:Z,nodeExtensions:X,markExtensions:J}},k4=function(Q){const Z=[],{nodeExtensions:X,markExtensions:J}=f5(Q),Y=[...X,...J],q={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return Q.forEach((U)=>{const G={name:U.name,options:U.options,storage:U.storage,extensions:Y},z=A(U,"addGlobalAttributes",G);if(!z)return;z().forEach((K)=>{K.types.forEach((H)=>{Object.entries(K.attributes).forEach(([W,B])=>{Z.push({type:H,name:W,attribute:{...q,...B}})})})})}),Y.forEach((U)=>{const G={name:U.name,options:U.options,storage:U.storage},z=A(U,"addAttributes",G);if(!z)return;const V=z();Object.entries(V).forEach(([K,H])=>{const W={...q,...H};if(typeof(W===null||W===void 0?void 0:W.default)==="function")W.default=W.default();if((W===null||W===void 0?void 0:W.isRequired)&&(W===null||W===void 0?void 0:W.default)===void 0)delete W.default;Z.push({type:U.name,name:K,attribute:W})})}),Z},a=function(Q,Z){if(typeof Q==="string"){if(!Z.nodes[Q])throw Error(`There is no node type named '${Q}'. Maybe you forgot to add the extension?`);return Z.nodes[Q]}return Q},D=function(...Q){return Q.filter((Z)=>!!Z).reduce((Z,X)=>{const J={...Z};return Object.entries(X).forEach(([Y,q])=>{if(!J[Y]){J[Y]=q;return}if(Y==="class"){const G=q?String(q).split(" "):[],z=J[Y]?J[Y].split(" "):[],V=G.filter((K)=>!z.includes(K));J[Y]=[...z,...V].join(" ")}else if(Y==="style"){const G=q?q.split(";").map((K)=>K.trim()).filter(Boolean):[],z=J[Y]?J[Y].split(";").map((K)=>K.trim()).filter(Boolean):[],V=new Map;z.forEach((K)=>{const[H,W]=K.split(":").map((B)=>B.trim());V.set(H,W)}),G.forEach((K)=>{const[H,W]=K.split(":").map((B)=>B.trim());V.set(H,W)}),J[Y]=Array.from(V.entries()).map(([K,H])=>`${K}: ${H}`).join("; ")}else J[Y]=q}),J},{})},H7=function(Q,Z){return Z.filter((X)=>X.type===Q.type.name).filter((X)=>X.attribute.rendered).map((X)=>{if(!X.attribute.renderHTML)return{[X.name]:Q.attrs[X.name]};return X.attribute.renderHTML(Q.attrs)||{}}).reduce((X,J)=>D(X,J),{})},S4=function(Q){return typeof Q==="function"},T=function(Q,Z=void 0,...X){if(S4(Q)){if(Z)return Q.bind(Z)(...X);return Q(...X)}return Q},hX=function(Q={}){return Object.keys(Q).length===0&&Q.constructor===Object},mX=function(Q){if(typeof Q!=="string")return Q;if(Q.match(/^[+-]?(?:\d*\.)?\d+$/))return Number(Q);if(Q==="true")return!0;if(Q==="false")return!1;return Q},A4=function(Q,Z){if("style"in Q)return Q;return{...Q,getAttrs:(X)=>{const J=Q.getAttrs?Q.getAttrs(X):Q.attrs;if(J===!1)return!1;const Y=Z.reduce((q,U)=>{const G=U.attribute.parseHTML?U.attribute.parseHTML(X):mX(X.getAttribute(U.name));if(G===null||G===void 0)return q;return{...q,[U.name]:G}},{});return{...J,...Y}}}},O4=function(Q){return Object.fromEntries(Object.entries(Q).filter(([Z,X])=>{if(Z==="attrs"&&hX(X))return!1;return X!==null&&X!==void 0}))},lX=function(Q,Z){var X;const J=k4(Q),{nodeExtensions:Y,markExtensions:q}=f5(Q),U=(X=Y.find((V)=>A(V,"topNode")))===null||X===void 0?void 0:X.name,G=Object.fromEntries(Y.map((V)=>{const K=J.filter((F)=>F.type===V.name),H={name:V.name,options:V.options,storage:V.storage,editor:Z},W=Q.reduce((F,E)=>{const M=A(E,"extendNodeSchema",H);return{...F,...M?M(V):{}}},{}),B=O4({...W,content:T(A(V,"content",H)),marks:T(A(V,"marks",H)),group:T(A(V,"group",H)),inline:T(A(V,"inline",H)),atom:T(A(V,"atom",H)),selectable:T(A(V,"selectable",H)),draggable:T(A(V,"draggable",H)),code:T(A(V,"code",H)),whitespace:T(A(V,"whitespace",H)),linebreakReplacement:T(A(V,"linebreakReplacement",H)),defining:T(A(V,"defining",H)),isolating:T(A(V,"isolating",H)),attrs:Object.fromEntries(K.map((F)=>{var E;return[F.name,{default:(E=F===null||F===void 0?void 0:F.attribute)===null||E===void 0?void 0:E.default}]}))}),L=T(A(V,"parseHTML",H));if(L)B.parseDOM=L.map((F)=>A4(F,K));const _=A(V,"renderHTML",H);if(_)B.toDOM=(F)=>_({node:F,HTMLAttributes:H7(F,K)});const I=A(V,"renderText",H);if(I)B.toText=I;return[V.name,B]})),z=Object.fromEntries(q.map((V)=>{const K=J.filter((I)=>I.type===V.name),H={name:V.name,options:V.options,storage:V.storage,editor:Z},W=Q.reduce((I,F)=>{const E=A(F,"extendMarkSchema",H);return{...I,...E?E(V):{}}},{}),B=O4({...W,inclusive:T(A(V,"inclusive",H)),excludes:T(A(V,"excludes",H)),group:T(A(V,"group",H)),spanning:T(A(V,"spanning",H)),code:T(A(V,"code",H)),attrs:Object.fromEntries(K.map((I)=>{var F;return[I.name,{default:(F=I===null||I===void 0?void 0:I.attribute)===null||F===void 0?void 0:F.default}]}))}),L=T(A(V,"parseHTML",H));if(L)B.parseDOM=L.map((I)=>A4(I,K));const _=A(V,"renderHTML",H);if(_)B.toDOM=(I)=>_({mark:I,HTMLAttributes:H7(I,K)});return[V.name,B]}));return new L5({topNode:U,nodes:G,marks:z})},z7=function(Q,Z){return Z.nodes[Q]||Z.marks[Q]||null},R4=function(Q,Z){if(Array.isArray(Z))return Z.some((X)=>{return(typeof X==="string"?X:X.name)===Q.name});return Z},B7=function(Q,Z){const X=C0.fromSchema(Z).serializeFragment(Q),Y=document.implementation.createHTMLDocument().createElement("div");return Y.appendChild(X),Y.innerHTML},_7=function(Q){return Object.prototype.toString.call(Q)==="[object RegExp]"},y5=function(Q){var Z;const{editor:X,from:J,to:Y,text:q,rules:U,plugin:G}=Q,{view:z}=X;if(z.composing)return!1;const V=z.state.doc.resolve(J);if(V.parent.type.spec.code||!!((Z=V.nodeBefore||V.nodeAfter)===null||Z===void 0?void 0:Z.marks.find((W)=>W.type.spec.code)))return!1;let K=!1;const H=cX(V)+q;return U.forEach((W)=>{if(K)return;const B=pX(H,W.find);if(!B)return;const L=z.state.tr,_=v5({state:z.state,transaction:L}),I={from:J-(B[0].length-q.length),to:Y},{commands:F,chain:E,can:M}=new X5({editor:X,state:_});if(W.handler({state:_,range:I,match:B,commands:F,chain:E,can:M})===null||!L.steps.length)return;L.setMeta(G,{transform:L,from:J,to:Y,text:q}),z.dispatch(L),K=!0}),K},dX=function(Q){const{editor:Z,rules:X}=Q,J=new g({state:{init(){return null},apply(Y,q,U){const G=Y.getMeta(J);if(G)return G;const z=Y.getMeta("applyInputRules");if(!!z)setTimeout(()=>{let{text:K}=z;if(typeof K==="string")K=K;else K=B7(P.from(K),U.schema);const{from:H}=z,W=H+K.length;y5({editor:Z,from:H,to:W,text:K,rules:X,plugin:J})});return Y.selectionSet||Y.docChanged?null:q}},props:{handleTextInput(Y,q,U,G){return y5({editor:Z,from:q,to:U,text:G,rules:X,plugin:J})},handleDOMEvents:{compositionend:(Y)=>{return setTimeout(()=>{const{$cursor:q}=Y.state.selection;if(q)y5({editor:Z,from:q.pos,to:q.pos,text:"",rules:X,plugin:J})}),!1}},handleKeyDown(Y,q){if(q.key!=="Enter")return!1;const{$cursor:U}=Y.state.selection;if(U)return y5({editor:Z,from:U.pos,to:U.pos,text:"\n",rules:X,plugin:J});return!1}},isInputRules:!0});return J},iX=function(Q){return Object.prototype.toString.call(Q).slice(8,-1)},b5=function(Q){if(iX(Q)!=="Object")return!1;return Q.constructor===Object&&Object.getPrototypeOf(Q)===Object.prototype},h5=function(Q,Z){const X={...Q};if(b5(Q)&&b5(Z))Object.keys(Z).forEach((J)=>{if(b5(Z[J])&&b5(Q[J]))X[J]=h5(Q[J],Z[J]);else X[J]=Z[J]});return X},sX=function(Q){return typeof Q==="number"},nX=function(Q){const{editor:Z,state:X,from:J,to:Y,rule:q,pasteEvent:U,dropEvent:G}=Q,{commands:z,chain:V,can:K}=new X5({editor:Z,state:X}),H=[];return X.doc.nodesBetween(J,Y,(B,L)=>{if(!B.isTextblock||B.type.spec.code)return;const _=Math.max(J,L),I=Math.min(Y,L+B.content.size),F=B.textBetween(_-L,I-L,void 0,"\uFFFC");aX(F,q.find,U).forEach((M)=>{if(M.index===void 0)return;const $=_+M.index+1,k=$+M[0].length,y={from:X.tr.mapping.map($),to:X.tr.mapping.map(k)},m=q.handler({state:X,range:y,match:M,commands:z,chain:V,can:K,pasteEvent:U,dropEvent:G});H.push(m)})}),H.every((B)=>B!==null)},oX=function(Q){const{editor:Z,rules:X}=Q;let J=null,Y=!1,q=!1,U=typeof ClipboardEvent!=="undefined"?new ClipboardEvent("paste"):null,G;try{G=typeof DragEvent!=="undefined"?new DragEvent("drop"):null}catch{G=null}const z=({state:K,from:H,to:W,rule:B,pasteEvt:L})=>{const _=K.tr,I=v5({state:K,transaction:_});if(!nX({editor:Z,state:I,from:Math.max(H-1,0),to:W.b-1,rule:B,pasteEvent:L,dropEvent:G})||!_.steps.length)return;try{G=typeof DragEvent!=="undefined"?new DragEvent("drop"):null}catch{G=null}return U=typeof ClipboardEvent!=="undefined"?new ClipboardEvent("paste"):null,_};return X.map((K)=>{return new g({view(H){const W=(L)=>{var _;if(J=((_=H.dom.parentElement)===null||_===void 0?void 0:_.contains(L.target))?H.dom.parentElement:null,J)$5=Z},B=()=>{if($5)$5=null};return window.addEventListener("dragstart",W),window.addEventListener("dragend",B),{destroy(){window.removeEventListener("dragstart",W),window.removeEventListener("dragend",B)}}},props:{handleDOMEvents:{drop:(H,W)=>{if(q=J===H.dom.parentElement,G=W,!q){const B=$5;if(B)setTimeout(()=>{const L=B.state.selection;if(L)B.commands.deleteRange({from:L.from,to:L.to})},10)}return!1},paste:(H,W)=>{var B;const L=(B=W.clipboardData)===null||B===void 0?void 0:B.getData("text/html");return U=W,Y=!!(L===null||L===void 0?void 0:L.includes("data-pm-slice")),!1}}},appendTransaction:(H,W,B)=>{const L=H[0],_=L.getMeta("uiEvent")==="paste"&&!Y,I=L.getMeta("uiEvent")==="drop"&&!q,F=L.getMeta("applyPasteRules"),E=!!F;if(!_&&!I&&!E)return;if(E){let{text:k}=F;if(typeof k==="string")k=k;else k=B7(P.from(k),B.schema);const{from:y}=F,m=y+k.length,d=rX(k);return z({rule:K,state:B,from:y,to:{b:m},pasteEvt:d})}const M=W.doc.content.findDiffStart(B.doc.content),$=W.doc.content.findDiffEnd(B.doc.content);if(!sX(M)||!$||M===$.b)return;return z({rule:K,state:B,from:M,to:$,pasteEvt:U})}})})},tX=function(Q){const Z=Q.filter((X,J)=>Q.indexOf(X)!==J);return Array.from(new Set(Z))},b4=function(Q,Z,X){const{from:J,to:Y}=Z,{blockSeparator:q="\n\n",textSerializers:U={}}=X||{};let G="";return Q.nodesBetween(J,Y,(z,V,K,H)=>{var W;if(z.isBlock&&V>J)G+=q;const B=U===null||U===void 0?void 0:U[z.type.name];if(B){if(K)G+=B({node:z,pos:V,parent:K,index:H,range:Z});return!1}if(z.isText)G+=(W=z===null||z===void 0?void 0:z.text)===null||W===void 0?void 0:W.slice(Math.max(J,V)-V,Y-V)}),G},$4=function(Q){return Object.fromEntries(Object.entries(Q.nodes).filter(([,Z])=>Z.spec.toText).map(([Z,X])=>[Z,X.spec.toText]))},w5=function(Q,Z,X={strict:!0}){const J=Object.keys(Z);if(!J.length)return!0;return J.every((Y)=>{if(X.strict)return Z[Y]===Q[Y];if(_7(Z[Y]))return Z[Y].test(Q[Y]);return Z[Y]===Q[Y]})},x4=function(Q,Z,X={}){return Q.find((J)=>{return J.type===Z&&w5(Object.fromEntries(Object.keys(X).map((Y)=>[Y,J.attrs[Y]])),X)})},N4=function(Q,Z,X={}){return!!x4(Q,Z,X)},I7=function(Q,Z,X){var J;if(!Q||!Z)return;let Y=Q.parent.childAfter(Q.parentOffset);if(!Y.node||!Y.node.marks.some((K)=>K.type===Z))Y=Q.parent.childBefore(Q.parentOffset);if(!Y.node||!Y.node.marks.some((K)=>K.type===Z))return;if(X=X||((J=Y.node.marks[0])===null||J===void 0?void 0:J.attrs),!x4([...Y.node.marks],Z,X))return;let U=Y.index,G=Q.start()+Y.offset,z=U+1,V=G+Y.node.nodeSize;while(U>0&&N4([...Q.parent.child(U-1).marks],Z,X))U-=1,G-=Q.parent.child(U).nodeSize;while(z<Q.parent.childCount&&N4([...Q.parent.child(z).marks],Z,X))V+=Q.parent.child(z).nodeSize,z+=1;return{from:G,to:V}},s0=function(Q,Z){if(typeof Q==="string"){if(!Z.marks[Q])throw Error(`There is no mark type named '${Q}'. Maybe you forgot to add the extension?`);return Z.marks[Q]}return Q},g4=function(Q){return Q instanceof O},z1=function(Q=0,Z=0,X=0){return Math.min(Math.max(Q,Z),X)},w4=function(Q,Z=null){if(!Z)return null;const X=N.atStart(Q),J=N.atEnd(Q);if(Z==="start"||Z===!0)return X;if(Z==="end")return J;const Y=X.from,q=J.to;if(Z==="all")return O.create(Q,z1(0,Y,q),z1(Q.content.size,Y,q));return O.create(Q,z1(Z,Y,q),z1(Z,Y,q))},BJ=function(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)},F7=function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},x5=function(Q){const Z=`<body>${Q}</body>`,X=new window.DOMParser().parseFromString(Z,"text/html").body;return u4(X)},u5=function(Q,Z,X){if(Q instanceof z0||Q instanceof P)return Q;X={slice:!0,parseOptions:{},...X};const J=typeof Q==="object"&&Q!==null,Y=typeof Q==="string";if(J)try{if(Array.isArray(Q)&&Q.length>0)return P.fromArray(Q.map((G)=>Z.nodeFromJSON(G)));const U=Z.nodeFromJSON(Q);if(X.errorOnInvalidContent)U.check();return U}catch(q){if(X.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:q});return console.warn("[tiptap warn]: Invalid content.","Passed value:",Q,"Error:",q),u5("",Z,X)}if(Y){if(X.errorOnInvalidContent){let U=!1,G="";const z=new L5({topNode:Z.spec.topNode,marks:Z.spec.marks,nodes:Z.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:(V)=>{return U=!0,G=typeof V==="string"?V:V.outerHTML,null}}]}})});if(X.slice)j0.fromSchema(z).parseSlice(x5(Q),X.parseOptions);else j0.fromSchema(z).parse(x5(Q),X.parseOptions);if(X.errorOnInvalidContent&&U)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${G}`)})}const q=j0.fromSchema(Z);if(X.slice)return q.parseSlice(x5(Q),X.parseOptions).content;return q.parse(x5(Q),X.parseOptions)}return u5("",Z,X)},PJ=function(Q,Z,X){const J=Q.steps.length-1;if(J<Z)return;const Y=Q.steps[J];if(!(Y instanceof h||Y instanceof u))return;const q=Q.mapping.maps[J];let U=0;q.forEach((G,z,V,K)=>{if(U===0)U=K}),Q.setSelection(N.near(Q.doc.resolve(U),X))},v4=function(){return typeof navigator!=="undefined"?/Mac/.test(navigator.platform):!1},kJ=function(Q){const Z=Q.split(/-(?!$)/);let X=Z[Z.length-1];if(X==="Space")X=" ";let J,Y,q,U;for(let G=0;G<Z.length-1;G+=1){const z=Z[G];if(/^(cmd|meta|m)$/i.test(z))U=!0;else if(/^a(lt)?$/i.test(z))J=!0;else if(/^(c|ctrl|control)$/i.test(z))Y=!0;else if(/^s(hift)?$/i.test(z))q=!0;else if(/^mod$/i.test(z))if(F7()||v4())U=!0;else Y=!0;else throw new Error(`Unrecognized modifier name: ${z}`)}if(J)X=`Alt-${X}`;if(Y)X=`Ctrl-${X}`;if(U)X=`Meta-${X}`;if(q)X=`Shift-${X}`;return X},Z5=function(Q,Z,X={}){const{from:J,to:Y,empty:q}=Q.selection,U=Z?a(Z,Q.schema):null,G=[];Q.doc.nodesBetween(J,Y,(H,W)=>{if(H.isText)return;const B=Math.max(J,W),L=Math.min(Y,W+H.nodeSize);G.push({node:H,from:B,to:L})});const z=Y-J,V=G.filter((H)=>{if(!U)return!0;return U.name===H.node.type.name}).filter((H)=>w5(H.node.attrs,X,{strict:!1}));if(q)return!!V.length;return V.reduce((H,W)=>H+W.to-W.from,0)>=z},m5=function(Q,Z){if(Z.nodes[Q])return"node";if(Z.marks[Q])return"mark";return null},D4=function(Q,Z){const X=typeof Z==="string"?[Z]:Z;return Object.keys(Q).reduce((J,Y)=>{if(!X.includes(Y))J[Y]=Q[Y];return J},{})},W7=function(Q,Z,X={},J={}){return u5(Q,Z,{slice:!1,parseOptions:X,errorOnInvalidContent:J.errorOnInvalidContent})},f4=function(Q,Z){const X=s0(Z,Q.schema),{from:J,to:Y,empty:q}=Q.selection,U=[];if(q){if(Q.storedMarks)U.push(...Q.storedMarks);U.push(...Q.selection.$head.marks())}else Q.doc.nodesBetween(J,Y,(z)=>{U.push(...z.marks)});const G=U.find((z)=>z.type.name===X.name);if(!G)return{};return{...G.attrs}};var pJ=function(Q){for(let Z=0;Z<Q.edgeCount;Z+=1){const{type:X}=Q.edge(Z);if(X.isTextblock&&!X.hasRequiredAttrs())return X}return null};var P7=function(Q,Z){for(let X=Q.depth;X>0;X-=1){const J=Q.node(X);if(Z(J))return{pos:X>0?Q.before(X):0,start:Q.start(X),depth:X,node:J}}},j7=function(Q){return(Z)=>P7(Z.$from,Q)};var dJ=function(Q,Z){const X={from:0,to:Q.content.size};return b4(Q,X,Z)};var iJ=function(Q,Z){const X=a(Z,Q.schema),{from:J,to:Y}=Q.selection,q=[];Q.doc.nodesBetween(J,Y,(G)=>{q.push(G)});const U=q.reverse().find((G)=>G.type.name===X.name);if(!U)return{};return{...U.attrs}},sJ=function(Q,Z){const X=m5(typeof Z==="string"?Z:Z.name,Q.schema);if(X==="node")return iJ(Q,Z);if(X==="mark")return f4(Q,Z);return{}};var h4=function(Q,Z,X){const J=[];if(Q===Z)X.resolve(Q).marks().forEach((Y)=>{const q=X.resolve(Q),U=I7(q,Y.type);if(!U)return;J.push({mark:Y,...U})});else X.nodesBetween(Q,Z,(Y,q)=>{if(!Y||(Y===null||Y===void 0?void 0:Y.nodeSize)===void 0)return;J.push(...Y.marks.map((U)=>({from:q,to:q+Y.nodeSize,mark:U})))});return J},g5=function(Q,Z,X){return Object.fromEntries(Object.entries(X).filter(([J])=>{const Y=Q.find((q)=>{return q.type===Z&&q.name===J});if(!Y)return!1;return Y.attribute.keepOnSplit}))},L7=function(Q,Z,X={}){const{empty:J,ranges:Y}=Q.selection,q=Z?s0(Z,Q.schema):null;if(J)return!!(Q.storedMarks||Q.selection.$from.marks()).filter((H)=>{if(!q)return!0;return q.name===H.type.name}).find((H)=>w5(H.attrs,X,{strict:!1}));let U=0;const G=[];if(Y.forEach(({$from:H,$to:W})=>{const B=H.pos,L=W.pos;Q.doc.nodesBetween(B,L,(_,I)=>{if(!_.isText&&!_.marks.length)return;const F=Math.max(B,I),E=Math.min(L,I+_.nodeSize),M=E-F;U+=M,G.push(..._.marks.map(($)=>({mark:$,from:F,to:E})))})}),U===0)return!1;const z=G.filter((H)=>{if(!q)return!0;return q.name===H.mark.type.name}).filter((H)=>w5(H.mark.attrs,X,{strict:!1})).reduce((H,W)=>H+W.to-W.from,0),V=G.filter((H)=>{if(!q)return!0;return H.mark.type!==q&&H.mark.type.excludes(q)}).reduce((H,W)=>H+W.to-W.from,0);return(z>0?z+V:z)>=U},aJ=function(Q,Z,X={}){if(!Z)return Z5(Q,null,X)||L7(Q,null,X);const J=m5(Z,Q.schema);if(J==="node")return Z5(Q,Z,X);if(J==="mark")return L7(Q,Z,X);return!1},M4=function(Q,Z){const{nodeExtensions:X}=f5(Z),J=X.find((U)=>U.name===Q);if(!J)return!1;const Y={name:J.name,options:J.options,storage:J.storage},q=T(A(J,"group",Y));if(typeof q!=="string")return!1;return q.split(" ").includes("list")},E7=function(Q,{checkChildren:Z=!0,ignoreWhitespace:X=!1}={}){var J;if(X){if(Q.type.name==="hardBreak")return!0;if(Q.isText)return/^\s*$/m.test((J=Q.text)!==null&&J!==void 0?J:"")}if(Q.isText)return!Q.text;if(Q.isAtom||Q.isLeaf)return!1;if(Q.content.childCount===0)return!0;if(Z){let Y=!0;return Q.content.forEach((q)=>{if(Y===!1)return;if(!E7(q,{ignoreWhitespace:X,checkChildren:Z}))Y=!1}),Y}return!1},m4=function(Q){return Q instanceof R};var nJ=function(Q,Z,X){var J;const{selection:Y}=Z;let q=null;if(g4(Y))q=Y.$cursor;if(q){const G=(J=Q.storedMarks)!==null&&J!==void 0?J:q.marks();return!!X.isInSet(G)||!G.some((z)=>z.type.excludes(X))}const{ranges:U}=Y;return U.some(({$from:G,$to:z})=>{let V=G.depth===0?Q.doc.inlineContent&&Q.doc.type.allowsMarkType(X):!1;return Q.doc.nodesBetween(G.pos,z.pos,(K,H,W)=>{if(V)return!1;if(K.isInline){const B=!W||W.type.allowsMarkType(X),L=!!X.isInSet(K.marks)||!K.marks.some((_)=>_.type.excludes(X));V=B&&L}return!V}),V})},C4=function(Q,Z){const X=Q.storedMarks||Q.selection.$to.parentOffset&&Q.selection.$from.marks();if(X){const J=X.filter((Y)=>Z===null||Z===void 0?void 0:Z.includes(Y.type.name));Q.tr.ensureMarks(J)}},RY=function(Q,Z,X){const J=document.querySelector(`style[data-tiptap-style${X?`-${X}`:""}]`);if(J!==null)return J;const Y=document.createElement("style");if(Z)Y.setAttribute("nonce",Z);return Y.setAttribute(`data-tiptap-style${X?`-${X}`:""}`,""),Y.innerHTML=Q,document.getElementsByTagName("head")[0].appendChild(Y),Y},R0=function(Q){return new J5({find:Q.find,handler:({state:Z,range:X,match:J})=>{const Y=T(Q.getAttributes,void 0,J);if(Y===!1||Y===null)return null;const{tr:q}=Z,U=J[J.length-1],G=J[0];if(U){const z=G.search(/\S/),V=X.from+G.indexOf(U),K=V+U.length;if(h4(X.from,X.to,Z.doc).filter((B)=>{return B.mark.type.excluded.find((_)=>_===Q.type&&_!==B.mark.type)}).filter((B)=>B.to>V).length)return null;if(K<X.to)q.delete(K,X.to);if(V>X.from)q.delete(X.from+z,V);const W=X.from+z+U.length;q.addMark(X.from+z,W,Q.type.create(Y||{})),q.removeStoredMark(Q.type)}}})},l5=function(Q){return new J5({find:Q.find,handler:({state:Z,range:X,match:J})=>{const Y=T(Q.getAttributes,void 0,J)||{},{tr:q}=Z,U=X.from;let G=X.to;const z=Q.type.create(Y);if(J[1]){const V=J[0].lastIndexOf(J[1]);let K=U+V;if(K>G)K=G;else G=K+J[1].length;const H=J[0][J[0].length-1];q.insertText(H,U+J[0].length-1),q.replaceWith(K,G,z)}else if(J[0]){const V=Q.type.isInline?U:U-1;q.insert(V,Q.type.create(Y)).delete(q.mapping.map(U),q.mapping.map(G))}q.scrollIntoView()}})},Y5=function(Q){return new J5({find:Q.find,handler:({state:Z,range:X,match:J})=>{const Y=Z.doc.resolve(X.from),q=T(Q.getAttributes,void 0,J)||{};if(!Y.node(-1).canReplaceWith(Y.index(-1),Y.indexAfter(-1),Q.type))return null;Z.tr.delete(X.from,X.to).setBlockType(X.from,X.from,Q.type,q)}})};var a0=function(Q){return new J5({find:Q.find,handler:({state:Z,range:X,match:J,chain:Y})=>{const q=T(Q.getAttributes,void 0,J)||{},U=Z.tr.delete(X.from,X.to),z=U.doc.resolve(X.from).blockRange(),V=z&&P1(z,Q.type,q);if(!V)return null;if(U.wrap(z,V),Q.keepMarks&&Q.editor){const{selection:H,storedMarks:W}=Z,{splittableMarks:B}=Q.editor.extensionManager,L=W||H.$to.parentOffset&&H.$from.marks();if(L){const _=L.filter((I)=>B.includes(I.type.name));U.ensureMarks(_)}}if(Q.keepAttributes){const H=Q.type.name==="bulletList"||Q.type.name==="orderedList"?"listItem":"taskList";Y().updateAttributes(H,q).run()}const K=U.doc.resolve(X.from-1).nodeBefore;if(K&&K.type===Q.type&&_0(U.doc,X.from-1)&&(!Q.joinPredicate||Q.joinPredicate(J,K)))U.join(X.from-1)}})},N0=function(Q){return new y4({find:Q.find,handler:({state:Z,range:X,match:J,pasteEvent:Y})=>{const q=T(Q.getAttributes,void 0,J,Y);if(q===!1||q===null)return null;const{tr:U}=Z,G=J[J.length-1],z=J[0];let V=X.to;if(G){const K=z.search(/\S/),H=X.from+z.indexOf(G),W=H+G.length;if(h4(X.from,X.to,Z.doc).filter((L)=>{return L.mark.type.excluded.find((I)=>I===Q.type&&I!==L.mark.type)}).filter((L)=>L.to>H).length)return null;if(W<X.to)U.delete(W,X.to);if(H>X.from)U.delete(X.from+K,H);V=X.from+K+G.length,U.addMark(X.from+K,V,Q.type.create(q||{})),U.removeStoredMark(Q.type)}}})};class X5{constructor(Q){this.editor=Q.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=Q.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:Q,editor:Z,state:X}=this,{view:J}=Z,{tr:Y}=X,q=this.buildProps(Y);return Object.fromEntries(Object.entries(Q).map(([U,G])=>{return[U,(...V)=>{const K=G(...V)(q);if(!Y.getMeta("preventDispatch")&&!this.hasCustomState)J.dispatch(Y);return K}]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(Q,Z=!0){const{rawCommands:X,editor:J,state:Y}=this,{view:q}=J,U=[],G=!!Q,z=Q||Y.tr,V=()=>{if(!G&&Z&&!z.getMeta("preventDispatch")&&!this.hasCustomState)q.dispatch(z);return U.every((H)=>H===!0)},K={...Object.fromEntries(Object.entries(X).map(([H,W])=>{return[H,(...L)=>{const _=this.buildProps(z,Z),I=W(...L)(_);return U.push(I),K}]})),run:V};return K}createCan(Q){const{rawCommands:Z,state:X}=this,Y=Q||X.tr,q=this.buildProps(Y,!1);return{...Object.fromEntries(Object.entries(Z).map(([G,z])=>{return[G,(...V)=>z(...V)({...q,dispatch:void 0})]})),chain:()=>this.createChain(Y,!1)}}buildProps(Q,Z=!0){const{rawCommands:X,editor:J,state:Y}=this,{view:q}=J,U={tr:Q,editor:J,view:q,state:v5({state:Y,transaction:Q}),dispatch:Z?()=>{return}:void 0,chain:()=>this.createChain(Q,Z),can:()=>this.createCan(Q),get commands(){return Object.fromEntries(Object.entries(X).map(([G,z])=>{return[G,(...V)=>z(...V)(U)]}))}};return U}}class T4{constructor(){this.callbacks={}}on(Q,Z){if(!this.callbacks[Q])this.callbacks[Q]=[];return this.callbacks[Q].push(Z),this}emit(Q,...Z){const X=this.callbacks[Q];if(X)X.forEach((J)=>J.apply(this,Z));return this}off(Q,Z){const X=this.callbacks[Q];if(X)if(Z)this.callbacks[Q]=X.filter((J)=>J!==Z);else delete this.callbacks[Q];return this}once(Q,Z){const X=(...J)=>{this.off(Q,X),Z.apply(this,J)};return this.on(Q,X)}removeAllListeners(){this.callbacks={}}}var cX=(Q,Z=500)=>{let X="";const J=Q.parentOffset;return Q.parent.nodesBetween(Math.max(0,J-Z),J,(Y,q,U,G)=>{var z,V;const K=((V=(z=Y.type.spec).toText)===null||V===void 0?void 0:V.call(z,{node:Y,pos:q,parent:U,index:G}))||Y.textContent||"%leaf%";X+=Y.isAtom&&!Y.isText?K:K.slice(0,Math.max(0,J-q))}),X};class J5{constructor(Q){this.find=Q.find,this.handler=Q.handler}}var pX=(Q,Z)=>{if(_7(Z))return Z.exec(Q);const X=Z(Q);if(!X)return null;const J=[X.text];if(J.index=X.index,J.input=Q,J.data=X.data,X.replaceWith){if(!X.text.includes(X.replaceWith))console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".');J.push(X.replaceWith)}return J};class G0{constructor(Q={}){if(this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...Q},this.name=this.config.name,Q.defaultOptions&&Object.keys(Q.defaultOptions).length>0)console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`);if(this.options=this.config.defaultOptions,this.config.addOptions)this.options=T(A(this,"addOptions",{name:this.name}));this.storage=T(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(Q={}){return new G0(Q)}configure(Q={}){const Z=this.extend({...this.config,addOptions:()=>{return h5(this.options,Q)}});return Z.name=this.name,Z.parent=this.parent,Z}extend(Q={}){const Z=new G0(Q);if(Z.parent=this,this.child=Z,Z.name=Q.name?Q.name:Z.parent.name,Q.defaultOptions&&Object.keys(Q.defaultOptions).length>0)console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${Z.name}".`);return Z.options=T(A(Z,"addOptions",{name:Z.name})),Z.storage=T(A(Z,"addStorage",{name:Z.name,options:Z.options})),Z}static handleExit({editor:Q,mark:Z}){const{tr:X}=Q.state,J=Q.state.selection.$from;if(J.pos===J.end()){const q=J.marks();if(!q.find((z)=>(z===null||z===void 0?void 0:z.type.name)===Z.name))return!1;const G=q.find((z)=>(z===null||z===void 0?void 0:z.type.name)===Z.name);if(G)X.removeStoredMark(G);return X.insertText(" ",J.pos),Q.view.dispatch(X),!0}return!1}}class y4{constructor(Q){this.find=Q.find,this.handler=Q.handler}}var aX=(Q,Z,X)=>{if(_7(Z))return[...Q.matchAll(Z)];const J=Z(Q,X);if(!J)return[];return J.map((Y)=>{const q=[Y.text];if(q.index=Y.index,q.input=Q,q.data=Y.data,Y.replaceWith){if(!Y.text.includes(Y.replaceWith))console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".');q.push(Y.replaceWith)}return q})},$5=null,rX=(Q)=>{var Z;const X=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(Z=X.clipboardData)===null||Z===void 0||Z.setData("text/html",Q),X};class y1{constructor(Q,Z){this.splittableMarks=[],this.editor=Z,this.extensions=y1.resolve(Q),this.schema=lX(this.extensions,Z),this.setupExtensions()}static resolve(Q){const Z=y1.sort(y1.flatten(Q)),X=tX(Z.map((J)=>J.name));if(X.length)console.warn(`[tiptap warn]: Duplicate extension names found: [${X.map((J)=>`'${J}'`).join(", ")}]. This can lead to issues.`);return Z}static flatten(Q){return Q.map((Z)=>{const X={name:Z.name,options:Z.options,storage:Z.storage},J=A(Z,"addExtensions",X);if(J)return[Z,...this.flatten(J())];return Z}).flat(10)}static sort(Q){return Q.sort((X,J)=>{const Y=A(X,"priority")||100,q=A(J,"priority")||100;if(Y>q)return-1;if(Y<q)return 1;return 0})}get commands(){return this.extensions.reduce((Q,Z)=>{const X={name:Z.name,options:Z.options,storage:Z.storage,editor:this.editor,type:z7(Z.name,this.schema)},J=A(Z,"addCommands",X);if(!J)return Q;return{...Q,...J()}},{})}get plugins(){const{editor:Q}=this,Z=y1.sort([...this.extensions].reverse()),X=[],J=[],Y=Z.map((q)=>{const U={name:q.name,options:q.options,storage:q.storage,editor:Q,type:z7(q.name,this.schema)},G=[],z=A(q,"addKeyboardShortcuts",U);let V={};if(q.type==="mark"&&A(q,"exitable",U))V.ArrowRight=()=>G0.handleExit({editor:Q,mark:q});if(z){const L=Object.fromEntries(Object.entries(z()).map(([_,I])=>{return[_,()=>I({editor:Q})]}));V={...V,...L}}const K=Y4(V);G.push(K);const H=A(q,"addInputRules",U);if(R4(q,Q.options.enableInputRules)&&H)X.push(...H());const W=A(q,"addPasteRules",U);if(R4(q,Q.options.enablePasteRules)&&W)J.push(...W());const B=A(q,"addProseMirrorPlugins",U);if(B){const L=B();G.push(...L)}return G}).flat();return[dX({editor:Q,rules:X}),...oX({editor:Q,rules:J}),...Y]}get attributes(){return k4(this.extensions)}get nodeViews(){const{editor:Q}=this,{nodeExtensions:Z}=f5(this.extensions);return Object.fromEntries(Z.filter((X)=>!!A(X,"addNodeView")).map((X)=>{const J=this.attributes.filter((G)=>G.type===X.name),Y={name:X.name,options:X.options,storage:X.storage,editor:Q,type:a(X.name,this.schema)},q=A(X,"addNodeView",Y);if(!q)return[];const U=(G,z,V,K,H)=>{const W=H7(G,J);return q()({node:G,view:z,getPos:V,decorations:K,innerDecorations:H,editor:Q,extension:X,HTMLAttributes:W})};return[X.name,U]}))}setupExtensions(){this.extensions.forEach((Q)=>{var Z;this.editor.extensionStorage[Q.name]=Q.storage;const X={name:Q.name,options:Q.options,storage:Q.storage,editor:this.editor,type:z7(Q.name,this.schema)};if(Q.type==="mark"){if((Z=T(A(Q,"keepOnSplit",X)))!==null&&Z!==void 0?Z:!0)this.splittableMarks.push(Q.name)}const J=A(Q,"onBeforeCreate",X),Y=A(Q,"onCreate",X),q=A(Q,"onUpdate",X),U=A(Q,"onSelectionUpdate",X),G=A(Q,"onTransaction",X),z=A(Q,"onFocus",X),V=A(Q,"onBlur",X),K=A(Q,"onDestroy",X);if(J)this.editor.on("beforeCreate",J);if(Y)this.editor.on("create",Y);if(q)this.editor.on("update",q);if(U)this.editor.on("selectionUpdate",U);if(G)this.editor.on("transaction",G);if(z)this.editor.on("focus",z);if(V)this.editor.on("blur",V);if(K)this.editor.on("destroy",K)})}}class i{constructor(Q={}){if(this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...Q},this.name=this.config.name,Q.defaultOptions&&Object.keys(Q.defaultOptions).length>0)console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`);if(this.options=this.config.defaultOptions,this.config.addOptions)this.options=T(A(this,"addOptions",{name:this.name}));this.storage=T(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(Q={}){return new i(Q)}configure(Q={}){const Z=this.extend({...this.config,addOptions:()=>{return h5(this.options,Q)}});return Z.name=this.name,Z.parent=this.parent,Z}extend(Q={}){const Z=new i({...this.config,...Q});if(Z.parent=this,this.child=Z,Z.name=Q.name?Q.name:Z.parent.name,Q.defaultOptions&&Object.keys(Q.defaultOptions).length>0)console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${Z.name}".`);return Z.options=T(A(Z,"addOptions",{name:Z.name})),Z.storage=T(A(Z,"addStorage",{name:Z.name,options:Z.options})),Z}}var eX=i.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new g({key:new c("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:Q}=this,{state:Z,schema:X}=Q,{doc:J,selection:Y}=Z,{ranges:q}=Y,U=Math.min(...q.map((K)=>K.$from.pos)),G=Math.max(...q.map((K)=>K.$to.pos)),z=$4(X);return b4(J,{from:U,to:G},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:z})}}})]}}),QJ=()=>({editor:Q,view:Z})=>{return requestAnimationFrame(()=>{var X;if(!Q.isDestroyed)Z.dom.blur(),(X=window===null||window===void 0?void 0:window.getSelection())===null||X===void 0||X.removeAllRanges()}),!0},ZJ=(Q=!1)=>({commands:Z})=>{return Z.setContent("",Q)},XJ=()=>({state:Q,tr:Z,dispatch:X})=>{const{selection:J}=Z,{ranges:Y}=J;if(!X)return!0;return Y.forEach(({$from:q,$to:U})=>{Q.doc.nodesBetween(q.pos,U.pos,(G,z)=>{if(G.type.isText)return;const{doc:V,mapping:K}=Z,H=V.resolve(K.map(z)),W=V.resolve(K.map(z+G.nodeSize)),B=H.blockRange(W);if(!B)return;const L=T0(B);if(G.type.isTextblock){const{defaultType:_}=H.parent.contentMatchAt(H.index());Z.setNodeMarkup(B.start,_)}if(L||L===0)Z.lift(B,L)})}),!0},JJ=(Q)=>(Z)=>{return Q(Z)},YJ=()=>({state:Q,dispatch:Z})=>{return X7(Q,Z)},qJ=(Q,Z)=>({editor:X,tr:J})=>{const{state:Y}=X,q=Y.doc.slice(Q.from,Q.to);J.deleteRange(Q.from,Q.to);const U=J.mapping.map(Z);return J.insert(U,q.content),J.setSelection(new O(J.doc.resolve(U-1))),!0},UJ=()=>({tr:Q,dispatch:Z})=>{const{selection:X}=Q,J=X.$anchor.node();if(J.content.size>0)return!1;const Y=Q.selection.$anchor;for(let q=Y.depth;q>0;q-=1)if(Y.node(q).type===J.type){if(Z){const G=Y.before(q),z=Y.after(q);Q.delete(G,z).scrollIntoView()}return!0}return!1},GJ=(Q)=>({tr:Z,state:X,dispatch:J})=>{const Y=a(Q,X.schema),q=Z.selection.$anchor;for(let U=q.depth;U>0;U-=1)if(q.node(U).type===Y){if(J){const z=q.before(U),V=q.after(U);Z.delete(z,V).scrollIntoView()}return!0}return!1},zJ=(Q)=>({tr:Z,dispatch:X})=>{const{from:J,to:Y}=Q;if(X)Z.delete(J,Y);return!0},VJ=()=>({state:Q,dispatch:Z})=>{return S5(Q,Z)},KJ=()=>({commands:Q})=>{return Q.keyboardShortcut("Enter")},HJ=()=>({state:Q,dispatch:Z})=>{return Z7(Q,Z)},WJ=(Q,Z={})=>({tr:X,state:J,dispatch:Y})=>{const q=s0(Q,J.schema),{doc:U,selection:G}=X,{$from:z,from:V,to:K}=G;if(Y){const H=I7(z,q,Z);if(H&&H.from<=V&&H.to>=K){const W=O.create(U,H.from,H.to);X.setSelection(W)}}return!0},LJ=(Q)=>(Z)=>{const X=typeof Q==="function"?Q(Z):Q;for(let J=0;J<X.length;J+=1)if(X[J](Z))return!0;return!1},_J=(Q=null,Z={})=>({editor:X,view:J,tr:Y,dispatch:q})=>{Z={scrollIntoView:!0,...Z};const U=()=>{if(F7()||BJ())J.dom.focus();requestAnimationFrame(()=>{if(!X.isDestroyed){if(J.focus(),Z===null||Z===void 0?void 0:Z.scrollIntoView)X.commands.scrollIntoView()}})};if(J.hasFocus()&&Q===null||Q===!1)return!0;if(q&&Q===null&&!g4(X.state.selection))return U(),!0;const G=w4(Y.doc,Q)||X.state.selection,z=X.state.selection.eq(G);if(q){if(!z)Y.setSelection(G);if(z&&Y.storedMarks)Y.setStoredMarks(Y.storedMarks);U()}return!0},IJ=(Q,Z)=>(X)=>{return Q.every((J,Y)=>Z(J,{...X,index:Y}))},FJ=(Q,Z)=>({tr:X,commands:J})=>{return J.insertContentAt({from:X.selection.from,to:X.selection.to},Q,Z)},u4=(Q)=>{const Z=Q.childNodes;for(let X=Z.length-1;X>=0;X-=1){const J=Z[X];if(J.nodeType===3&&J.nodeValue&&/^(\n\s\s|\n)$/.test(J.nodeValue))Q.removeChild(J);else if(J.nodeType===1)u4(J)}return Q},jJ=(Q)=>{return!("type"in Q)},EJ=(Q,Z,X)=>({tr:J,dispatch:Y,editor:q})=>{var U;if(Y){X={parseOptions:q.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...X};let G;try{G=u5(Z,q.schema,{parseOptions:{preserveWhitespace:"full",...X.parseOptions},errorOnInvalidContent:(U=X.errorOnInvalidContent)!==null&&U!==void 0?U:q.options.enableContentCheck})}catch(L){return q.emit("contentError",{editor:q,error:L,disableCollaboration:()=>{if(q.storage.collaboration)q.storage.collaboration.isDisabled=!0}}),!1}let{from:z,to:V}=typeof Q==="number"?{from:Q,to:Q}:{from:Q.from,to:Q.to},K=!0,H=!0;if((jJ(G)?G:[G]).forEach((L)=>{L.check(),K=K?L.isText&&L.marks.length===0:!1,H=H?L.isBlock:!1}),z===V&&H){const{parent:L}=J.doc.resolve(z);if(L.isTextblock&&!L.type.spec.code&&!L.childCount)z-=1,V+=1}let B;if(K){if(Array.isArray(Z))B=Z.map((L)=>L.text||"").join("");else if(Z instanceof P){let L="";Z.forEach((_)=>{if(_.text)L+=_.text}),B=L}else if(typeof Z==="object"&&!!Z&&!!Z.text)B=Z.text;else B=Z;J.insertText(B,z,V)}else B=G,J.replaceWith(z,V,B);if(X.updateSelection)PJ(J,J.steps.length-1,-1);if(X.applyInputRules)J.setMeta("applyInputRules",{from:z,text:B});if(X.applyPasteRules)J.setMeta("applyPasteRules",{from:z,text:B})}return!0},AJ=()=>({state:Q,dispatch:Z})=>{return H4(Q,Z)},OJ=()=>({state:Q,dispatch:Z})=>{return W4(Q,Z)},RJ=()=>({state:Q,dispatch:Z})=>{return s6(Q,Z)},NJ=()=>({state:Q,dispatch:Z})=>{return r6(Q,Z)},DJ=()=>({state:Q,dispatch:Z,tr:X})=>{try{const J=j1(Q.doc,Q.selection.$from.pos,-1);if(J===null||J===void 0)return!1;if(X.join(J,2),Z)Z(X);return!0}catch{return!1}},MJ=()=>({state:Q,dispatch:Z,tr:X})=>{try{const J=j1(Q.doc,Q.selection.$from.pos,1);if(J===null||J===void 0)return!1;if(X.join(J,2),Z)Z(X);return!0}catch{return!1}},CJ=()=>({state:Q,dispatch:Z})=>{return G4(Q,Z)},TJ=()=>({state:Q,dispatch:Z})=>{return z4(Q,Z)},SJ=(Q)=>({editor:Z,view:X,tr:J,dispatch:Y})=>{const q=kJ(Q).split(/-(?!$)/),U=q.find((V)=>!["Alt","Ctrl","Meta","Shift"].includes(V)),G=new KeyboardEvent("keydown",{key:U==="Space"?" ":U,altKey:q.includes("Alt"),ctrlKey:q.includes("Ctrl"),metaKey:q.includes("Meta"),shiftKey:q.includes("Shift"),bubbles:!0,cancelable:!0}),z=Z.captureTransaction(()=>{X.someProp("handleKeyDown",(V)=>V(X,G))});return z===null||z===void 0||z.steps.forEach((V)=>{const K=V.map(J.mapping);if(K&&Y)J.maybeStep(K)}),!0},yJ=(Q,Z={})=>({state:X,dispatch:J})=>{const Y=a(Q,X.schema);if(!Z5(X,Y,Z))return!1;return L4(X,J)},bJ=()=>({state:Q,dispatch:Z})=>{return J7(Q,Z)},$J=(Q)=>({state:Z,dispatch:X})=>{const J=a(Q,Z.schema);return j4(J)(Z,X)},xJ=()=>({state:Q,dispatch:Z})=>{return e6(Q,Z)},gJ=(Q,Z)=>({tr:X,state:J,dispatch:Y})=>{let q=null,U=null;const G=m5(typeof Q==="string"?Q:Q.name,J.schema);if(!G)return!1;if(G==="node")q=a(Q,J.schema);if(G==="mark")U=s0(Q,J.schema);if(Y)X.selection.ranges.forEach((z)=>{J.doc.nodesBetween(z.$from.pos,z.$to.pos,(V,K)=>{if(q&&q===V.type)X.setNodeMarkup(K,void 0,D4(V.attrs,Z));if(U&&V.marks.length)V.marks.forEach((H)=>{if(U===H.type)X.addMark(K,K+V.nodeSize,U.create(D4(H.attrs,Z)))})})});return!0},wJ=()=>({tr:Q,dispatch:Z})=>{if(Z)Q.scrollIntoView();return!0},uJ=()=>({tr:Q,dispatch:Z})=>{if(Z){const X=new r(Q.doc);Q.setSelection(X)}return!0},vJ=()=>({state:Q,dispatch:Z})=>{return a6(Q,Z)},fJ=()=>({state:Q,dispatch:Z})=>{return o6(Q,Z)},hJ=()=>({state:Q,dispatch:Z})=>{return B4(Q,Z)},mJ=()=>({state:Q,dispatch:Z})=>{return q7(Q,Z)},lJ=()=>({state:Q,dispatch:Z})=>{return Y7(Q,Z)},cJ=(Q,Z=!1,X={},J={})=>({editor:Y,tr:q,dispatch:U,commands:G})=>{var z,V;const{doc:K}=q;if(X.preserveWhitespace!=="full"){const H=W7(Q,Y.schema,X,{errorOnInvalidContent:(z=J.errorOnInvalidContent)!==null&&z!==void 0?z:Y.options.enableContentCheck});if(U)q.replaceWith(0,K.content.size,H).setMeta("preventUpdate",!Z);return!0}if(U)q.setMeta("preventUpdate",!Z);return G.insertContentAt({from:0,to:K.content.size},Q,{parseOptions:X,errorOnInvalidContent:(V=J.errorOnInvalidContent)!==null&&V!==void 0?V:Y.options.enableContentCheck})};var rJ=(Q,Z={})=>({tr:X,state:J,dispatch:Y})=>{const{selection:q}=X,{empty:U,ranges:G}=q,z=s0(Q,J.schema);if(Y)if(U){const V=f4(J,z);X.addStoredMark(z.create({...V,...Z}))}else G.forEach((V)=>{const K=V.$from.pos,H=V.$to.pos;J.doc.nodesBetween(K,H,(W,B)=>{const L=Math.max(B,K),_=Math.min(B+W.nodeSize,H);if(W.marks.find((F)=>F.type===z))W.marks.forEach((F)=>{if(z===F.type)X.addMark(L,_,z.create({...F.attrs,...Z}))});else X.addMark(L,_,z.create(Z))})});return nJ(J,X,z)},oJ=(Q,Z)=>({tr:X})=>{return X.setMeta(Q,Z),!0},tJ=(Q,Z={})=>({state:X,dispatch:J,chain:Y})=>{const q=a(Q,X.schema);let U;if(X.selection.$anchor.sameParent(X.selection.$head))U=X.selection.$anchor.parent.attrs;if(!q.isTextblock)return console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1;return Y().command(({commands:G})=>{if(U7(q,{...U,...Z})(X))return!0;return G.clearNodes()}).command(({state:G})=>{return U7(q,{...U,...Z})(G,J)}).run()},eJ=(Q)=>({tr:Z,dispatch:X})=>{if(X){const{doc:J}=Z,Y=z1(Q,0,J.content.size),q=R.create(J,Y);Z.setSelection(q)}return!0},QY=(Q)=>({tr:Z,dispatch:X})=>{if(X){const{doc:J}=Z,{from:Y,to:q}=typeof Q==="number"?{from:Q,to:Q}:Q,U=O.atStart(J).from,G=O.atEnd(J).to,z=z1(Y,U,G),V=z1(q,U,G),K=O.create(J,z,V);Z.setSelection(K)}return!0},ZY=(Q)=>({state:Z,dispatch:X})=>{const J=a(Q,Z.schema);return E4(J)(Z,X)},XY=({keepMarks:Q=!0}={})=>({tr:Z,state:X,dispatch:J,editor:Y})=>{const{selection:q,doc:U}=Z,{$from:G,$to:z}=q,V=Y.extensionManager.attributes,K=g5(V,G.node().type.name,G.node().attrs);if(q instanceof R&&q.node.isBlock){if(!G.parentOffset||!H0(U,G.pos))return!1;if(J){if(Q)C4(X,Y.extensionManager.splittableMarks);Z.split(G.pos).scrollIntoView()}return!0}if(!G.parent.isBlock)return!1;const H=z.parentOffset===z.parent.content.size,W=G.depth===0?void 0:pJ(G.node(-1).contentMatchAt(G.indexAfter(-1)));let B=H&&W?[{type:W,attrs:K}]:void 0,L=H0(Z.doc,Z.mapping.map(G.pos),1,B);if(!B&&!L&&H0(Z.doc,Z.mapping.map(G.pos),1,W?[{type:W}]:void 0))L=!0,B=W?[{type:W,attrs:K}]:void 0;if(J){if(L){if(q instanceof O)Z.deleteSelection();if(Z.split(Z.mapping.map(G.pos),1,B),W&&!H&&!G.parentOffset&&G.parent.type!==W){const _=Z.mapping.map(G.before()),I=Z.doc.resolve(_);if(G.node(-1).canReplaceWith(I.index(),I.index()+1,W))Z.setNodeMarkup(Z.mapping.map(G.before()),W)}}if(Q)C4(X,Y.extensionManager.splittableMarks);Z.scrollIntoView()}return L},JY=(Q,Z={})=>({tr:X,state:J,dispatch:Y,editor:q})=>{var U;const G=a(Q,J.schema),{$from:z,$to:V}=J.selection,K=J.selection.node;if(K&&K.isBlock||z.depth<2||!z.sameParent(V))return!1;const H=z.node(-1);if(H.type!==G)return!1;const W=q.extensionManager.attributes;if(z.parent.content.size===0&&z.node(-1).childCount===z.indexAfter(-1)){if(z.depth===2||z.node(-3).type!==G||z.index(-2)!==z.node(-2).childCount-1)return!1;if(Y){let F=P.empty;const E=z.index(-1)?1:z.index(-2)?2:3;for(let d=z.depth-E;d>=z.depth-3;d-=1)F=P.from(z.node(d).copy(F));const M=z.indexAfter(-1)<z.node(-2).childCount?1:z.indexAfter(-2)<z.node(-3).childCount?2:3,$={...g5(W,z.node().type.name,z.node().attrs),...Z},k=((U=G.contentMatch.defaultType)===null||U===void 0?void 0:U.createAndFill($))||void 0;F=F.append(P.from(G.createAndFill(null,k)||void 0));const y=z.before(z.depth-(E-1));X.replace(y,z.after(-M),new j(F,4-E,0));let m=-1;if(X.doc.nodesBetween(y,X.doc.content.size,(d,S)=>{if(m>-1)return!1;if(d.isTextblock&&d.content.size===0)m=S+1}),m>-1)X.setSelection(O.near(X.doc.resolve(m)));X.scrollIntoView()}return!0}const B=V.pos===z.end()?H.contentMatchAt(0).defaultType:null,L={...g5(W,H.type.name,H.attrs),...Z},_={...g5(W,z.node().type.name,z.node().attrs),...Z};X.delete(z.pos,V.pos);const I=B?[{type:G,attrs:L},{type:B,attrs:_}]:[{type:G,attrs:L}];if(!H0(X.doc,z.pos,2))return!1;if(Y){const{selection:F,storedMarks:E}=J,{splittableMarks:M}=q.extensionManager,$=E||F.$to.parentOffset&&F.$from.marks();if(X.split(z.pos,2,I).scrollIntoView(),!$||!Y)return!0;const k=$.filter((y)=>M.includes(y.type.name));X.ensureMarks(k)}return!0},V7=(Q,Z)=>{const X=j7((U)=>U.type===Z)(Q.selection);if(!X)return!0;const J=Q.doc.resolve(Math.max(0,X.pos-1)).before(X.depth);if(J===void 0)return!0;const Y=Q.doc.nodeAt(J);if(!(X.node.type===(Y===null||Y===void 0?void 0:Y.type)&&_0(Q.doc,X.pos)))return!0;return Q.join(X.pos),!0},K7=(Q,Z)=>{const X=j7((U)=>U.type===Z)(Q.selection);if(!X)return!0;const J=Q.doc.resolve(X.start).after(X.depth);if(J===void 0)return!0;const Y=Q.doc.nodeAt(J);if(!(X.node.type===(Y===null||Y===void 0?void 0:Y.type)&&_0(Q.doc,J)))return!0;return Q.join(J),!0},YY=(Q,Z,X,J={})=>({editor:Y,tr:q,state:U,dispatch:G,chain:z,commands:V,can:K})=>{const{extensions:H,splittableMarks:W}=Y.extensionManager,B=a(Q,U.schema),L=a(Z,U.schema),{selection:_,storedMarks:I}=U,{$from:F,$to:E}=_,M=F.blockRange(E),$=I||_.$to.parentOffset&&_.$from.marks();if(!M)return!1;const k=j7((y)=>M4(y.type.name,H))(_);if(M.depth>=1&&k&&M.depth-k.depth<=1){if(k.node.type===B)return V.liftListItem(L);if(M4(k.node.type.name,H)&&B.validContent(k.node.content)&&G)return z().command(()=>{return q.setNodeMarkup(k.pos,B),!0}).command(()=>V7(q,B)).command(()=>K7(q,B)).run()}if(!X||!$||!G)return z().command(()=>{if(K().wrapInList(B,J))return!0;return V.clearNodes()}).wrapInList(B,J).command(()=>V7(q,B)).command(()=>K7(q,B)).run();return z().command(()=>{const y=K().wrapInList(B,J),m=$.filter((d)=>W.includes(d.type.name));if(q.ensureMarks(m),y)return!0;return V.clearNodes()}).wrapInList(B,J).command(()=>V7(q,B)).command(()=>K7(q,B)).run()},qY=(Q,Z={},X={})=>({state:J,commands:Y})=>{const{extendEmptyMarkRange:q=!1}=X,U=s0(Q,J.schema);if(L7(J,U,Z))return Y.unsetMark(U,{extendEmptyMarkRange:q});return Y.setMark(U,Z)},UY=(Q,Z,X={})=>({state:J,commands:Y})=>{const q=a(Q,J.schema),U=a(Z,J.schema),G=Z5(J,q,X);let z;if(J.selection.$anchor.sameParent(J.selection.$head))z=J.selection.$anchor.parent.attrs;if(G)return Y.setNode(U,z);return Y.setNode(q,{...z,...X})},GY=(Q,Z={})=>({state:X,commands:J})=>{const Y=a(Q,X.schema);if(Z5(X,Y,Z))return J.lift(Y);return J.wrapIn(Y,Z)},zY=()=>({state:Q,dispatch:Z})=>{const X=Q.plugins;for(let J=0;J<X.length;J+=1){const Y=X[J];let q;if(Y.spec.isInputRules&&(q=Y.getState(Q))){if(Z){const U=Q.tr,G=q.transform;for(let z=G.steps.length-1;z>=0;z-=1)U.step(G.steps[z].invert(G.docs[z]));if(q.text){const z=U.doc.resolve(q.from).marks();U.replaceWith(q.from,q.to,Q.schema.text(q.text,z))}else U.delete(q.from,q.to)}return!0}}return!1},VY=()=>({tr:Q,dispatch:Z})=>{const{selection:X}=Q,{empty:J,ranges:Y}=X;if(J)return!0;if(Z)Y.forEach((q)=>{Q.removeMark(q.$from.pos,q.$to.pos)});return!0},KY=(Q,Z={})=>({tr:X,state:J,dispatch:Y})=>{var q;const{extendEmptyMarkRange:U=!1}=Z,{selection:G}=X,z=s0(Q,J.schema),{$from:V,empty:K,ranges:H}=G;if(!Y)return!0;if(K&&U){let{from:W,to:B}=G;const L=(q=V.marks().find((I)=>I.type===z))===null||q===void 0?void 0:q.attrs,_=I7(V,z,L);if(_)W=_.from,B=_.to;X.removeMark(W,B,z)}else H.forEach((W)=>{X.removeMark(W.$from.pos,W.$to.pos,z)});return X.removeStoredMark(z),!0},HY=(Q,Z={})=>({tr:X,state:J,dispatch:Y})=>{let q=null,U=null;const G=m5(typeof Q==="string"?Q:Q.name,J.schema);if(!G)return!1;if(G==="node")q=a(Q,J.schema);if(G==="mark")U=s0(Q,J.schema);if(Y)X.selection.ranges.forEach((z)=>{const V=z.$from.pos,K=z.$to.pos;let H,W,B,L;if(X.selection.empty)J.doc.nodesBetween(V,K,(_,I)=>{if(q&&q===_.type)B=Math.max(I,V),L=Math.min(I+_.nodeSize,K),H=I,W=_});else J.doc.nodesBetween(V,K,(_,I)=>{if(I<V&&q&&q===_.type)B=Math.max(I,V),L=Math.min(I+_.nodeSize,K),H=I,W=_;if(I>=V&&I<=K){if(q&&q===_.type)X.setNodeMarkup(I,void 0,{..._.attrs,...Z});if(U&&_.marks.length)_.marks.forEach((F)=>{if(U===F.type){const E=Math.max(I,V),M=Math.min(I+_.nodeSize,K);X.addMark(E,M,U.create({...F.attrs,...Z}))}})}});if(W){if(H!==void 0)X.setNodeMarkup(H,void 0,{...W.attrs,...Z});if(U&&W.marks.length)W.marks.forEach((_)=>{if(U===_.type)X.addMark(B,L,U.create({..._.attrs,...Z}))})}});return!0},WY=(Q,Z={})=>({state:X,dispatch:J})=>{const Y=a(Q,X.schema);return F4(Y,Z)(X,J)},LY=(Q,Z={})=>({state:X,dispatch:J})=>{const Y=a(Q,X.schema);return P4(Y,Z)(X,J)},BY=Object.freeze({__proto__:null,blur:QJ,clearContent:ZJ,clearNodes:XJ,command:JJ,createParagraphNear:YJ,cut:qJ,deleteCurrentNode:UJ,deleteNode:GJ,deleteRange:zJ,deleteSelection:VJ,enter:KJ,exitCode:HJ,extendMarkRange:WJ,first:LJ,focus:_J,forEach:IJ,insertContent:FJ,insertContentAt:EJ,joinBackward:RJ,joinDown:OJ,joinForward:NJ,joinItemBackward:DJ,joinItemForward:MJ,joinTextblockBackward:CJ,joinTextblockForward:TJ,joinUp:AJ,keyboardShortcut:SJ,lift:yJ,liftEmptyBlock:bJ,liftListItem:$J,newlineInCode:xJ,resetAttributes:gJ,scrollIntoView:wJ,selectAll:uJ,selectNodeBackward:vJ,selectNodeForward:fJ,selectParentNode:hJ,selectTextblockEnd:mJ,selectTextblockStart:lJ,setContent:cJ,setMark:rJ,setMeta:oJ,setNode:tJ,setNodeSelection:eJ,setTextSelection:QY,sinkListItem:ZY,splitBlock:XY,splitListItem:JY,toggleList:YY,toggleMark:qY,toggleNode:UY,toggleWrap:GY,undoInputRule:zY,unsetAllMarks:VY,unsetMark:KY,updateAttributes:HY,wrapIn:WY,wrapInList:LY}),_Y=i.create({name:"commands",addCommands(){return{...BY}}}),IY=i.create({name:"drop",addProseMirrorPlugins(){return[new g({key:new c("tiptapDrop"),props:{handleDrop:(Q,Z,X,J)=>{this.editor.emit("drop",{editor:this.editor,event:Z,slice:X,moved:J})}}})]}}),FY=i.create({name:"editable",addProseMirrorPlugins(){return[new g({key:new c("editable"),props:{editable:()=>this.editor.options.editable}})]}}),PY=i.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:Q}=this;return[new g({key:new c("focusEvents"),props:{handleDOMEvents:{focus:(Z,X)=>{Q.isFocused=!0;const J=Q.state.tr.setMeta("focus",{event:X}).setMeta("addToHistory",!1);return Z.dispatch(J),!1},blur:(Z,X)=>{Q.isFocused=!1;const J=Q.state.tr.setMeta("blur",{event:X}).setMeta("addToHistory",!1);return Z.dispatch(J),!1}}}})]}}),jY=i.create({name:"keymap",addKeyboardShortcuts(){const Q=()=>this.editor.commands.first(({commands:U})=>[()=>U.undoInputRule(),()=>U.command(({tr:G})=>{const{selection:z,doc:V}=G,{empty:K,$anchor:H}=z,{pos:W,parent:B}=H,L=H.parent.isTextblock&&W>0?G.doc.resolve(W-1):H,_=L.parent.type.spec.isolating,I=H.pos-H.parentOffset,F=_&&L.parent.childCount===1?I===H.pos:N.atStart(V).from===W;if(!K||!B.type.isTextblock||B.textContent.length||!F||F&&H.parent.type.name==="paragraph")return!1;return U.clearNodes()}),()=>U.deleteSelection(),()=>U.joinBackward(),()=>U.selectNodeBackward()]),Z=()=>this.editor.commands.first(({commands:U})=>[()=>U.deleteSelection(),()=>U.deleteCurrentNode(),()=>U.joinForward(),()=>U.selectNodeForward()]),J={Enter:()=>this.editor.commands.first(({commands:U})=>[()=>U.newlineInCode(),()=>U.createParagraphNear(),()=>U.liftEmptyBlock(),()=>U.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:Q,"Mod-Backspace":Q,"Shift-Backspace":Q,Delete:Z,"Mod-Delete":Z,"Mod-a":()=>this.editor.commands.selectAll()},Y={...J},q={...J,"Ctrl-h":Q,"Alt-Backspace":Q,"Ctrl-d":Z,"Ctrl-Alt-Backspace":Z,"Alt-Delete":Z,"Alt-d":Z,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};if(F7()||v4())return q;return Y},addProseMirrorPlugins(){return[new g({key:new c("clearDocument"),appendTransaction:(Q,Z,X)=>{if(Q.some((_)=>_.getMeta("composition")))return;const J=Q.some((_)=>_.docChanged)&&!Z.doc.eq(X.doc),Y=Q.some((_)=>_.getMeta("preventClearDocument"));if(!J||Y)return;const{empty:q,from:U,to:G}=Z.selection,z=N.atStart(Z.doc).from,V=N.atEnd(Z.doc).to;if(q||!(U===z&&G===V))return;if(!E7(X.doc))return;const W=X.tr,B=v5({state:X,transaction:W}),{commands:L}=new X5({editor:this.editor,state:B});if(L.clearNodes(),!W.steps.length)return;return W}})]}}),EY=i.create({name:"paste",addProseMirrorPlugins(){return[new g({key:new c("tiptapPaste"),props:{handlePaste:(Q,Z,X)=>{this.editor.emit("paste",{editor:this.editor,event:Z,slice:X})}}})]}}),AY=i.create({name:"tabindex",addProseMirrorPlugins(){return[new g({key:new c("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class G1{get name(){return this.node.type.name}constructor(Q,Z,X=!1,J=null){this.currentNode=null,this.actualDepth=null,this.isBlock=X,this.resolvedPos=Q,this.editor=Z,this.currentNode=J}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var Q;return(Q=this.actualDepth)!==null&&Q!==void 0?Q:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(Q){let Z=this.from,X=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}Z=this.from+1,X=this.to-1}this.editor.commands.insertContentAt({from:Z,to:X},Q)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){if(this.isBlock)return this.pos;return this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){if(this.isBlock)return this.pos+this.size;return this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const Q=this.resolvedPos.start(this.resolvedPos.depth-1),Z=this.resolvedPos.doc.resolve(Q);return new G1(Z,this.editor)}get before(){let Q=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));if(Q.depth!==this.depth)Q=this.resolvedPos.doc.resolve(this.from-3);return new G1(Q,this.editor)}get after(){let Q=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));if(Q.depth!==this.depth)Q=this.resolvedPos.doc.resolve(this.to+3);return new G1(Q,this.editor)}get children(){const Q=[];return this.node.content.forEach((Z,X)=>{const J=Z.isBlock&&!Z.isTextblock,Y=Z.isAtom&&!Z.isText,q=this.pos+X+(Y?0:1),U=this.resolvedPos.doc.resolve(q);if(!J&&U.depth<=this.depth)return;const G=new G1(U,this.editor,J,J?Z:null);if(J)G.actualDepth=this.depth+1;Q.push(new G1(U,this.editor,J,J?Z:null))}),Q}get firstChild(){return this.children[0]||null}get lastChild(){const Q=this.children;return Q[Q.length-1]||null}closest(Q,Z={}){let X=null,J=this.parent;while(J&&!X){if(J.node.type.name===Q)if(Object.keys(Z).length>0){const Y=J.node.attrs,q=Object.keys(Z);for(let U=0;U<q.length;U+=1){const G=q[U];if(Y[G]!==Z[G])break}}else X=J;J=J.parent}return X}querySelector(Q,Z={}){return this.querySelectorAll(Q,Z,!0)[0]||null}querySelectorAll(Q,Z={},X=!1){let J=[];if(!this.children||this.children.length===0)return J;const Y=Object.keys(Z);return this.children.forEach((q)=>{if(X&&J.length>0)return;if(q.node.type.name===Q){if(Y.every((G)=>Z[G]===q.node.attrs[G]))J.push(q)}if(X&&J.length>0)return;J=J.concat(q.querySelectorAll(Q,Z,X))}),J}setAttribute(Q){const{tr:Z}=this.editor.state;Z.setNodeMarkup(this.from,void 0,{...this.node.attrs,...Q}),this.editor.view.dispatch(Z)}}var OY=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;class A7 extends T4{constructor(Q={}){super();this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:Z})=>{throw Z},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(Q),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:Z,slice:X,moved:J})=>this.options.onDrop(Z,X,J)),this.on("paste",({event:Z,slice:X})=>this.options.onPaste(Z,X)),window.setTimeout(()=>{if(this.isDestroyed)return;this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){if(this.options.injectCSS&&document)this.css=RY(OY,this.options.injectNonce)}setOptions(Q={}){if(this.options={...this.options,...Q},!this.view||!this.state||this.isDestroyed)return;if(this.options.editorProps)this.view.setProps(this.options.editorProps);this.view.updateState(this.state)}setEditable(Q,Z=!0){if(this.setOptions({editable:Q}),Z)this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(Q,Z){const X=S4(Z)?Z(Q,[...this.state.plugins]):[...this.state.plugins,Q],J=this.state.reconfigure({plugins:X});return this.view.updateState(J),J}unregisterPlugin(Q){if(this.isDestroyed)return;const Z=this.state.plugins;let X=Z;if([].concat(Q).forEach((Y)=>{const q=typeof Y==="string"?`${Y}\$`:Y.key;X=Z.filter((U)=>!U.key.startsWith(q))}),Z.length===X.length)return;const J=this.state.reconfigure({plugins:X});return this.view.updateState(J),J}createExtensionManager(){var Q,Z;const J=[...this.options.enableCoreExtensions?[FY,eX.configure({blockSeparator:(Z=(Q=this.options.coreExtensionOptions)===null||Q===void 0?void 0:Q.clipboardTextSerializer)===null||Z===void 0?void 0:Z.blockSeparator}),_Y,PY,jY,AY,IY,EY].filter((Y)=>{if(typeof this.options.enableCoreExtensions==="object")return this.options.enableCoreExtensions[Y.name]!==!1;return!0}):[],...this.options.extensions].filter((Y)=>{return["extension","node","mark"].includes(Y===null||Y===void 0?void 0:Y.type)});this.extensionManager=new y1(J,this)}createCommandManager(){this.commandManager=new X5({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var Q;let Z;try{Z=W7(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(q){if(!(q instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(q.message))throw q;this.emit("contentError",{editor:this,error:q,disableCollaboration:()=>{if(this.storage.collaboration)this.storage.collaboration.isDisabled=!0;this.options.extensions=this.options.extensions.filter((U)=>U.name!=="collaboration"),this.createExtensionManager()}}),Z=W7(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const X=w4(Z,this.options.autofocus);this.view=new p6(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(Q=this.options.editorProps)===null||Q===void 0?void 0:Q.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:e0.create({doc:Z,selection:X||void 0})});const J=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(J),this.createNodeViews(),this.prependClass();const Y=this.view.dom;Y.editor=this}createNodeViews(){if(this.view.isDestroyed)return;this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(Q){this.isCapturingTransaction=!0,Q(),this.isCapturingTransaction=!1;const Z=this.capturedTransaction;return this.capturedTransaction=null,Z}dispatchTransaction(Q){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=Q;return}Q.steps.forEach((q)=>{var U;return(U=this.capturedTransaction)===null||U===void 0?void 0:U.step(q)});return}const Z=this.state.apply(Q),X=!this.state.selection.eq(Z.selection);if(this.emit("beforeTransaction",{editor:this,transaction:Q,nextState:Z}),this.view.updateState(Z),this.emit("transaction",{editor:this,transaction:Q}),X)this.emit("selectionUpdate",{editor:this,transaction:Q});const J=Q.getMeta("focus"),Y=Q.getMeta("blur");if(J)this.emit("focus",{editor:this,event:J.event,transaction:Q});if(Y)this.emit("blur",{editor:this,event:Y.event,transaction:Q});if(!Q.docChanged||Q.getMeta("preventUpdate"))return;this.emit("update",{editor:this,transaction:Q})}getAttributes(Q){return sJ(this.state,Q)}isActive(Q,Z){const X=typeof Q==="string"?Q:null,J=typeof Q==="string"?Z:Q;return aJ(this.state,X,J)}getJSON(){return this.state.doc.toJSON()}getHTML(){return B7(this.state.doc.content,this.schema)}getText(Q){const{blockSeparator:Z="\n\n",textSerializers:X={}}=Q||{};return dJ(this.state.doc,{blockSeparator:Z,textSerializers:{...$4(this.schema),...X}})}get isEmpty(){return E7(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const Q=this.view.dom;if(Q&&Q.editor)delete Q.editor;this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var Q;return!((Q=this.view)===null||Q===void 0?void 0:Q.docView)}$node(Q,Z){var X;return((X=this.$doc)===null||X===void 0?void 0:X.querySelector(Q,Z))||null}$nodes(Q,Z){var X;return((X=this.$doc)===null||X===void 0?void 0:X.querySelectorAll(Q,Z))||null}$pos(Q){const Z=this.state.doc.resolve(Q);return new G1(Z,this)}get $doc(){return this.$pos(0)}}class C{constructor(Q={}){if(this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...Q},this.name=this.config.name,Q.defaultOptions&&Object.keys(Q.defaultOptions).length>0)console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`);if(this.options=this.config.defaultOptions,this.config.addOptions)this.options=T(A(this,"addOptions",{name:this.name}));this.storage=T(A(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(Q={}){return new C(Q)}configure(Q={}){const Z=this.extend({...this.config,addOptions:()=>{return h5(this.options,Q)}});return Z.name=this.name,Z.parent=this.parent,Z}extend(Q={}){const Z=new C(Q);if(Z.parent=this,this.child=Z,Z.name=Q.name?Q.name:Z.parent.name,Q.defaultOptions&&Object.keys(Q.defaultOptions).length>0)console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${Z.name}".`);return Z.options=T(A(Z,"addOptions",{name:Z.name})),Z.storage=T(A(Z,"addStorage",{name:Z.name,options:Z.options})),Z}}var NY=function(Q){if(Q.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+Q.type.name);const Z=DY(Q),X=Q.childCount,J=[];let Y=0,q=null;const U=[];for(let V=0,K=Z*X;V<K;V++)J[V]=0;for(let V=0,K=0;V<X;V++){const H=Q.child(V);K++;for(let L=0;;L++){while(Y<J.length&&J[Y]!=0)Y++;if(L==H.childCount)break;const _=H.child(L),{colspan:I,rowspan:F,colwidth:E}=_.attrs;for(let M=0;M<F;M++){if(M+V>=X){(q||(q=[])).push({type:"overlong_rowspan",pos:K,n:F-M});break}const $=Y+M*Z;for(let k=0;k<I;k++){if(J[$+k]==0)J[$+k]=K;else(q||(q=[])).push({type:"collision",row:V,pos:K,n:I-k});const y=E&&E[k];if(y){const m=($+k)%Z*2,d=U[m];if(d==null||d!=y&&U[m+1]==1)U[m]=y,U[m+1]=1;else if(d==y)U[m+1]++}}}Y+=I,K+=_.nodeSize}const W=(V+1)*Z;let B=0;while(Y<W)if(J[Y++]==0)B++;if(B)(q||(q=[])).push({type:"missing",row:V,n:B});K++}if(Z===0||X===0)(q||(q=[])).push({type:"zero_sized"});const G=new v(Z,X,J,q);let z=!1;for(let V=0;!z&&V<U.length;V+=2)if(U[V]!=null&&U[V+1]<X)z=!0;if(z)MY(G,U,Q);return G},DY=function(Q){let Z=-1,X=!1;for(let J=0;J<Q.childCount;J++){const Y=Q.child(J);let q=0;if(X)for(let U=0;U<J;U++){const G=Q.child(U);for(let z=0;z<G.childCount;z++){const V=G.child(z);if(U+V.attrs.rowspan>J)q+=V.attrs.colspan}}for(let U=0;U<Y.childCount;U++){const G=Y.child(U);if(q+=G.attrs.colspan,G.attrs.rowspan>1)X=!0}if(Z==-1)Z=q;else if(Z!=q)Z=Math.max(Z,q)}return Z},MY=function(Q,Z,X){if(!Q.problems)Q.problems=[];const J={};for(let Y=0;Y<Q.map.length;Y++){const q=Q.map[Y];if(J[q])continue;J[q]=!0;const U=X.nodeAt(q);if(!U)throw new RangeError(`No cell with offset ${q} found`);let G=null;const z=U.attrs;for(let V=0;V<z.colspan;V++){const K=(Y+V)%Q.width,H=Z[K*2];if(H!=null&&(!z.colwidth||z.colwidth[V]!=H))(G||(G=CY(z)))[V]=H}if(G)Q.problems.unshift({type:"colwidth mismatch",pos:q,colwidth:G})}},CY=function(Q){if(Q.colwidth)return Q.colwidth.slice();const Z=[];for(let X=0;X<Q.colspan;X++)Z.push(0);return Z};var X0=function(Q){let Z=Q.cached.tableNodeTypes;if(!Z){Z=Q.cached.tableNodeTypes={};for(let X in Q.nodes){const J=Q.nodes[X],Y=J.spec.tableRole;if(Y)Z[Y]=J}}return Z},b1=function(Q){for(let Z=Q.depth-1;Z>0;Z--)if(Q.node(Z).type.spec.tableRole=="row")return Q.node(0).resolve(Q.before(Z+1));return null},TY=function(Q){for(let Z=Q.depth;Z>0;Z--){const X=Q.node(Z).type.spec.tableRole;if(X==="cell"||X==="header_cell")return Q.node(Z)}return null},F0=function(Q){const Z=Q.selection.$head;for(let X=Z.depth;X>0;X--)if(Z.node(X).type.spec.tableRole=="row")return!0;return!1},s5=function(Q){const Z=Q.selection;if("$anchorCell"in Z&&Z.$anchorCell)return Z.$anchorCell.pos>Z.$headCell.pos?Z.$anchorCell:Z.$headCell;else if("node"in Z&&Z.node&&Z.node.type.spec.tableRole=="cell")return Z.$anchor;const X=b1(Z.$head)||kY(Z.$head);if(X)return X;throw new RangeError(`No cell found around position ${Z.head}`)},kY=function(Q){for(let{nodeAfter:Z,pos:X}=Q;Z;Z=Z.firstChild,X++){const J=Z.type.spec.tableRole;if(J=="cell"||J=="header_cell")return Q.doc.resolve(X)}for(let{nodeBefore:Z,pos:X}=Q;Z;Z=Z.lastChild,X--){const J=Z.type.spec.tableRole;if(J=="cell"||J=="header_cell")return Q.doc.resolve(X-Z.nodeSize)}},D7=function(Q){return Q.parent.type.spec.tableRole=="row"&&!!Q.nodeAfter},SY=function(Q){return Q.node(0).resolve(Q.pos+Q.nodeAfter.nodeSize)},T7=function(Q,Z){return Q.depth==Z.depth&&Q.pos>=Z.start(-1)&&Q.pos<=Z.end(-1)};var o4=function(Q,Z,X){const J=Q.node(-1),Y=v.get(J),q=Q.start(-1),U=Y.nextCell(Q.pos-q,Z,X);return U==null?null:Q.node(0).resolve(q+U)},V1=function(Q,Z,X=1){const J={...Q,colspan:Q.colspan-X};if(J.colwidth){if(J.colwidth=J.colwidth.slice(),J.colwidth.splice(Z,X),!J.colwidth.some((Y)=>Y>0))J.colwidth=null}return J},t4=function(Q,Z,X=1){const J={...Q,colspan:Q.colspan+X};if(J.colwidth){J.colwidth=J.colwidth.slice();for(let Y=0;Y<X;Y++)J.colwidth.splice(Z,0,0)}return J},yY=function(Q,Z,X){const J=X0(Z.type.schema).header_cell;for(let Y=0;Y<Q.height;Y++)if(Z.nodeAt(Q.map[X+Y*Q.width]).type!=J)return!1;return!0},$Y=function(Q){if(!(Q.selection instanceof x))return null;const Z=[];return Q.selection.forEachCell((X,J)=>{Z.push(s.node(J,J+X.nodeSize,{class:"selectedCell"}))}),w.create(Q.doc,Z)},xY=function({$from:Q,$to:Z}){if(Q.pos==Z.pos||Q.pos<Z.pos-6)return!1;let X=Q.pos,J=Z.pos,Y=Q.depth;for(;Y>=0;Y--,X++)if(Q.after(Y+1)<Q.end(Y))break;for(let q=Z.depth;q>=0;q--,J--)if(Z.before(q+1)>Z.start(q))break;return X==J&&/row|table/.test(Q.node(Y).type.spec.tableRole)},gY=function({$from:Q,$to:Z}){let X,J;for(let Y=Q.depth;Y>0;Y--){const q=Q.node(Y);if(q.type.spec.tableRole==="cell"||q.type.spec.tableRole==="header_cell"){X=q;break}}for(let Y=Z.depth;Y>0;Y--){const q=Z.node(Y);if(q.type.spec.tableRole==="cell"||q.type.spec.tableRole==="header_cell"){J=q;break}}return X!==J&&Z.parentOffset===0},wY=function(Q,Z,X){const J=(Z||Q).selection,Y=(Z||Q).doc;let q,U;if(J instanceof R&&(U=J.node.type.spec.tableRole)){if(U=="cell"||U=="header_cell")q=x.create(Y,J.from);else if(U=="row"){const G=Y.resolve(J.from+1);q=x.rowSelection(G,G)}else if(!X){const G=v.get(J.node),z=J.from+1,V=z+G.map[G.width*G.height-1];q=x.create(Y,z+1,V)}}else if(J instanceof O&&xY(J))q=O.create(Y,J.from);else if(J instanceof O&&gY(J))q=O.create(Y,J.$from.start(),J.$from.end());if(q)(Z||(Z=Q.tr)).setSelection(q);return Z};var e4=function(Q,Z,X,J){const Y=Q.childCount,q=Z.childCount;Q:for(let U=0,G=0;U<q;U++){const z=Z.child(U);for(let V=G,K=Math.min(Y,U+3);V<K;V++)if(Q.child(V)==z){G=V+1,X+=z.nodeSize;continue Q}if(J(z,X),G<Y&&Q.child(G).sameMarkup(z))e4(Q.child(G),z,X+1,J);else z.nodesBetween(0,z.content.size,J,X+1);X+=z.nodeSize}},k7=function(Q,Z){let X;const J=(Y,q)=>{if(Y.type.spec.tableRole=="table")X=vY(Q,Y,q,X)};if(!Z)Q.doc.descendants(J);else if(Z.doc!=Q.doc)e4(Z.doc,Q.doc,0,J);return X},vY=function(Q,Z,X,J){const Y=v.get(Z);if(!Y.problems)return J;if(!J)J=Q.tr;const q=[];for(let z=0;z<Y.height;z++)q.push(0);for(let z=0;z<Y.problems.length;z++){const V=Y.problems[z];if(V.type=="collision"){const K=Z.nodeAt(V.pos);if(!K)continue;const H=K.attrs;for(let W=0;W<H.rowspan;W++)q[V.row+W]+=V.n;J.setNodeMarkup(J.mapping.map(X+1+V.pos),null,V1(H,H.colspan-V.n,V.n))}else if(V.type=="missing")q[V.row]+=V.n;else if(V.type=="overlong_rowspan"){const K=Z.nodeAt(V.pos);if(!K)continue;J.setNodeMarkup(J.mapping.map(X+1+V.pos),null,{...K.attrs,rowspan:K.attrs.rowspan-V.n})}else if(V.type=="colwidth mismatch"){const K=Z.nodeAt(V.pos);if(!K)continue;J.setNodeMarkup(J.mapping.map(X+1+V.pos),null,{...K.attrs,colwidth:V.colwidth})}else if(V.type=="zero_sized"){const K=J.mapping.map(X);J.delete(K,K+Z.nodeSize)}}let U,G;for(let z=0;z<q.length;z++)if(q[z]){if(U==null)U=z;G=z}for(let z=0,V=X+1;z<Y.height;z++){const K=Z.child(z),H=V+K.nodeSize,W=q[z];if(W>0){let B="cell";if(K.firstChild)B=K.firstChild.type.spec.tableRole;const L=[];for(let I=0;I<W;I++){const F=X0(Q.schema)[B].createAndFill();if(F)L.push(F)}const _=(z==0||U==z-1)&&G==z?V+1:H-1;J.insert(J.mapping.map(_),L)}V=H}return J.setMeta(uY,{fixTables:!0})};var D0=function(Q){const Z=Q.selection,X=s5(Q),J=X.node(-1),Y=X.start(-1),q=v.get(J);return{...Z instanceof x?q.rectBetween(Z.$anchorCell.pos-Y,Z.$headCell.pos-Y):q.findCell(X.pos-Y),tableStart:Y,map:q,table:J}},Q8=function(Q,{map:Z,tableStart:X,table:J},Y){let q=Y>0?-1:0;if(yY(Z,J,Y+q))q=Y==0||Y==Z.width?null:0;for(let U=0;U<Z.height;U++){const G=U*Z.width+Y;if(Y>0&&Y<Z.width&&Z.map[G-1]==Z.map[G]){const z=Z.map[G],V=J.nodeAt(z);Q.setNodeMarkup(Q.mapping.map(X+z),null,t4(V.attrs,Y-Z.colCount(z))),U+=V.attrs.rowspan-1}else{const z=q==null?X0(J.type.schema).cell:J.nodeAt(Z.map[G+q]).type,V=Z.positionAt(U,Y,J);Q.insert(Q.mapping.map(X+V),z.createAndFill())}}return Q},Z8=function(Q,Z){if(!F0(Q))return!1;if(Z){const X=D0(Q);Z(Q8(Q.tr,X,X.left))}return!0},X8=function(Q,Z){if(!F0(Q))return!1;if(Z){const X=D0(Q);Z(Q8(Q.tr,X,X.right))}return!0},fY=function(Q,{map:Z,table:X,tableStart:J},Y){const q=Q.mapping.maps.length;for(let U=0;U<Z.height;){const G=U*Z.width+Y,z=Z.map[G],V=X.nodeAt(z),K=V.attrs;if(Y>0&&Z.map[G-1]==z||Y<Z.width-1&&Z.map[G+1]==z)Q.setNodeMarkup(Q.mapping.slice(q).map(J+z),null,V1(K,Y-Z.colCount(z)));else{const H=Q.mapping.slice(q).map(J+z);Q.delete(H,H+V.nodeSize)}U+=K.rowspan}},J8=function(Q,Z){if(!F0(Q))return!1;if(Z){const X=D0(Q),J=Q.tr;if(X.left==0&&X.right==X.map.width)return!1;for(let Y=X.right-1;;Y--){if(fY(J,X,Y),Y==X.left)break;const q=X.tableStart?J.doc.nodeAt(X.tableStart-1):J.doc;if(!q)throw RangeError("No table found");X.table=q,X.map=v.get(q)}Z(J)}return!0},hY=function(Q,Z,X){var J;const Y=X0(Z.type.schema).header_cell;for(let q=0;q<Q.width;q++)if(((J=Z.nodeAt(Q.map[q+X*Q.width]))==null?void 0:J.type)!=Y)return!1;return!0},Y8=function(Q,{map:Z,tableStart:X,table:J},Y){var q;let U=X;for(let V=0;V<Y;V++)U+=J.child(V).nodeSize;const G=[];let z=Y>0?-1:0;if(hY(Z,J,Y+z))z=Y==0||Y==Z.height?null:0;for(let V=0,K=Z.width*Y;V<Z.width;V++,K++)if(Y>0&&Y<Z.height&&Z.map[K]==Z.map[K-Z.width]){const H=Z.map[K],W=J.nodeAt(H).attrs;Q.setNodeMarkup(X+H,null,{...W,rowspan:W.rowspan+1}),V+=W.colspan-1}else{const H=z==null?X0(J.type.schema).cell:(q=J.nodeAt(Z.map[K+z*Z.width]))==null?void 0:q.type,W=H==null?void 0:H.createAndFill();if(W)G.push(W)}return Q.insert(U,X0(J.type.schema).row.create(null,G)),Q},q8=function(Q,Z){if(!F0(Q))return!1;if(Z){const X=D0(Q);Z(Y8(Q.tr,X,X.top))}return!0},U8=function(Q,Z){if(!F0(Q))return!1;if(Z){const X=D0(Q);Z(Y8(Q.tr,X,X.bottom))}return!0},mY=function(Q,{map:Z,table:X,tableStart:J},Y){let q=0;for(let V=0;V<Y;V++)q+=X.child(V).nodeSize;const U=q+X.child(Y).nodeSize,G=Q.mapping.maps.length;Q.delete(q+J,U+J);const z=new Set;for(let V=0,K=Y*Z.width;V<Z.width;V++,K++){const H=Z.map[K];if(z.has(H))continue;if(z.add(H),Y>0&&H==Z.map[K-Z.width]){const W=X.nodeAt(H).attrs;Q.setNodeMarkup(Q.mapping.slice(G).map(H+J),null,{...W,rowspan:W.rowspan-1}),V+=W.colspan-1}else if(Y<Z.height&&H==Z.map[K+Z.width]){const W=X.nodeAt(H),B=W.attrs,L=W.type.create({...B,rowspan:W.attrs.rowspan-1},W.content),_=Z.positionAt(Y+1,V,X);Q.insert(Q.mapping.slice(G).map(J+_),L),V+=B.colspan-1}}},G8=function(Q,Z){if(!F0(Q))return!1;if(Z){const X=D0(Q),J=Q.tr;if(X.top==0&&X.bottom==X.map.height)return!1;for(let Y=X.bottom-1;;Y--){if(mY(J,X,Y),Y==X.top)break;const q=X.tableStart?J.doc.nodeAt(X.tableStart-1):J.doc;if(!q)throw RangeError("No table found");X.table=q,X.map=v.get(X.table)}Z(J)}return!0},l4=function(Q){const Z=Q.content;return Z.childCount==1&&Z.child(0).isTextblock&&Z.child(0).childCount==0},lY=function({width:Q,height:Z,map:X},J){let Y=J.top*Q+J.left,q=Y,U=(J.bottom-1)*Q+J.left,G=Y+(J.right-J.left-1);for(let z=J.top;z<J.bottom;z++){if(J.left>0&&X[q]==X[q-1]||J.right<Q&&X[G]==X[G+1])return!0;q+=Q,G+=Q}for(let z=J.left;z<J.right;z++){if(J.top>0&&X[Y]==X[Y-Q]||J.bottom<Z&&X[U]==X[U+Q])return!0;Y++,U++}return!1},S7=function(Q,Z){const X=Q.selection;if(!(X instanceof x)||X.$anchorCell.pos==X.$headCell.pos)return!1;const J=D0(Q),{map:Y}=J;if(lY(Y,J))return!1;if(Z){const q=Q.tr,U={};let G=P.empty,z,V;for(let K=J.top;K<J.bottom;K++)for(let H=J.left;H<J.right;H++){const W=Y.map[K*Y.width+H],B=J.table.nodeAt(W);if(U[W]||!B)continue;if(U[W]=!0,z==null)z=W,V=B;else{if(!l4(B))G=G.append(B.content);const L=q.mapping.map(W+J.tableStart);q.delete(L,L+B.nodeSize)}}if(z==null||V==null)return!0;if(q.setNodeMarkup(z+J.tableStart,null,{...t4(V.attrs,V.attrs.colspan,J.right-J.left-V.attrs.colspan),rowspan:J.bottom-J.top}),G.size){const K=z+1+V.content.size,H=l4(V)?z+1:K;q.replaceWith(H+J.tableStart,K+J.tableStart,G)}q.setSelection(new x(q.doc.resolve(z+J.tableStart))),Z(q)}return!0},y7=function(Q,Z){const X=X0(Q.schema);return cY(({node:J})=>{return X[J.type.spec.tableRole]})(Q,Z)},cY=function(Q){return(Z,X)=>{var J;const Y=Z.selection;let q,U;if(!(Y instanceof x)){if(q=TY(Y.$from),!q)return!1;U=(J=b1(Y.$from))==null?void 0:J.pos}else{if(Y.$anchorCell.pos!=Y.$headCell.pos)return!1;q=Y.$anchorCell.nodeAfter,U=Y.$anchorCell.pos}if(q==null||U==null)return!1;if(q.attrs.colspan==1&&q.attrs.rowspan==1)return!1;if(X){let G=q.attrs;const z=[],V=G.colwidth;if(G.rowspan>1)G={...G,rowspan:1};if(G.colspan>1)G={...G,colspan:1};const K=D0(Z),H=Z.tr;for(let B=0;B<K.right-K.left;B++)z.push(V?{...G,colwidth:V&&V[B]?[V[B]]:null}:G);let W;for(let B=K.top;B<K.bottom;B++){let L=K.map.positionAt(B,K.left,K.table);if(B==K.top)L+=q.nodeSize;for(let _=K.left,I=0;_<K.right;_++,I++){if(_==K.left&&B==K.top)continue;H.insert(W=H.mapping.map(L+K.tableStart,1),Q({node:q,row:B,col:_}).createAndFill(z[I]))}}if(H.setNodeMarkup(U,Q({node:q,row:K.top,col:K.left}),z[0]),Y instanceof x)H.setSelection(new x(H.doc.resolve(Y.$anchorCell.pos),W?H.doc.resolve(W):void 0));X(H)}return!0}},z8=function(Q,Z){return function(X,J){if(!F0(X))return!1;const Y=s5(X);if(Y.nodeAfter.attrs[Q]===Z)return!1;if(J){const q=X.tr;if(X.selection instanceof x)X.selection.forEachCell((U,G)=>{if(U.attrs[Q]!==Z)q.setNodeMarkup(G,null,{...U.attrs,[Q]:Z})});else q.setNodeMarkup(Y.pos,null,{...Y.nodeAfter.attrs,[Q]:Z});J(q)}return!0}},pY=function(Q){return function(Z,X){if(!F0(Z))return!1;if(X){const J=X0(Z.schema),Y=D0(Z),q=Z.tr,U=Y.map.cellsInRect(Q=="column"?{left:Y.left,top:0,right:Y.right,bottom:Y.map.height}:Q=="row"?{left:0,top:Y.top,right:Y.map.width,bottom:Y.bottom}:Y),G=U.map((z)=>Y.table.nodeAt(z));for(let z=0;z<U.length;z++)if(G[z].type==J.header_cell)q.setNodeMarkup(Y.tableStart+U[z],J.cell,G[z].attrs);if(q.steps.length==0)for(let z=0;z<U.length;z++)q.setNodeMarkup(Y.tableStart+U[z],J.header_cell,G[z].attrs);X(q)}return!0}},c4=function(Q,Z,X){const J=Z.map.cellsInRect({left:0,top:0,right:Q=="row"?Z.map.width:1,bottom:Q=="column"?Z.map.height:1});for(let Y=0;Y<J.length;Y++){const q=Z.table.nodeAt(J[Y]);if(q&&q.type!==X.header_cell)return!1}return!0},$1=function(Q,Z){if(Z=Z||{useDeprecatedLogic:!1},Z.useDeprecatedLogic)return pY(Q);return function(X,J){if(!F0(X))return!1;if(J){const Y=X0(X.schema),q=D0(X),U=X.tr,G=c4("row",q,Y),z=c4("column",q,Y),K=(Q==="column"?G:Q==="row"?z:!1)?1:0,H=Q=="column"?{left:0,top:K,right:1,bottom:q.map.height}:Q=="row"?{left:K,top:0,right:q.map.width,bottom:1}:q,W=Q=="column"?z?Y.cell:Y.header_cell:Q=="row"?G?Y.cell:Y.header_cell:Y.cell;q.map.cellsInRect(H).forEach((B)=>{const L=B+q.tableStart,_=U.doc.nodeAt(L);if(_)U.setNodeMarkup(L,W,_.attrs)}),J(U)}return!0}},dY=function(Q,Z){if(Z<0){const X=Q.nodeBefore;if(X)return Q.pos-X.nodeSize;for(let J=Q.index(-1)-1,Y=Q.before();J>=0;J--){const q=Q.node(-1).child(J),U=q.lastChild;if(U)return Y-1-U.nodeSize;Y-=q.nodeSize}}else{if(Q.index()<Q.parent.childCount-1)return Q.pos+Q.nodeAfter.nodeSize;const X=Q.node(-1);for(let J=Q.indexAfter(-1),Y=Q.after();J<X.childCount;J++){const q=X.child(J);if(q.childCount)return Y+1;Y+=q.nodeSize}}return null},b7=function(Q){return function(Z,X){if(!F0(Z))return!1;const J=dY(s5(Z),Q);if(J==null)return!1;if(X){const Y=Z.doc.resolve(J);X(Z.tr.setSelection(O.between(Y,SY(Y))).scrollIntoView())}return!0}},K8=function(Q,Z){const X=Q.selection.$anchor;for(let J=X.depth;J>0;J--)if(X.node(J).type.spec.tableRole=="table"){if(Z)Z(Q.tr.delete(X.before(J),X.after(J)).scrollIntoView());return!0}return!1},c5=function(Q,Z){const X=Q.selection;if(!(X instanceof x))return!1;if(Z){const J=Q.tr,Y=X0(Q.schema).cell.createAndFill().content;if(X.forEachCell((q,U)=>{if(!q.content.eq(Y))J.replace(J.mapping.map(U+1),J.mapping.map(U+q.nodeSize-1),new j(Y,0,0))}),J.docChanged)Z(J)}return!0};var iY=function(Q){if(!Q.size)return null;let{content:Z,openStart:X,openEnd:J}=Q;while(Z.childCount==1&&(X>0&&J>0||Z.child(0).type.spec.tableRole=="table"))X--,J--,Z=Z.child(0).content;const Y=Z.child(0),q=Y.type.spec.tableRole,U=Y.type.schema,G=[];if(q=="row")for(let z=0;z<Z.childCount;z++){let V=Z.child(z).content;const K=z?0:Math.max(0,X-1),H=z<Z.childCount-1?0:Math.max(0,J-1);if(K||H)V=M7(X0(U).row,new j(V,K,H)).content;G.push(V)}else if(q=="cell"||q=="header_cell")G.push(X||J?M7(X0(U).row,new j(Z,X,J)).content:Z);else return null;return sY(U,G)},sY=function(Q,Z){const X=[];for(let Y=0;Y<Z.length;Y++){const q=Z[Y];for(let U=q.childCount-1;U>=0;U--){const{rowspan:G,colspan:z}=q.child(U).attrs;for(let V=Y;V<Y+G;V++)X[V]=(X[V]||0)+z}}let J=0;for(let Y=0;Y<X.length;Y++)J=Math.max(J,X[Y]);for(let Y=0;Y<X.length;Y++){if(Y>=Z.length)Z.push(P.empty);if(X[Y]<J){const q=X0(Q).cell.createAndFill(),U=[];for(let G=X[Y];G<J;G++)U.push(q);Z[Y]=Z[Y].append(P.from(U))}}return{height:Z.length,width:J,rows:Z}},M7=function(Q,Z){const X=Q.createAndFill();return new E1(X).replace(0,X.content.size,Z).doc},aY=function({width:Q,height:Z,rows:X},J,Y){if(Q!=J){const q=[],U=[];for(let G=0;G<X.length;G++){const z=X[G],V=[];for(let K=q[G]||0,H=0;K<J;H++){let W=z.child(H%z.childCount);if(K+W.attrs.colspan>J)W=W.type.createChecked(V1(W.attrs,W.attrs.colspan,K+W.attrs.colspan-J),W.content);V.push(W),K+=W.attrs.colspan;for(let B=1;B<W.attrs.rowspan;B++)q[G+B]=(q[G+B]||0)+W.attrs.colspan}U.push(P.from(V))}X=U,Q=J}if(Z!=Y){const q=[];for(let U=0,G=0;U<Y;U++,G++){const z=[],V=X[G%Z];for(let K=0;K<V.childCount;K++){let H=V.child(K);if(U+H.attrs.rowspan>Y)H=H.type.create({...H.attrs,rowspan:Math.max(1,Y-H.attrs.rowspan)},H.content);z.push(H)}q.push(P.from(z))}X=q,Z=Y}return{width:Q,height:Z,rows:X}},nY=function(Q,Z,X,J,Y,q,U){const G=Q.doc.type.schema,z=X0(G);let V,K;if(Y>Z.width)for(let H=0,W=0;H<Z.height;H++){const B=X.child(H);W+=B.nodeSize;const L=[];let _;if(B.lastChild==null||B.lastChild.type==z.cell)_=V||(V=z.cell.createAndFill());else _=K||(K=z.header_cell.createAndFill());for(let I=Z.width;I<Y;I++)L.push(_);Q.insert(Q.mapping.slice(U).map(W-1+J),L)}if(q>Z.height){const H=[];for(let L=0,_=(Z.height-1)*Z.width;L<Math.max(Z.width,Y);L++){const I=L>=Z.width?!1:X.nodeAt(Z.map[_+L]).type==z.header_cell;H.push(I?K||(K=z.header_cell.createAndFill()):V||(V=z.cell.createAndFill()))}const W=z.row.create(null,P.from(H)),B=[];for(let L=Z.height;L<q;L++)B.push(W);Q.insert(Q.mapping.slice(U).map(J+X.nodeSize-2),B)}return!!(V||K)},p4=function(Q,Z,X,J,Y,q,U,G){if(U==0||U==Z.height)return!1;let z=!1;for(let V=Y;V<q;V++){const K=U*Z.width+V,H=Z.map[K];if(Z.map[K-Z.width]==H){z=!0;const W=X.nodeAt(H),{top:B,left:L}=Z.findCell(H);Q.setNodeMarkup(Q.mapping.slice(G).map(H+J),null,{...W.attrs,rowspan:U-B}),Q.insert(Q.mapping.slice(G).map(Z.positionAt(U,L,X)),W.type.createAndFill({...W.attrs,rowspan:B+W.attrs.rowspan-U})),V+=W.attrs.colspan-1}}return z},d4=function(Q,Z,X,J,Y,q,U,G){if(U==0||U==Z.width)return!1;let z=!1;for(let V=Y;V<q;V++){const K=V*Z.width+U,H=Z.map[K];if(Z.map[K-1]==H){z=!0;const W=X.nodeAt(H),B=Z.colCount(H),L=Q.mapping.slice(G).map(H+J);Q.setNodeMarkup(L,null,V1(W.attrs,U-B,W.attrs.colspan-(U-B))),Q.insert(L+W.nodeSize,W.type.createAndFill(V1(W.attrs,0,U-B))),V+=W.attrs.rowspan-1}}return z},i4=function(Q,Z,X,J,Y){let q=X?Q.doc.nodeAt(X-1):Q.doc;if(!q)throw new Error("No table found");let U=v.get(q);const{top:G,left:z}=J,V=z+Y.width,K=G+Y.height,H=Q.tr;let W=0;function B(){if(q=X?H.doc.nodeAt(X-1):H.doc,!q)throw new Error("No table found");U=v.get(q),W=H.mapping.maps.length}if(nY(H,U,q,X,V,K,W))B();if(p4(H,U,q,X,z,V,G,W))B();if(p4(H,U,q,X,z,V,K,W))B();if(d4(H,U,q,X,G,K,z,W))B();if(d4(H,U,q,X,G,K,V,W))B();for(let L=G;L<K;L++){const _=U.positionAt(L,z,q),I=U.positionAt(L,V,q);H.replace(H.mapping.slice(W).map(_+X),H.mapping.slice(W).map(I+X),new j(Y.rows[L-G],0,0))}B(),H.setSelection(new x(H.doc.resolve(X+U.positionAt(G,z,q)),H.doc.resolve(X+U.positionAt(K-1,V-1,q)))),Z(H)},i5=function(Q,Z,X){if(X.eq(Q.selection))return!1;if(Z)Z(Q.tr.setSelection(X).scrollIntoView());return!0},p5=function(Q,Z){return(X,J,Y)=>{if(!Y)return!1;const q=X.selection;if(q instanceof x)return i5(X,J,N.near(q.$headCell,Z));if(Q!="horiz"&&!q.empty)return!1;const U=H8(Y,Q,Z);if(U==null)return!1;if(Q=="horiz")return i5(X,J,N.near(X.doc.resolve(q.head+Z),Z));else{const G=X.doc.resolve(U),z=o4(G,Q,Z);let V;if(z)V=N.near(z,1);else if(Z<0)V=N.near(X.doc.resolve(G.before(-1)),-1);else V=N.near(X.doc.resolve(G.after(-1)),1);return i5(X,J,V)}}},d5=function(Q,Z){return(X,J,Y)=>{if(!Y)return!1;const q=X.selection;let U;if(q instanceof x)U=q;else{const z=H8(Y,Q,Z);if(z==null)return!1;U=new x(X.doc.resolve(z))}const G=o4(U.$headCell,Q,Z);if(!G)return!1;return i5(X,J,new x(U.$anchorCell,G))}},oY=function(Q,Z){const X=Q.state.doc,J=b1(X.resolve(Z));if(!J)return!1;return Q.dispatch(Q.state.tr.setSelection(new x(J))),!0},tY=function(Q,Z,X){if(!F0(Q.state))return!1;let J=iY(X);const Y=Q.state.selection;if(Y instanceof x){if(!J)J={width:1,height:1,rows:[P.from(M7(X0(Q.state.schema).cell,X))]};const q=Y.$anchorCell.node(-1),U=Y.$anchorCell.start(-1),G=v.get(q).rectBetween(Y.$anchorCell.pos-U,Y.$headCell.pos-U);return J=aY(J,G.right-G.left,G.bottom-G.top),i4(Q.state,Q.dispatch,U,G,J),!0}else if(J){const q=s5(Q.state),U=q.start(-1);return i4(Q.state,Q.dispatch,U,v.get(q.node(-1)).findCell(q.pos-U),J),!0}else return!1},eY=function(Q,Z){var X;if(Z.ctrlKey||Z.metaKey)return;const J=s4(Q,Z.target);let Y;if(Z.shiftKey&&Q.state.selection instanceof x)q(Q.state.selection.$anchorCell,Z),Z.preventDefault();else if(Z.shiftKey&&J&&(Y=b1(Q.state.selection.$anchor))!=null&&((X=O7(Q,Z))==null?void 0:X.pos)!=Y.pos)q(Y,Z),Z.preventDefault();else if(!J)return;function q(z,V){let K=O7(Q,V);const H=n0.getState(Q.state)==null;if(!K||!T7(z,K))if(H)K=z;else return;const W=new x(z,K);if(H||!Q.state.selection.eq(W)){const B=Q.state.tr.setSelection(W);if(H)B.setMeta(n0,z.pos);Q.dispatch(B)}}function U(){if(Q.root.removeEventListener("mouseup",U),Q.root.removeEventListener("dragstart",U),Q.root.removeEventListener("mousemove",G),n0.getState(Q.state)!=null)Q.dispatch(Q.state.tr.setMeta(n0,-1))}function G(z){const V=z,K=n0.getState(Q.state);let H;if(K!=null)H=Q.state.doc.resolve(K);else if(s4(Q,V.target)!=J){if(H=O7(Q,Z),!H)return U()}if(H)q(H,V)}Q.root.addEventListener("mouseup",U),Q.root.addEventListener("dragstart",U),Q.root.addEventListener("mousemove",G)},H8=function(Q,Z,X){if(!(Q.state.selection instanceof O))return null;const{$head:J}=Q.state.selection;for(let Y=J.depth-1;Y>=0;Y--){const q=J.node(Y);if((X<0?J.index(Y):J.indexAfter(Y))!=(X<0?0:q.childCount))return null;if(q.type.spec.tableRole=="cell"||q.type.spec.tableRole=="header_cell"){const G=J.before(Y),z=Z=="vert"?X>0?"down":"up":X>0?"right":"left";return Q.endOfTextblock(z)?G:null}}return null},s4=function(Q,Z){for(;Z&&Z!=Q.dom;Z=Z.parentNode)if(Z.nodeName=="TD"||Z.nodeName=="TH")return Z;return null},O7=function(Q,Z){const X=Q.posAtCoords({left:Z.clientX,top:Z.clientY});if(!X)return null;return X?b1(Q.state.doc.resolve(X.pos)):null};var C7=function(Q,Z,X,J,Y,q){var U;let G=0,z=!0,V=Z.firstChild;const K=Q.firstChild;if(!K)return;for(let H=0,W=0;H<K.childCount;H++){const{colspan:B,colwidth:L}=K.child(H).attrs;for(let _=0;_<B;_++,W++){const I=Y==W?q:L&&L[_],F=I?I+"px":"";if(G+=I||J,!I)z=!1;if(!V){const E=document.createElement("col");E.style.width=F,Z.appendChild(E)}else{if(V.style.width!=F)V.style.width=F;V=V.nextSibling}}}while(V){const H=V.nextSibling;(U=V.parentNode)==null||U.removeChild(V),V=H}if(z)X.style.width=G+"px",X.style.minWidth="";else X.style.width="",X.style.minWidth=G+"px"},a5=function({handleWidth:Q=5,cellMinWidth:Z=25,defaultCellMinWidth:X=100,View:J=Qq,lastColumnResizable:Y=!0}={}){const q=new g({key:K0,state:{init(U,G){var z,V;const K=(V=(z=q.spec)==null?void 0:z.props)==null?void 0:V.nodeViews,H=X0(G.schema).table.name;if(J&&K)K[H]=(W,B)=>{return new J(W,X,B)};return new Zq(-1,!1)},apply(U,G){return G.apply(U)}},props:{attributes:(U)=>{const G=K0.getState(U);return G&&G.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(U,G)=>{Xq(U,G,Q,Y)},mouseleave:(U)=>{Jq(U)},mousedown:(U,G)=>{Yq(U,G,Z,X)}},decorations:(U)=>{const G=K0.getState(U);if(G&&G.activeHandle>-1)return Vq(U,G.activeHandle)},nodeViews:{}}});return q},Xq=function(Q,Z,X,J){if(!Q.editable)return;const Y=K0.getState(Q.state);if(!Y)return;if(!Y.dragging){const q=Uq(Z.target);let U=-1;if(q){const{left:G,right:z}=q.getBoundingClientRect();if(Z.clientX-G<=X)U=a4(Q,Z,"left",X);else if(z-Z.clientX<=X)U=a4(Q,Z,"right",X)}if(U!=Y.activeHandle){if(!J&&U!==-1){const G=Q.state.doc.resolve(U),z=G.node(-1),V=v.get(z),K=G.start(-1);if(V.colCount(G.pos-K)+G.nodeAfter.attrs.colspan-1==V.width-1)return}W8(Q,U)}}},Jq=function(Q){if(!Q.editable)return;const Z=K0.getState(Q.state);if(Z&&Z.activeHandle>-1&&!Z.dragging)W8(Q,-1)},Yq=function(Q,Z,X,J){var Y;if(!Q.editable)return!1;const q=(Y=Q.dom.ownerDocument.defaultView)!=null?Y:window,U=K0.getState(Q.state);if(!U||U.activeHandle==-1||U.dragging)return!1;const G=Q.state.doc.nodeAt(U.activeHandle),z=qq(Q,U.activeHandle,G.attrs);Q.dispatch(Q.state.tr.setMeta(K0,{setDragging:{startX:Z.clientX,startWidth:z}}));function V(H){q.removeEventListener("mouseup",V),q.removeEventListener("mousemove",K);const W=K0.getState(Q.state);if(W==null?void 0:W.dragging)Gq(Q,W.activeHandle,n4(W.dragging,H,X)),Q.dispatch(Q.state.tr.setMeta(K0,{setDragging:null}))}function K(H){if(!H.which)return V(H);const W=K0.getState(Q.state);if(!W)return;if(W.dragging){const B=n4(W.dragging,H,X);r4(Q,W.activeHandle,B,J)}}return r4(Q,U.activeHandle,z,J),q.addEventListener("mouseup",V),q.addEventListener("mousemove",K),Z.preventDefault(),!0},qq=function(Q,Z,{colspan:X,colwidth:J}){const Y=J&&J[J.length-1];if(Y)return Y;const q=Q.domAtPos(Z);let G=q.node.childNodes[q.offset].offsetWidth,z=X;if(J){for(let V=0;V<X;V++)if(J[V])G-=J[V],z--}return G/z},Uq=function(Q){while(Q&&Q.nodeName!="TD"&&Q.nodeName!="TH")Q=Q.classList&&Q.classList.contains("ProseMirror")?null:Q.parentNode;return Q},a4=function(Q,Z,X,J){const Y=X=="right"?-J:J,q=Q.posAtCoords({left:Z.clientX+Y,top:Z.clientY});if(!q)return-1;const{pos:U}=q,G=b1(Q.state.doc.resolve(U));if(!G)return-1;if(X=="right")return G.pos;const z=v.get(G.node(-1)),V=G.start(-1),K=z.map.indexOf(G.pos-V);return K%z.width==0?-1:V+z.map[K-1]},n4=function(Q,Z,X){const J=Z.clientX-Q.startX;return Math.max(X,Q.startWidth+J)},W8=function(Q,Z){Q.dispatch(Q.state.tr.setMeta(K0,{setHandle:Z}))},Gq=function(Q,Z,X){const J=Q.state.doc.resolve(Z),Y=J.node(-1),q=v.get(Y),U=J.start(-1),G=q.colCount(J.pos-U)+J.nodeAfter.attrs.colspan-1,z=Q.state.tr;for(let V=0;V<q.height;V++){const K=V*q.width+G;if(V&&q.map[K]==q.map[K-q.width])continue;const H=q.map[K],W=Y.nodeAt(H).attrs,B=W.colspan==1?0:G-q.colCount(H);if(W.colwidth&&W.colwidth[B]==X)continue;const L=W.colwidth?W.colwidth.slice():zq(W.colspan);L[B]=X,z.setNodeMarkup(U+H,null,{...W,colwidth:L})}if(z.docChanged)Q.dispatch(z)},r4=function(Q,Z,X,J){const Y=Q.state.doc.resolve(Z),q=Y.node(-1),U=Y.start(-1),G=v.get(q).colCount(Y.pos-U)+Y.nodeAfter.attrs.colspan-1;let z=Q.domAtPos(Y.start(-1)).node;while(z&&z.nodeName!="TABLE")z=z.parentNode;if(!z)return;C7(q,z.firstChild,z,J,G,X)},zq=function(Q){return Array(Q).fill(0)},Vq=function(Q,Z){var X;const J=[],Y=Q.doc.resolve(Z),q=Y.node(-1);if(!q)return w.empty;const U=v.get(q),G=Y.start(-1),z=U.colCount(Y.pos-G)+Y.nodeAfter.attrs.colspan-1;for(let V=0;V<U.height;V++){const K=z+V*U.width;if((z==U.width-1||U.map[K]!=U.map[K+1])&&(V==0||U.map[K]!=U.map[K-U.width])){const H=U.map[K],W=G+H+q.nodeAt(H).nodeSize-1,B=document.createElement("div");if(B.className="column-resize-handle",(X=K0.getState(Q))==null?void 0:X.dragging)J.push(s.node(G+H,G+H+q.nodeAt(H).nodeSize,{class:"column-resize-dragging"}));J.push(s.widget(W,B))}}return w.create(Q.doc,J)},L8=function({allowTableNodeSelection:Q=!1}={}){return new g({key:n0,state:{init(){return null},apply(Z,X){const J=Z.getMeta(n0);if(J!=null)return J==-1?null:J;if(X==null||!Z.docChanged)return X;const{deleted:Y,pos:q}=Z.mapping.mapResult(X);return Y?null:q}},props:{decorations:$Y,handleDOMEvents:{mousedown:eY},createSelectionBetween(Z){return n0.getState(Z.state)!=null?Z.state.selection:null},handleTripleClick:oY,handleKeyDown:rY,handlePaste:tY},appendTransaction(Z,X,J){return wY(J,k7(J,X),Q)}})},R7,N7;if(typeof WeakMap!="undefined"){let Q=new WeakMap;R7=(Z)=>Q.get(Z),N7=(Z,X)=>{return Q.set(Z,X),X}}else{const Q=[];let X=0;R7=(J)=>{for(let Y=0;Y<Q.length;Y+=2)if(Q[Y]==J)return Q[Y+1]},N7=(J,Y)=>{if(X==10)X=0;return Q[X++]=J,Q[X++]=Y}}var v=class{constructor(Q,Z,X,J){this.width=Q,this.height=Z,this.map=X,this.problems=J}findCell(Q){for(let Z=0;Z<this.map.length;Z++){const X=this.map[Z];if(X!=Q)continue;const J=Z%this.width,Y=Z/this.width|0;let q=J+1,U=Y+1;for(let G=1;q<this.width&&this.map[Z+G]==X;G++)q++;for(let G=1;U<this.height&&this.map[Z+this.width*G]==X;G++)U++;return{left:J,top:Y,right:q,bottom:U}}throw new RangeError(`No cell with offset ${Q} found`)}colCount(Q){for(let Z=0;Z<this.map.length;Z++)if(this.map[Z]==Q)return Z%this.width;throw new RangeError(`No cell with offset ${Q} found`)}nextCell(Q,Z,X){const{left:J,right:Y,top:q,bottom:U}=this.findCell(Q);if(Z=="horiz"){if(X<0?J==0:Y==this.width)return null;return this.map[q*this.width+(X<0?J-1:Y)]}else{if(X<0?q==0:U==this.height)return null;return this.map[J+this.width*(X<0?q-1:U)]}}rectBetween(Q,Z){const{left:X,right:J,top:Y,bottom:q}=this.findCell(Q),{left:U,right:G,top:z,bottom:V}=this.findCell(Z);return{left:Math.min(X,U),top:Math.min(Y,z),right:Math.max(J,G),bottom:Math.max(q,V)}}cellsInRect(Q){const Z=[],X={};for(let J=Q.top;J<Q.bottom;J++)for(let Y=Q.left;Y<Q.right;Y++){const q=J*this.width+Y,U=this.map[q];if(X[U])continue;if(X[U]=!0,Y==Q.left&&Y&&this.map[q-1]==U||J==Q.top&&J&&this.map[q-this.width]==U)continue;Z.push(U)}return Z}positionAt(Q,Z,X){for(let J=0,Y=0;;J++){const q=Y+X.child(J).nodeSize;if(J==Q){let U=Z+Q*this.width;const G=(Q+1)*this.width;while(U<G&&this.map[U]<Y)U++;return U==G?q-1:this.map[U]}Y=q}}static get(Q){return R7(Q)||N7(Q,NY(Q))}},n0=new c("selectingCells"),x=class Q extends N{constructor(Z,X=Z){const J=Z.node(-1),Y=v.get(J),q=Z.start(-1),U=Y.rectBetween(Z.pos-q,X.pos-q),G=Z.node(0),z=Y.cellsInRect(U).filter((K)=>K!=X.pos-q);z.unshift(X.pos-q);const V=z.map((K)=>{const H=J.nodeAt(K);if(!H)throw RangeError(`No cell with offset ${K} found`);const W=q+K+1;return new d1(G.resolve(W),G.resolve(W+H.content.size))});super(V[0].$from,V[0].$to,V);this.$anchorCell=Z,this.$headCell=X}map(Z,X){const J=Z.resolve(X.map(this.$anchorCell.pos)),Y=Z.resolve(X.map(this.$headCell.pos));if(D7(J)&&D7(Y)&&T7(J,Y)){const q=this.$anchorCell.node(-1)!=J.node(-1);if(q&&this.isRowSelection())return Q.rowSelection(J,Y);else if(q&&this.isColSelection())return Q.colSelection(J,Y);else return new Q(J,Y)}return O.between(J,Y)}content(){const Z=this.$anchorCell.node(-1),X=v.get(Z),J=this.$anchorCell.start(-1),Y=X.rectBetween(this.$anchorCell.pos-J,this.$headCell.pos-J),q={},U=[];for(let z=Y.top;z<Y.bottom;z++){const V=[];for(let K=z*X.width+Y.left,H=Y.left;H<Y.right;H++,K++){const W=X.map[K];if(q[W])continue;q[W]=!0;const B=X.findCell(W);let L=Z.nodeAt(W);if(!L)throw RangeError(`No cell with offset ${W} found`);const _=Y.left-B.left,I=B.right-Y.right;if(_>0||I>0){let F=L.attrs;if(_>0)F=V1(F,0,_);if(I>0)F=V1(F,F.colspan-I,I);if(B.left<Y.left){if(L=L.type.createAndFill(F),!L)throw RangeError(`Could not create cell with attrs ${JSON.stringify(F)}`)}else L=L.type.create(F,L.content)}if(B.top<Y.top||B.bottom>Y.bottom){const F={...L.attrs,rowspan:Math.min(B.bottom,Y.bottom)-Math.max(B.top,Y.top)};if(B.top<Y.top)L=L.type.createAndFill(F);else L=L.type.create(F,L.content)}V.push(L)}U.push(Z.child(z).copy(P.from(V)))}const G=this.isColSelection()&&this.isRowSelection()?Z:U;return new j(P.from(G),1,1)}replace(Z,X=j.empty){const J=Z.steps.length,Y=this.ranges;for(let U=0;U<Y.length;U++){const{$from:G,$to:z}=Y[U],V=Z.mapping.slice(J);Z.replace(V.map(G.pos),V.map(z.pos),U?j.empty:X)}const q=N.findFrom(Z.doc.resolve(Z.mapping.slice(J).map(this.to)),-1);if(q)Z.setSelection(q)}replaceWith(Z,X){this.replace(Z,new j(P.from(X),0,0))}forEachCell(Z){const X=this.$anchorCell.node(-1),J=v.get(X),Y=this.$anchorCell.start(-1),q=J.cellsInRect(J.rectBetween(this.$anchorCell.pos-Y,this.$headCell.pos-Y));for(let U=0;U<q.length;U++)Z(X.nodeAt(q[U]),Y+q[U])}isColSelection(){const Z=this.$anchorCell.index(-1),X=this.$headCell.index(-1);if(Math.min(Z,X)>0)return!1;const J=Z+this.$anchorCell.nodeAfter.attrs.rowspan,Y=X+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(J,Y)==this.$headCell.node(-1).childCount}static colSelection(Z,X=Z){const J=Z.node(-1),Y=v.get(J),q=Z.start(-1),U=Y.findCell(Z.pos-q),G=Y.findCell(X.pos-q),z=Z.node(0);if(U.top<=G.top){if(U.top>0)Z=z.resolve(q+Y.map[U.left]);if(G.bottom<Y.height)X=z.resolve(q+Y.map[Y.width*(Y.height-1)+G.right-1])}else{if(G.top>0)X=z.resolve(q+Y.map[G.left]);if(U.bottom<Y.height)Z=z.resolve(q+Y.map[Y.width*(Y.height-1)+U.right-1])}return new Q(Z,X)}isRowSelection(){const Z=this.$anchorCell.node(-1),X=v.get(Z),J=this.$anchorCell.start(-1),Y=X.colCount(this.$anchorCell.pos-J),q=X.colCount(this.$headCell.pos-J);if(Math.min(Y,q)>0)return!1;const U=Y+this.$anchorCell.nodeAfter.attrs.colspan,G=q+this.$headCell.nodeAfter.attrs.colspan;return Math.max(U,G)==X.width}eq(Z){return Z instanceof Q&&Z.$anchorCell.pos==this.$anchorCell.pos&&Z.$headCell.pos==this.$headCell.pos}static rowSelection(Z,X=Z){const J=Z.node(-1),Y=v.get(J),q=Z.start(-1),U=Y.findCell(Z.pos-q),G=Y.findCell(X.pos-q),z=Z.node(0);if(U.left<=G.left){if(U.left>0)Z=z.resolve(q+Y.map[U.top*Y.width]);if(G.right<Y.width)X=z.resolve(q+Y.map[Y.width*(G.top+1)-1])}else{if(G.left>0)X=z.resolve(q+Y.map[G.top*Y.width]);if(U.right<Y.width)Z=z.resolve(q+Y.map[Y.width*(U.top+1)-1])}return new Q(Z,X)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(Z,X){return new Q(Z.resolve(X.anchor),Z.resolve(X.head))}static create(Z,X,J=X){return new Q(Z.resolve(X),Z.resolve(J))}getBookmark(){return new bY(this.$anchorCell.pos,this.$headCell.pos)}};x.prototype.visible=!1;N.jsonID("cell",x);var bY=class Q{constructor(Z,X){this.anchor=Z,this.head=X}map(Z){return new Q(Z.map(this.anchor),Z.map(this.head))}resolve(Z){const X=Z.resolve(this.anchor),J=Z.resolve(this.head);if(X.parent.type.spec.tableRole=="row"&&J.parent.type.spec.tableRole=="row"&&X.index()<X.parent.childCount&&J.index()<J.parent.childCount&&T7(X,J))return new x(X,J);else return N.near(J,1)}},uY=new c("fix-tables"),o3=$1("row",{useDeprecatedLogic:!0}),t3=$1("column",{useDeprecatedLogic:!0}),V8=$1("cell",{useDeprecatedLogic:!0}),rY=Q5({ArrowLeft:p5("horiz",-1),ArrowRight:p5("horiz",1),ArrowUp:p5("vert",-1),ArrowDown:p5("vert",1),"Shift-ArrowLeft":d5("horiz",-1),"Shift-ArrowRight":d5("horiz",1),"Shift-ArrowUp":d5("vert",-1),"Shift-ArrowDown":d5("vert",1),Backspace:c5,"Mod-Backspace":c5,Delete:c5,"Mod-Delete":c5}),Qq=class{constructor(Q,Z){this.node=Q,this.defaultCellMinWidth=Z,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${Z}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),C7(Q,this.colgroup,this.table,Z),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(Q){if(Q.type!=this.node.type)return!1;return this.node=Q,C7(Q,this.colgroup,this.table,this.defaultCellMinWidth),!0}ignoreMutation(Q){return Q.type=="attributes"&&(Q.target==this.table||this.colgroup.contains(Q.target))}},K0=new c("tableColumnResizing"),Zq=class Q{constructor(Z,X){this.activeHandle=Z,this.dragging=X}apply(Z){const X=this,J=Z.getMeta(K0);if(J&&J.setHandle!=null)return new Q(J.setHandle,!1);if(J&&J.setDragging!==void 0)return new Q(X.activeHandle,J.setDragging);if(X.activeHandle>-1&&Z.docChanged){let Y=Z.mapping.map(X.activeHandle,-1);if(!D7(Z.doc.resolve(Y)))Y=-1;return new Q(Y,X.dragging)}return X}};var $7=function(Q,Z){if(Z)return["width",`${Math.max(Z,Q)}px`];return["min-width",`${Q}px`]},B8=function(Q,Z,X,J,Y,q){var U;let G=0,z=!0,V=Z.firstChild;const K=Q.firstChild;if(K!==null)for(let H=0,W=0;H<K.childCount;H+=1){const{colspan:B,colwidth:L}=K.child(H).attrs;for(let _=0;_<B;_+=1,W+=1){const I=Y===W?q:L&&L[_],F=I?`${I}px`:"";if(G+=I||J,!I)z=!1;if(!V){const E=document.createElement("col"),[M,$]=$7(J,I);E.style.setProperty(M,$),Z.appendChild(E)}else{if(V.style.width!==F){const[E,M]=$7(J,I);V.style.setProperty(E,M)}V=V.nextSibling}}}while(V){const H=V.nextSibling;(U=V.parentNode)===null||U===void 0||U.removeChild(V),V=H}if(z)X.style.width=`${G}px`,X.style.minWidth="";else X.style.width="",X.style.minWidth=`${G}px`},Kq=function(Q,Z,X,J){let Y=0,q=!0;const U=[],G=Q.firstChild;if(!G)return{};for(let H=0,W=0;H<G.childCount;H+=1){const{colspan:B,colwidth:L}=G.child(H).attrs;for(let _=0;_<B;_+=1,W+=1){const I=X===W?J:L&&L[_];if(Y+=I||Z,!I)q=!1;const[F,E]=$7(Z,I);U.push(["col",{style:`${F}: ${E}`}])}}const z=q?`${Y}px`:"",V=q?"":`${Y}px`;return{colgroup:["colgroup",{},...U],tableWidth:z,tableMinWidth:V}},_8=function(Q,Z){if(Z)return Q.createChecked(null,Z);return Q.createAndFill()},Hq=function(Q){if(Q.cached.tableNodeTypes)return Q.cached.tableNodeTypes;const Z={};return Object.keys(Q.nodes).forEach((X)=>{const J=Q.nodes[X];if(J.spec.tableRole)Z[J.spec.tableRole]=J}),Q.cached.tableNodeTypes=Z,Z},x7=function(Q,Z,X,J,Y){const q=Hq(Q),U=[],G=[];for(let V=0;V<X;V+=1){const K=_8(q.cell,Y);if(K)G.push(K);if(J){const H=_8(q.header_cell,Y);if(H)U.push(H)}}const z=[];for(let V=0;V<Z;V+=1)z.push(q.row.createChecked(null,J&&V===0?U:G));return q.table.createChecked(null,z)},Wq=function(Q){return Q instanceof x};class I8{constructor(Q,Z){this.node=Q,this.cellMinWidth=Z,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),B8(Q,this.colgroup,this.table,Z),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(Q){if(Q.type!==this.node.type)return!1;return this.node=Q,B8(Q,this.colgroup,this.table,this.cellMinWidth),!0}ignoreMutation(Q){return Q.type==="attributes"&&(Q.target===this.table||this.colgroup.contains(Q.target))}}var n5=({editor:Q})=>{const{selection:Z}=Q.state;if(!Wq(Z))return!1;let X=0;const J=P7(Z.ranges[0].$from,(q)=>{return q.type.name==="table"});if(J===null||J===void 0||J.node.descendants((q)=>{if(q.type.name==="table")return!1;if(["tableCell","tableHeader"].includes(q.type.name))X+=1}),X!==Z.ranges.length)return!1;return Q.commands.deleteTable(),!0},F8=C.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:I8,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:Q,HTMLAttributes:Z}){const{colgroup:X,tableWidth:J,tableMinWidth:Y}=Kq(Q,this.options.cellMinWidth);return["table",D(this.options.HTMLAttributes,Z,{style:J?`width: ${J}`:`min-width: ${Y}`}),X,["tbody",0]]},addCommands(){return{insertTable:({rows:Q=3,cols:Z=3,withHeaderRow:X=!0}={})=>({tr:J,dispatch:Y,editor:q})=>{const U=x7(q.schema,Q,Z,X);if(Y){const G=J.selection.from+1;J.replaceSelectionWith(U).scrollIntoView().setSelection(O.near(J.doc.resolve(G)))}return!0},addColumnBefore:()=>({state:Q,dispatch:Z})=>{return Z8(Q,Z)},addColumnAfter:()=>({state:Q,dispatch:Z})=>{return X8(Q,Z)},deleteColumn:()=>({state:Q,dispatch:Z})=>{return J8(Q,Z)},addRowBefore:()=>({state:Q,dispatch:Z})=>{return q8(Q,Z)},addRowAfter:()=>({state:Q,dispatch:Z})=>{return U8(Q,Z)},deleteRow:()=>({state:Q,dispatch:Z})=>{return G8(Q,Z)},deleteTable:()=>({state:Q,dispatch:Z})=>{return K8(Q,Z)},mergeCells:()=>({state:Q,dispatch:Z})=>{return S7(Q,Z)},splitCell:()=>({state:Q,dispatch:Z})=>{return y7(Q,Z)},toggleHeaderColumn:()=>({state:Q,dispatch:Z})=>{return $1("column")(Q,Z)},toggleHeaderRow:()=>({state:Q,dispatch:Z})=>{return $1("row")(Q,Z)},toggleHeaderCell:()=>({state:Q,dispatch:Z})=>{return V8(Q,Z)},mergeOrSplit:()=>({state:Q,dispatch:Z})=>{if(S7(Q,Z))return!0;return y7(Q,Z)},setCellAttribute:(Q,Z)=>({state:X,dispatch:J})=>{return z8(Q,Z)(X,J)},goToNextCell:()=>({state:Q,dispatch:Z})=>{return b7(1)(Q,Z)},goToPreviousCell:()=>({state:Q,dispatch:Z})=>{return b7(-1)(Q,Z)},fixTables:()=>({state:Q,dispatch:Z})=>{if(Z)k7(Q);return!0},setCellSelection:(Q)=>({tr:Z,dispatch:X})=>{if(X){const J=x.create(Z.doc,Q.anchorCell,Q.headCell);Z.setSelection(J)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>{if(this.editor.commands.goToNextCell())return!0;if(!this.editor.can().addRowAfter())return!1;return this.editor.chain().addRowAfter().goToNextCell().run()},"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:n5,"Mod-Backspace":n5,Delete:n5,"Mod-Delete":n5}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[a5({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],L8({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(Q){const Z={name:Q.name,options:Q.options,storage:Q.storage};return{tableRole:T(A(Q,"tableRole",Z))}}});var P8=C.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:(Q)=>{const Z=Q.getAttribute("colwidth");return Z?Z.split(",").map((J)=>parseInt(J,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:Q}){return["td",D(this.options.HTMLAttributes,Q),0]}});var j8=C.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:(Q)=>{const Z=Q.getAttribute("colwidth");return Z?Z.split(",").map((J)=>parseInt(J,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:Q}){return["th",D(this.options.HTMLAttributes,Q),0]}});var x1={setCellAlignment:(Q)=>({commands:Z,state:X})=>{const{selection:J}=X;if(J instanceof x)return Z.command(({tr:q})=>{return J.forEachCell((U,G)=>{q.setNodeMarkup(G,U.type,{...U.attrs,align:Q})}),!0});const Y=J.$from.node(J.$from.depth-1);if(!Y)return!1;if(["tableHeader","tableCell"].includes(Y.type.name))return Z.updateAttributes(Y.type.name,{align:Q});return!1}},E8=P8.extend({addAttributes(){return{...this.parent?.(),align:{default:"left",parseHTML:(Q)=>Q.style.textAlign||"left",renderHTML:(Q)=>({style:`text-align: ${Q.align}; display: flex; justify-content: ${Q.align==="center"?"center":Q.align==="right"?"flex-end":"flex-start"};`})}}},addNodeView(){return({node:Q})=>{const Z=document.createElement("td"),X=document.createElement("div");return Z.setAttribute("align",Q.attrs.align),X.style.display="flex",X.style.flexDirection="row",X.style.alignItems="center",X.style.justifyContent=Q.attrs.align==="center"?"center":Q.attrs.align==="right"?"flex-end":"flex-start",Z.appendChild(X),{dom:Z,contentDOM:X,update(J){if(J.type!==Q.type)return!1;return Q=J,Z.setAttribute("align",Q.attrs.align),Z.setAttribute("colspan",Q.attrs.colspan),Z.setAttribute("rowspan",Q.attrs.rowspan),X.style.justifyContent=Q.attrs.align==="center"?"center":Q.attrs.align==="right"?"flex-end":"flex-start",!0}}}},addCommands(){return{setCellAlignmentLeft:()=>x1.setCellAlignment("left"),setCellAlignmentRight:()=>x1.setCellAlignment("right"),setCellAlignmentCenter:()=>x1.setCellAlignment("center")}}}),A8=j8.extend({addAttributes(){return{...this.parent?.(),align:{default:"left",parseHTML:(Q)=>Q.style.textAlign||"left",renderHTML:(Q)=>({style:`text-align: ${Q.align}; display: flex; justify-content: ${Q.align==="center"?"center":Q.align==="right"?"flex-end":"flex-start"};`})}}},addCommands(){return{setCellAlignmentLeft:()=>x1.setCellAlignment("left"),setCellAlignmentRight:()=>x1.setCellAlignment("right"),setCellAlignmentCenter:()=>x1.setCellAlignment("center")}},addNodeView(){return({node:Q})=>{const Z=document.createElement("th"),X=document.createElement("div");if(Z.setAttribute("align",Q.attrs.align),X.style.display="flex",X.style.flexDirection="column",X.style.width="100%",X.style.height="100%",X.style.alignItems="center",Q.attrs.align==="left")X.style.justifyContent="flex-start";else if(Q.attrs.align==="center")X.style.justifyContent="center";else if(Q.attrs.align==="right")X.style.justifyContent="flex-end";return Z.appendChild(X),{dom:Z,contentDOM:X,update(J){if(J.type!==Q.type)return!1;return Q=J,Z.setAttribute("align",Q.attrs.align),Z.setAttribute("colspan",Q.attrs.colspan),Z.setAttribute("rowspan",Q.attrs.rowspan),X.style.justifyContent=Q.attrs.align==="center"?"center":Q.attrs.align==="right"?"flex-end":"flex-start",!0}}}}}),O8=F8.extend({addCommands(){return{...this.parent?.(),deleteTable:()=>({state:Q,dispatch:Z})=>{return!0}}}});var R8=C.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:Q}){return["tr",D(this.options.HTMLAttributes,Q),0]}});var N8=G0.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:(Q)=>Q.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:Q}){return["u",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setUnderline:()=>({commands:Q})=>{return Q.setMark(this.name)},toggleUnderline:()=>({commands:Q})=>{return Q.toggleMark(this.name)},unsetUnderline:()=>({commands:Q})=>{return Q.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var Lq=/^\s*>\s$/,D8=C.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:Q}){return["blockquote",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setBlockquote:()=>({commands:Q})=>{return Q.wrapIn(this.name)},toggleBlockquote:()=>({commands:Q})=>{return Q.toggleWrap(this.name)},unsetBlockquote:()=>({commands:Q})=>{return Q.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[a0({find:Lq,type:this.type})]}});var Bq=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,_q=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Iq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Fq=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,M8=G0.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:(Q)=>Q.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:(Q)=>Q.type.name===this.name},{style:"font-weight",getAttrs:(Q)=>/^(bold(er)?|[5-9]\d{2,})$/.test(Q)&&null}]},renderHTML({HTMLAttributes:Q}){return["strong",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setBold:()=>({commands:Q})=>{return Q.setMark(this.name)},toggleBold:()=>({commands:Q})=>{return Q.toggleMark(this.name)},unsetBold:()=>({commands:Q})=>{return Q.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[R0({find:Bq,type:this.type}),R0({find:Iq,type:this.type})]},addPasteRules(){return[N0({find:_q,type:this.type}),N0({find:Fq,type:this.type})]}});var Pq="listItem",C8="textStyle",T8=/^\s*([-+*])\s$/,k8=C.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:Q}){return["ul",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{toggleBulletList:()=>({commands:Q,chain:Z})=>{if(this.options.keepAttributes)return Z().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Pq,this.editor.getAttributes(C8)).run();return Q.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let Q=a0({find:T8,type:this.type});if(this.options.keepMarks||this.options.keepAttributes)Q=a0({find:T8,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>{return this.editor.getAttributes(C8)},editor:this.editor});return[Q]}});var jq=/(^|[^`])`([^`]+)`(?!`)/,Eq=/(^|[^`])`([^`]+)`(?!`)/g,S8=G0.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:Q}){return["code",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setCode:()=>({commands:Q})=>{return Q.setMark(this.name)},toggleCode:()=>({commands:Q})=>{return Q.toggleMark(this.name)},unsetCode:()=>({commands:Q})=>{return Q.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[R0({find:jq,type:this.type})]},addPasteRules(){return[N0({find:Eq,type:this.type})]}});var Aq=/^```([a-z]+)?[\s\n]$/,Oq=/^~~~([a-z]+)?[\s\n]$/,y8=C.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:(Q)=>{var Z;const{languageClassPrefix:X}=this.options,q=[...((Z=Q.firstElementChild)===null||Z===void 0?void 0:Z.classList)||[]].filter((U)=>U.startsWith(X)).map((U)=>U.replace(X,""))[0];if(!q)return null;return q},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:Q,HTMLAttributes:Z}){return["pre",D(this.options.HTMLAttributes,Z),["code",{class:Q.attrs.language?this.options.languageClassPrefix+Q.attrs.language:null},0]]},addCommands(){return{setCodeBlock:(Q)=>({commands:Z})=>{return Z.setNode(this.name,Q)},toggleCodeBlock:(Q)=>({commands:Z})=>{return Z.toggleNode(this.name,"paragraph",Q)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:Q,$anchor:Z}=this.editor.state.selection,X=Z.pos===1;if(!Q||Z.parent.type.name!==this.name)return!1;if(X||!Z.parent.textContent.length)return this.editor.commands.clearNodes();return!1},Enter:({editor:Q})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:Z}=Q,{selection:X}=Z,{$from:J,empty:Y}=X;if(!Y||J.parent.type!==this.type)return!1;const q=J.parentOffset===J.parent.nodeSize-2,U=J.parent.textContent.endsWith("\n\n");if(!q||!U)return!1;return Q.chain().command(({tr:G})=>{return G.delete(J.pos-2,J.pos),!0}).exitCode().run()},ArrowDown:({editor:Q})=>{if(!this.options.exitOnArrowDown)return!1;const{state:Z}=Q,{selection:X,doc:J}=Z,{$from:Y,empty:q}=X;if(!q||Y.parent.type!==this.type)return!1;if(Y.parentOffset!==Y.parent.nodeSize-2)return!1;const G=Y.after();if(G===void 0)return!1;if(J.nodeAt(G))return Q.commands.command(({tr:V})=>{return V.setSelection(N.near(J.resolve(G))),!0});return Q.commands.exitCode()}}},addInputRules(){return[Y5({find:Aq,type:this.type,getAttributes:(Q)=>({language:Q[1]})}),Y5({find:Oq,type:this.type,getAttributes:(Q)=>({language:Q[1]})})]},addProseMirrorPlugins(){return[new g({key:new c("codeBlockVSCodeHandler"),props:{handlePaste:(Q,Z)=>{if(!Z.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const X=Z.clipboardData.getData("text/plain"),J=Z.clipboardData.getData("vscode-editor-data"),Y=J?JSON.parse(J):void 0,q=Y===null||Y===void 0?void 0:Y.mode;if(!X||!q)return!1;const{tr:U,schema:G}=Q.state,z=G.text(X.replace(/\r\n?/g,"\n"));if(U.replaceSelectionWith(this.type.create({language:q},z)),U.selection.$from.parent.type!==this.type)U.setSelection(O.near(U.doc.resolve(Math.max(0,U.selection.from-2))));return U.setMeta("paste",!0),Q.dispatch(U),!0}}})]}});var b8=C.create({name:"doc",topNode:!0,content:"block+"});var $8=function(Q={}){return new g({view(Z){return new x8(Z,Q)}})};class x8{constructor(Q,Z){var X;this.editorView=Q,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(X=Z.width)!==null&&X!==void 0?X:1,this.color=Z.color===!1?void 0:Z.color||"black",this.class=Z.class,this.handlers=["dragover","dragend","drop","dragleave"].map((J)=>{let Y=(q)=>{this[J](q)};return Q.dom.addEventListener(J,Y),{name:J,handler:Y}})}destroy(){this.handlers.forEach(({name:Q,handler:Z})=>this.editorView.dom.removeEventListener(Q,Z))}update(Q,Z){if(this.cursorPos!=null&&Z.doc!=Q.state.doc)if(this.cursorPos>Q.state.doc.content.size)this.setCursor(null);else this.updateOverlay()}setCursor(Q){if(Q==this.cursorPos)return;if(this.cursorPos=Q,Q==null)this.element.parentNode.removeChild(this.element),this.element=null;else this.updateOverlay()}updateOverlay(){let Q=this.editorView.state.doc.resolve(this.cursorPos),Z=!Q.parent.inlineContent,X;if(Z){let{nodeBefore:U,nodeAfter:G}=Q;if(U||G){let z=this.editorView.nodeDOM(this.cursorPos-(U?U.nodeSize:0));if(z){let V=z.getBoundingClientRect(),K=U?V.bottom:V.top;if(U&&G)K=(K+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2;X={left:V.left,right:V.right,top:K-this.width/2,bottom:K+this.width/2}}}}if(!X){let U=this.editorView.coordsAtPos(this.cursorPos);X={left:U.left-this.width/2,right:U.left+this.width/2,top:U.top,bottom:U.bottom}}let J=this.editorView.dom.offsetParent;if(!this.element){if(this.element=J.appendChild(document.createElement("div")),this.class)this.element.className=this.class;if(this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color)this.element.style.backgroundColor=this.color}this.element.classList.toggle("prosemirror-dropcursor-block",Z),this.element.classList.toggle("prosemirror-dropcursor-inline",!Z);let Y,q;if(!J||J==document.body&&getComputedStyle(J).position=="static")Y=-pageXOffset,q=-pageYOffset;else{let U=J.getBoundingClientRect();Y=U.left-J.scrollLeft,q=U.top-J.scrollTop}this.element.style.left=X.left-Y+"px",this.element.style.top=X.top-q+"px",this.element.style.width=X.right-X.left+"px",this.element.style.height=X.bottom-X.top+"px"}scheduleRemoval(Q){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),Q)}dragover(Q){if(!this.editorView.editable)return;let Z=this.editorView.posAtCoords({left:Q.clientX,top:Q.clientY}),X=Z&&Z.inside>=0&&this.editorView.state.doc.nodeAt(Z.inside),J=X&&X.type.spec.disableDropCursor,Y=typeof J=="function"?J(this.editorView,Z,Q):J;if(Z&&!Y){let q=Z.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let U=I5(this.editorView.state.doc,q,this.editorView.dragging.slice);if(U!=null)q=U}this.setCursor(q),this.scheduleRemoval(5000)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(Q){if(Q.target==this.editorView.dom||!this.editorView.dom.contains(Q.relatedTarget))this.setCursor(null)}}var g8=i.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[$8(this.options)]}});var Rq=function(Q){for(let Z=Q.depth;Z>=0;Z--){let X=Q.index(Z),J=Q.node(Z);if(X==0){if(J.type.spec.isolating)return!0;continue}for(let Y=J.child(X-1);;Y=Y.lastChild){if(Y.childCount==0&&!Y.inlineContent||Y.isAtom||Y.type.spec.isolating)return!0;if(Y.inlineContent)return!1}}return!0},Nq=function(Q){for(let Z=Q.depth;Z>=0;Z--){let X=Q.indexAfter(Z),J=Q.node(Z);if(X==J.childCount){if(J.type.spec.isolating)return!0;continue}for(let Y=J.child(X);;Y=Y.firstChild){if(Y.childCount==0&&!Y.inlineContent||Y.isAtom||Y.type.spec.isolating)return!0;if(Y.inlineContent)return!1}}return!0},w8=function(){return new g({props:{decorations:Tq,createSelectionBetween(Q,Z,X){return Z.pos==X.pos&&f.valid(X)?new f(X):null},handleClick:Mq,handleKeyDown:Dq,handleDOMEvents:{beforeinput:Cq}}})},r5=function(Q,Z){const X=Q=="vert"?Z>0?"down":"up":Z>0?"right":"left";return function(J,Y,q){let U=J.selection,G=Z>0?U.$to:U.$from,z=U.empty;if(U instanceof O){if(!q.endOfTextblock(X)||G.depth==0)return!1;z=!1,G=J.doc.resolve(Z>0?G.after():G.before())}let V=f.findGapCursorFrom(G,Z,z);if(!V)return!1;if(Y)Y(J.tr.setSelection(new f(V)));return!0}},Mq=function(Q,Z,X){if(!Q||!Q.editable)return!1;let J=Q.state.doc.resolve(Z);if(!f.valid(J))return!1;let Y=Q.posAtCoords({left:X.clientX,top:X.clientY});if(Y&&Y.inside>-1&&R.isSelectable(Q.state.doc.nodeAt(Y.inside)))return!1;return Q.dispatch(Q.state.tr.setSelection(new f(J))),!0},Cq=function(Q,Z){if(Z.inputType!="insertCompositionText"||!(Q.state.selection instanceof f))return!1;let{$from:X}=Q.state.selection,J=X.parent.contentMatchAt(X.index()).findWrapping(Q.state.schema.nodes.text);if(!J)return!1;let Y=P.empty;for(let U=J.length-1;U>=0;U--)Y=P.from(J[U].createAndFill(null,Y));let q=Q.state.tr.replace(X.pos,X.pos,new j(Y,0,0));return q.setSelection(O.near(q.doc.resolve(X.pos+1))),Q.dispatch(q),!1},Tq=function(Q){if(!(Q.selection instanceof f))return null;let Z=document.createElement("div");return Z.className="ProseMirror-gapcursor",w.create(Q.doc,[s.widget(Q.selection.head,Z,{key:"gapcursor"})])};class f extends N{constructor(Q){super(Q,Q)}map(Q,Z){let X=Q.resolve(Z.map(this.head));return f.valid(X)?new f(X):N.near(X)}content(){return j.empty}eq(Q){return Q instanceof f&&Q.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(Q,Z){if(typeof Z.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new f(Q.resolve(Z.pos))}getBookmark(){return new g7(this.anchor)}static valid(Q){let Z=Q.parent;if(Z.isTextblock||!Rq(Q)||!Nq(Q))return!1;let X=Z.type.spec.allowGapCursor;if(X!=null)return X;let J=Z.contentMatchAt(Q.index()).defaultType;return J&&J.isTextblock}static findGapCursorFrom(Q,Z,X=!1){Q:for(;;){if(!X&&f.valid(Q))return Q;let J=Q.pos,Y=null;for(let q=Q.depth;;q--){let U=Q.node(q);if(Z>0?Q.indexAfter(q)<U.childCount:Q.index(q)>0){Y=U.child(Z>0?Q.indexAfter(q):Q.index(q)-1);break}else if(q==0)return null;J+=Z;let G=Q.doc.resolve(J);if(f.valid(G))return G}for(;;){let q=Z>0?Y.firstChild:Y.lastChild;if(!q){if(Y.isAtom&&!Y.isText&&!R.isSelectable(Y)){Q=Q.doc.resolve(J+Y.nodeSize*Z),X=!1;continue Q}break}Y=q,J+=Z;let U=Q.doc.resolve(J);if(f.valid(U))return U}return null}}}f.prototype.visible=!1;f.findFrom=f.findGapCursorFrom;N.jsonID("gapcursor",f);class g7{constructor(Q){this.pos=Q}map(Q){return new g7(Q.map(this.pos))}resolve(Q){let Z=Q.resolve(this.pos);return f.valid(Z)?new f(Z):N.near(Z)}}var Dq=Q5({ArrowLeft:r5("horiz",-1),ArrowRight:r5("horiz",1),ArrowUp:r5("vert",-1),ArrowDown:r5("vert",1)});var u8=i.create({name:"gapCursor",addProseMirrorPlugins(){return[w8()]},extendNodeSchema(Q){var Z;const X={name:Q.name,options:Q.options,storage:Q.storage};return{allowGapCursor:(Z=T(A(Q,"allowGapCursor",X)))!==null&&Z!==void 0?Z:null}}});var v8=C.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:Q}){return["br",D(this.options.HTMLAttributes,Q)]},renderText(){return"\n"},addCommands(){return{setHardBreak:()=>({commands:Q,chain:Z,state:X,editor:J})=>{return Q.first([()=>Q.exitCode(),()=>Q.command(()=>{const{selection:Y,storedMarks:q}=X;if(Y.$from.parent.type.spec.isolating)return!1;const{keepMarks:U}=this.options,{splittableMarks:G}=J.extensionManager,z=q||Y.$to.parentOffset&&Y.$from.marks();return Z().insertContent({type:this.name}).command(({tr:V,dispatch:K})=>{if(K&&z&&U){const H=z.filter((W)=>G.includes(W.type.name));V.ensureMarks(H)}return!0}).run()})])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var f8=C.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map((Q)=>({tag:`h${Q}`,attrs:{level:Q}}))},renderHTML({node:Q,HTMLAttributes:Z}){return[`h${this.options.levels.includes(Q.attrs.level)?Q.attrs.level:this.options.levels[0]}`,D(this.options.HTMLAttributes,Z),0]},addCommands(){return{setHeading:(Q)=>({commands:Z})=>{if(!this.options.levels.includes(Q.level))return!1;return Z.setNode(this.name,Q)},toggleHeading:(Q)=>({commands:Z})=>{if(!this.options.levels.includes(Q.level))return!1;return Z.toggleNode(this.name,"paragraph",Q)}}},addKeyboardShortcuts(){return this.options.levels.reduce((Q,Z)=>({...Q,...{[`Mod-Alt-${Z}`]:()=>this.editor.commands.toggleHeading({level:Z})}}),{})},addInputRules(){return this.options.levels.map((Q)=>{return Y5({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${Q}})\\s\$`),type:this.type,getAttributes:{level:Q}})})}});var o5=200,t=function Q(){};t.prototype.append=function Q(Z){if(!Z.length)return this;return Z=t.from(Z),!this.length&&Z||Z.length<o5&&this.leafAppend(Z)||this.length<o5&&Z.leafPrepend(this)||this.appendInner(Z)};t.prototype.prepend=function Q(Z){if(!Z.length)return this;return t.from(Z).append(this)};t.prototype.appendInner=function Q(Z){return new kq(this,Z)};t.prototype.slice=function Q(Z,X){if(Z===void 0)Z=0;if(X===void 0)X=this.length;if(Z>=X)return t.empty;return this.sliceInner(Math.max(0,Z),Math.min(this.length,X))};t.prototype.get=function Q(Z){if(Z<0||Z>=this.length)return;return this.getInner(Z)};t.prototype.forEach=function Q(Z,X,J){if(X===void 0)X=0;if(J===void 0)J=this.length;if(X<=J)this.forEachInner(Z,X,J,0);else this.forEachInvertedInner(Z,X,J,0)};t.prototype.map=function Q(Z,X,J){if(X===void 0)X=0;if(J===void 0)J=this.length;var Y=[];return this.forEach(function(q,U){return Y.push(Z(q,U))},X,J),Y};t.from=function Q(Z){if(Z instanceof t)return Z;return Z&&Z.length?new h8(Z):t.empty};var h8=function(Q){function Z(J){Q.call(this),this.values=J}if(Q)Z.__proto__=Q;Z.prototype=Object.create(Q&&Q.prototype),Z.prototype.constructor=Z;var X={length:{configurable:!0},depth:{configurable:!0}};return Z.prototype.flatten=function J(){return this.values},Z.prototype.sliceInner=function J(Y,q){if(Y==0&&q==this.length)return this;return new Z(this.values.slice(Y,q))},Z.prototype.getInner=function J(Y){return this.values[Y]},Z.prototype.forEachInner=function J(Y,q,U,G){for(var z=q;z<U;z++)if(Y(this.values[z],G+z)===!1)return!1},Z.prototype.forEachInvertedInner=function J(Y,q,U,G){for(var z=q-1;z>=U;z--)if(Y(this.values[z],G+z)===!1)return!1},Z.prototype.leafAppend=function J(Y){if(this.length+Y.length<=o5)return new Z(this.values.concat(Y.flatten()))},Z.prototype.leafPrepend=function J(Y){if(this.length+Y.length<=o5)return new Z(Y.flatten().concat(this.values))},X.length.get=function(){return this.values.length},X.depth.get=function(){return 0},Object.defineProperties(Z.prototype,X),Z}(t);t.empty=new h8([]);var kq=function(Q){function Z(X,J){Q.call(this),this.left=X,this.right=J,this.length=X.length+J.length,this.depth=Math.max(X.depth,J.depth)+1}if(Q)Z.__proto__=Q;return Z.prototype=Object.create(Q&&Q.prototype),Z.prototype.constructor=Z,Z.prototype.flatten=function X(){return this.left.flatten().concat(this.right.flatten())},Z.prototype.getInner=function X(J){return J<this.left.length?this.left.get(J):this.right.get(J-this.left.length)},Z.prototype.forEachInner=function X(J,Y,q,U){var G=this.left.length;if(Y<G&&this.left.forEachInner(J,Y,Math.min(q,G),U)===!1)return!1;if(q>G&&this.right.forEachInner(J,Math.max(Y-G,0),Math.min(this.length,q)-G,U+G)===!1)return!1},Z.prototype.forEachInvertedInner=function X(J,Y,q,U){var G=this.left.length;if(Y>G&&this.right.forEachInvertedInner(J,Y-G,Math.max(q,G)-G,U+G)===!1)return!1;if(q<G&&this.left.forEachInvertedInner(J,Math.min(Y,G),q,U)===!1)return!1},Z.prototype.sliceInner=function X(J,Y){if(J==0&&Y==this.length)return this;var q=this.left.length;if(Y<=q)return this.left.slice(J,Y);if(J>=q)return this.right.slice(J-q,Y-q);return this.left.slice(J,q).append(this.right.slice(0,Y-q))},Z.prototype.leafAppend=function X(J){var Y=this.right.leafAppend(J);if(Y)return new Z(this.left,Y)},Z.prototype.leafPrepend=function X(J){var Y=this.left.leafPrepend(J);if(Y)return new Z(Y,this.right)},Z.prototype.appendInner=function X(J){if(this.left.depth>=Math.max(this.right.depth,J.depth)+1)return new Z(this.left,new Z(this.right,J));return new Z(this,J)},Z}(t),w7=t;var yq=function(Q,Z){let X;return Q.forEach((J,Y)=>{if(J.selection&&Z--==0)return X=Y,!1}),Q.slice(X)},$q=function(Q,Z,X,J){let Y=X.getMeta(K1),q;if(Y)return Y.historyState;if(X.getMeta(wq))Q=new x0(Q.done,Q.undone,null,0,-1);let U=X.getMeta("appendedTransaction");if(X.steps.length==0)return Q;else if(U&&U.getMeta(K1))if(U.getMeta(K1).redo)return new x0(Q.done.addTransform(X,void 0,J,t5(Z)),Q.undone,m8(X.mapping.maps),Q.prevTime,Q.prevComposition);else return new x0(Q.done,Q.undone.addTransform(X,void 0,J,t5(Z)),null,Q.prevTime,Q.prevComposition);else if(X.getMeta("addToHistory")!==!1&&!(U&&U.getMeta("addToHistory")===!1)){let G=X.getMeta("composition"),z=Q.prevTime==0||!U&&Q.prevComposition!=G&&(Q.prevTime<(X.time||0)-J.newGroupDelay||!xq(X,Q.prevRanges)),V=U?u7(Q.prevRanges,X.mapping):m8(X.mapping.maps);return new x0(Q.done.addTransform(X,z?Z.selection.getBookmark():void 0,J,t5(Z)),P0.empty,V,X.time,G==null?Q.prevComposition:G)}else if(q=X.getMeta("rebased"))return new x0(Q.done.rebased(X,q),Q.undone.rebased(X,q),u7(Q.prevRanges,X.mapping),Q.prevTime,Q.prevComposition);else return new x0(Q.done.addMaps(X.mapping.maps),Q.undone.addMaps(X.mapping.maps),u7(Q.prevRanges,X.mapping),Q.prevTime,Q.prevComposition)},xq=function(Q,Z){if(!Z)return!1;if(!Q.docChanged)return!0;let X=!1;return Q.mapping.maps[0].forEach((J,Y)=>{for(let q=0;q<Z.length;q+=2)if(J<=Z[q+1]&&Y>=Z[q])X=!0}),X},m8=function(Q){let Z=[];for(let X=Q.length-1;X>=0&&Z.length==0;X--)Q[X].forEach((J,Y,q,U)=>Z.push(q,U));return Z},u7=function(Q,Z){if(!Q)return null;let X=[];for(let J=0;J<Q.length;J+=2){let Y=Z.map(Q[J],1),q=Z.map(Q[J+1],-1);if(Y<=q)X.push(Y,q)}return X},gq=function(Q,Z,X){let J=t5(Z),Y=K1.get(Z).spec.config,q=(X?Q.undone:Q.done).popEvent(Z,J);if(!q)return null;let U=q.selection.resolve(q.transform.doc),G=(X?Q.done:Q.undone).addTransform(q.transform,Z.selection.getBookmark(),Y,J),z=new x0(X?G:q.remaining,X?q.remaining:G,null,0,-1);return q.transform.setSelection(U).setMeta(K1,{redo:X,historyState:z})},t5=function(Q){let Z=Q.plugins;if(l8!=Z){v7=!1,l8=Z;for(let X=0;X<Z.length;X++)if(Z[X].spec.historyPreserveItems){v7=!0;break}}return v7};var c8=function(Q={}){return Q={depth:Q.depth||100,newGroupDelay:Q.newGroupDelay||500},new g({key:K1,state:{init(){return new x0(P0.empty,P0.empty,null,0,-1)},apply(Z,X,J){return $q(X,J,Z,Q)}},config:Q,props:{handleDOMEvents:{beforeinput(Z,X){let J=X.inputType,Y=J=="historyUndo"?f7:J=="historyRedo"?h7:null;if(!Y)return!1;return X.preventDefault(),Y(Z.state,Z.dispatch)}}}})},e5=function(Q,Z){return(X,J)=>{let Y=K1.getState(X);if(!Y||(Q?Y.undone:Y.done).eventCount==0)return!1;if(J){let q=gq(Y,X,Q);if(q)J(Z?q.scrollIntoView():q)}return!0}};var Sq=500;class P0{constructor(Q,Z){this.items=Q,this.eventCount=Z}popEvent(Q,Z){if(this.eventCount==0)return null;let X=this.items.length;for(;;X--)if(this.items.get(X-1).selection){--X;break}let J,Y;if(Z)J=this.remapping(X,this.items.length),Y=J.maps.length;let q=Q.tr,U,G,z=[],V=[];return this.items.forEach((K,H)=>{if(!K.step){if(!J)J=this.remapping(X,H+1),Y=J.maps.length;Y--,V.push(K);return}if(J){V.push(new M0(K.map));let W=K.step.map(J.slice(Y)),B;if(W&&q.maybeStep(W).doc)B=q.mapping.maps[q.mapping.maps.length-1],z.push(new M0(B,void 0,void 0,z.length+V.length));if(Y--,B)J.appendMap(B,Y)}else q.maybeStep(K.step);if(K.selection)return U=J?K.selection.map(J.slice(Y)):K.selection,G=new P0(this.items.slice(0,X).append(V.reverse().concat(z)),this.eventCount-1),!1},this.items.length,0),{remaining:G,transform:q,selection:U}}addTransform(Q,Z,X,J){let Y=[],q=this.eventCount,U=this.items,G=!J&&U.length?U.get(U.length-1):null;for(let V=0;V<Q.steps.length;V++){let K=Q.steps[V].invert(Q.docs[V]),H=new M0(Q.mapping.maps[V],K,Z),W;if(W=G&&G.merge(H))if(H=W,V)Y.pop();else U=U.slice(0,U.length-1);if(Y.push(H),Z)q++,Z=void 0;if(!J)G=H}let z=q-X.depth;if(z>bq)U=yq(U,z),q-=z;return new P0(U.append(Y),q)}remapping(Q,Z){let X=new _1;return this.items.forEach((J,Y)=>{let q=J.mirrorOffset!=null&&Y-J.mirrorOffset>=Q?X.maps.length-J.mirrorOffset:void 0;X.appendMap(J.map,q)},Q,Z),X}addMaps(Q){if(this.eventCount==0)return this;return new P0(this.items.append(Q.map((Z)=>new M0(Z))),this.eventCount)}rebased(Q,Z){if(!this.eventCount)return this;let X=[],J=Math.max(0,this.items.length-Z),Y=Q.mapping,q=Q.steps.length,U=this.eventCount;this.items.forEach((H)=>{if(H.selection)U--},J);let G=Z;this.items.forEach((H)=>{let W=Y.getMirror(--G);if(W==null)return;q=Math.min(q,W);let B=Y.maps[W];if(H.step){let L=Q.steps[W].invert(Q.docs[W]),_=H.selection&&H.selection.map(Y.slice(G+1,W));if(_)U++;X.push(new M0(B,L,_))}else X.push(new M0(B))},J);let z=[];for(let H=Z;H<q;H++)z.push(new M0(Y.maps[H]));let V=this.items.slice(0,J).append(z).append(X),K=new P0(V,U);if(K.emptyItemCount()>Sq)K=K.compress(this.items.length-X.length);return K}emptyItemCount(){let Q=0;return this.items.forEach((Z)=>{if(!Z.step)Q++}),Q}compress(Q=this.items.length){let Z=this.remapping(0,Q),X=Z.maps.length,J=[],Y=0;return this.items.forEach((q,U)=>{if(U>=Q){if(J.push(q),q.selection)Y++}else if(q.step){let G=q.step.map(Z.slice(X)),z=G&&G.getMap();if(X--,z)Z.appendMap(z,X);if(G){let V=q.selection&&q.selection.map(Z.slice(X));if(V)Y++;let K=new M0(z.invert(),G,V),H,W=J.length-1;if(H=J.length&&J[W].merge(K))J[W]=H;else J.push(K)}}else if(q.map)X--},this.items.length,0),new P0(w7.from(J.reverse()),Y)}}P0.empty=new P0(w7.empty,0);class M0{constructor(Q,Z,X,J){this.map=Q,this.step=Z,this.selection=X,this.mirrorOffset=J}merge(Q){if(this.step&&Q.step&&!Q.selection){let Z=Q.step.merge(this.step);if(Z)return new M0(Z.getMap().invert(),Z,this.selection)}}}class x0{constructor(Q,Z,X,J,Y){this.done=Q,this.undone=Z,this.prevRanges=X,this.prevTime=J,this.prevComposition=Y}}var bq=20,v7=!1,l8=null,K1=new c("history"),wq=new c("closeHistory"),f7=e5(!1,!0),h7=e5(!0,!0),KG=e5(!1,!1),HG=e5(!0,!1);var p8=i.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:Q,dispatch:Z})=>{return f7(Q,Z)},redo:()=>({state:Q,dispatch:Z})=>{return h7(Q,Z)}}},addProseMirrorPlugins(){return[c8(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}});var d8=C.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:Q}){return["hr",D(this.options.HTMLAttributes,Q)]},addCommands(){return{setHorizontalRule:()=>({chain:Q,state:Z})=>{const{selection:X}=Z,{$from:J,$to:Y}=X,q=Q();if(J.parentOffset===0)q.insertContentAt({from:Math.max(J.pos-1,0),to:Y.pos},{type:this.name});else if(m4(X))q.insertContentAt(Y.pos,{type:this.name});else q.insertContent({type:this.name});return q.command(({tr:U,dispatch:G})=>{var z;if(G){const{$to:V}=U.selection,K=V.end();if(V.nodeAfter)if(V.nodeAfter.isTextblock)U.setSelection(O.create(U.doc,V.pos+1));else if(V.nodeAfter.isBlock)U.setSelection(R.create(U.doc,V.pos));else U.setSelection(O.create(U.doc,V.pos));else{const H=(z=V.parent.type.contentMatch.defaultType)===null||z===void 0?void 0:z.create();if(H)U.insert(K,H),U.setSelection(O.create(U.doc,K+1))}U.scrollIntoView()}return!0}).run()}}},addInputRules(){return[l5({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}});var uq=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,vq=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,fq=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,hq=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,i8=G0.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:(Q)=>Q.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:(Q)=>Q.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:Q}){return["em",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setItalic:()=>({commands:Q})=>{return Q.setMark(this.name)},toggleItalic:()=>({commands:Q})=>{return Q.toggleMark(this.name)},unsetItalic:()=>({commands:Q})=>{return Q.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[R0({find:uq,type:this.type}),R0({find:fq,type:this.type})]},addPasteRules(){return[N0({find:vq,type:this.type}),N0({find:hq,type:this.type})]}});var s8=C.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:Q}){return["li",D(this.options.HTMLAttributes,Q),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}});var mq="listItem",a8="textStyle",n8=/^(\d+)\.\s$/,r8=C.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:(Q)=>{return Q.hasAttribute("start")?parseInt(Q.getAttribute("start")||"",10):1}},type:{default:void 0,parseHTML:(Q)=>Q.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:Q}){const{start:Z,...X}=Q;return Z===1?["ol",D(this.options.HTMLAttributes,X),0]:["ol",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{toggleOrderedList:()=>({commands:Q,chain:Z})=>{if(this.options.keepAttributes)return Z().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(mq,this.editor.getAttributes(a8)).run();return Q.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let Q=a0({find:n8,type:this.type,getAttributes:(Z)=>({start:+Z[1]}),joinPredicate:(Z,X)=>X.childCount+X.attrs.start===+Z[1]});if(this.options.keepMarks||this.options.keepAttributes)Q=a0({find:n8,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:(Z)=>({start:+Z[1],...this.editor.getAttributes(a8)}),joinPredicate:(Z,X)=>X.childCount+X.attrs.start===+Z[1],editor:this.editor});return[Q]}});var o8=C.create({name:"paragraph",priority:1000,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:Q}){return["p",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setParagraph:()=>({commands:Q})=>{return Q.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var lq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,cq=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,t8=G0.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:(Q)=>Q.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:Q}){return["s",D(this.options.HTMLAttributes,Q),0]},addCommands(){return{setStrike:()=>({commands:Q})=>{return Q.setMark(this.name)},toggleStrike:()=>({commands:Q})=>{return Q.toggleMark(this.name)},unsetStrike:()=>({commands:Q})=>{return Q.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[R0({find:lq,type:this.type})]},addPasteRules(){return[N0({find:cq,type:this.type})]}});var e8=C.create({name:"text",group:"inline"});var Q2=i.create({name:"starterKit",addExtensions(){var Q,Z,X,J,Y,q,U,G,z,V,K,H,W,B,L,_,I,F;const E=[];if(this.options.bold!==!1)E.push(M8.configure((Q=this.options)===null||Q===void 0?void 0:Q.bold));if(this.options.blockquote!==!1)E.push(D8.configure((Z=this.options)===null||Z===void 0?void 0:Z.blockquote));if(this.options.bulletList!==!1)E.push(k8.configure((X=this.options)===null||X===void 0?void 0:X.bulletList));if(this.options.code!==!1)E.push(S8.configure((J=this.options)===null||J===void 0?void 0:J.code));if(this.options.codeBlock!==!1)E.push(y8.configure((Y=this.options)===null||Y===void 0?void 0:Y.codeBlock));if(this.options.document!==!1)E.push(b8.configure((q=this.options)===null||q===void 0?void 0:q.document));if(this.options.dropcursor!==!1)E.push(g8.configure((U=this.options)===null||U===void 0?void 0:U.dropcursor));if(this.options.gapcursor!==!1)E.push(u8.configure((G=this.options)===null||G===void 0?void 0:G.gapcursor));if(this.options.hardBreak!==!1)E.push(v8.configure((z=this.options)===null||z===void 0?void 0:z.hardBreak));if(this.options.heading!==!1)E.push(f8.configure((V=this.options)===null||V===void 0?void 0:V.heading));if(this.options.history!==!1)E.push(p8.configure((K=this.options)===null||K===void 0?void 0:K.history));if(this.options.horizontalRule!==!1)E.push(d8.configure((H=this.options)===null||H===void 0?void 0:H.horizontalRule));if(this.options.italic!==!1)E.push(i8.configure((W=this.options)===null||W===void 0?void 0:W.italic));if(this.options.listItem!==!1)E.push(s8.configure((B=this.options)===null||B===void 0?void 0:B.listItem));if(this.options.orderedList!==!1)E.push(r8.configure((L=this.options)===null||L===void 0?void 0:L.orderedList));if(this.options.paragraph!==!1)E.push(o8.configure((_=this.options)===null||_===void 0?void 0:_.paragraph));if(this.options.strike!==!1)E.push(t8.configure((I=this.options)===null||I===void 0?void 0:I.strike));if(this.options.text!==!1)E.push(e8.configure((F=this.options)===null||F===void 0?void 0:F.text));return E}});var Z2=C.create({name:"caption",content:"inline+",selectable:!1,draggable:!1,parseHTML(){return[{tag:"caption"}]},renderHTML({HTMLAttributes:Q}){return["caption",D(Q),0]}});var X2=(Q)=>{return Q.map((Z)=>{const{id:X,type:J,data:Y}=Z,q=Object.entries(Y).map(([U,G])=>`  ${U} = {${G}}`).join(",\n");return`@${J}{${X},\n${q}\n}`}).join("\n\n")},m7=(Q)=>{const Z=/@(\w+)\{([^,]+),([\s\S]*?)}(?=\s*@|\s*$)/g,X=[...Q.matchAll(Z)];if(X.length===0)return console.error("No matches found"),[];return X.map((J)=>{const[,Y,q,U]=J,G=/(\w+)\s*=\s*\{((?:[^{}]|\{[^{}]*\})*)\}/g,z=[...U.matchAll(G)],V=Object.fromEntries(z.map(([K,H,W])=>[H.trim(),W.trim()]));return{id:q,type:Y,data:V||{}}})};var pq={conjunction:"dan",etal:"dkk."};class q5{cite;static lang=pq;maxAuthors=5;constructor(Q){this.cite=Q}toCiteA(){return`${this.formatAuthorname()} (${this.cite.data.year})`}toCite(){return`(${this.formatAuthorname()}, ${this.cite.data.year})`}setCite(Q){return this.cite=Q,this}setMaxAuthors(Q){return this.maxAuthors=Q,this}static setLang(Q){return this.lang=Q,this}getTitle(){return this.cite.data.title}formatAuthorname(){const Q=this.cite.data.author;if(!Q)return"";if(!Q.includes(" and "))return Q.split(",")[0]||Q;const X=Q.split(" and ").map((J)=>{if(J.includes(","))return` ${J.split(",")[0]}`.trim();return J});if(X.length>this.maxAuthors)return X.slice(0,5).join(", ")+" "+q5.lang.etal;if(X.length>1)return X.slice(0,-1).join(", ")+` ${q5.lang.conjunction} `+X[X.length-1];return Q}}var J2=async(Q)=>{try{const Z=await fetch(Q,{method:"GET",headers:{Accept:"application/x-bibtex"}});if(!Z.ok)throw new Error(`HTTP error! Status: ${Z.status}`);return m7(await Z.text())[0]}catch(Z){throw console.error("Error fetching BibTeX:",Z),new Error("Failed to fetch bib tex.")}};class Q6{static storage=null;static init(Q){this.storage=Q}static ensureStorageInitialized(){if(!this.storage)throw new Error("CiteManager not initialized")}static getAll(){return this.ensureStorageInitialized(),this.storage.getAll()}static get(Q){return this.ensureStorageInitialized(),this.storage.get(Q)}static update(Q,Z){this.ensureStorageInitialized(),this.storage.update(Q,Z)}static delete(Q){this.ensureStorageInitialized(),this.storage.delete(Q)}static add(Q){this.ensureStorageInitialized(),this.storage.add(Q)}static async addFromDoi(Q){const Z=await J2(Q);this.add(Z)}static toBib(){return this.ensureStorageInitialized(),X2(this.getAll())}static setFromBib(){}}var Y2=C.create({name:"cite",group:"inline",inline:!0,atom:!0,addAttributes(){return{cite:{default:"",parseHTML:(Q)=>Q.getAttribute("cite")||"",renderHTML:(Q)=>({cite:Q.cite})},citeA:{default:!1,parseHTML:(Q)=>Q.hasAttribute("citeA"),renderHTML:(Q)=>Q.citeA?{citeA:"true"}:{}}}},parseHTML(){return[{tag:"cite[cite]",attrs:{cite:this.options.cite,citeA:this.options.citeA}}]},renderHTML({node:Q}){const Z=Q6.get(Q.attrs.cite);if(!Z)return["cite",{class:"cite",cite:Q.attrs.cite},"(Unknown citation!)"];const X=new q5(Z);return["cite",D({class:"cite",cite:Z.id}),Q.attrs.citeA?X.toCiteA():X.toCite()]},addCommands(){return{insertCitation:(Q)=>({commands:Z})=>{return Z.insertContent({type:this.name,attrs:{cite:Q.cite,citeA:Q.citeA||!1}})}}}});var q2=C.create({name:"figcaption",addOptions(){return{HTMLAttributes:{}}},content:"inline*",selectable:!1,draggable:!1,parseHTML(){return[{tag:"figcaption"}]},renderHTML({HTMLAttributes:Q}){return["figcaption",D(Q),0]}});function H1(){return Date.now().toString(36)+Math.random().toString(36).substring(2,8)}var Z6=C.create({name:"figure",addAttributes(){return{figureId:{default:null,parseHTML:(Q)=>Q.getAttribute("figureId")||H1(),renderHTML:(Q)=>({figureId:Q.figureId}),keepOnSplit:!1}}},group:"block",content:"image figcaption",draggable:!0,isolating:!0,parseHTML(){return[{tag:`figure[data-type="${this.name}"]`,getAttrs:(Q)=>({figureId:Q.getAttribute("figureId")||H1()})}]},renderHTML({HTMLAttributes:Q,node:Z}){return["figure",D(Q,{"data-type":this.name,id:Z.attrs.figureId}),0]},addProseMirrorPlugins(){return[new g({props:{handleDOMEvents:{dragstart:(Q,Z)=>{if(!Z.target)return!1;const X=Q.posAtDOM(Z.target,0);if(Q.state.doc.resolve(X).parent.type===this.type)Z.preventDefault();return!1}}}})]}});var U2=Z6.extend({name:"imageFigure",content:"image figcaption",addCommands:()=>{return{addFigureImage:(Q)=>({editor:Z})=>{return Z.commands.insertContent({type:"imageFigure",attrs:{figureId:H1()},content:[{type:"image",attrs:{src:Q}},{type:"figcaption",text:"Image Caption"}]})}}}});var G2=Z6.extend({name:"figureTable",content:"figcaption table",addCommands(){return{addFigureTable:()=>this.editor.chain().focus().insertContent({type:"figureTable",attrs:{figureId:H1()},content:[{type:"figcaption",content:[{type:"text",text:"Table caption"}]},x7(this.editor.schema,3,3,!0).toJSON()]}).run(),deleteFigureTable:()=>this.editor.chain().focus().deleteNode("figureTable").run()}}});var dq=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,z2=C.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:Q}){return["img",D(this.options.HTMLAttributes,Q)]},addCommands(){return{setImage:(Q)=>({commands:Z})=>{return Z.insertContent({type:this.name,attrs:Q})}}},addInputRules(){return[l5({find:dq,type:this.type,getAttributes:(Q)=>{const[,,Z,X,J]=Q;return{src:X,alt:Z,title:J}}})]}});var V2=z2.extend({name:"image",addOptions(){return{...this.parent?.(),HTMLAttributes:{}}},addAttributes(){return{src:{default:null},width:{default:"200px"},height:{default:"auto"}}},draggable:!0,selectable:!0,parseHTML(){return[{tag:"img",getAttrs:(Q)=>{const Z=Q;return{src:Z.getAttribute("src"),width:Z.getAttribute("width")||"200px",height:Z.style.height||"auto"}}}]},renderHTML({HTMLAttributes:Q,node:Z}){return["img",D(Q,{style:"cursor: nwse-resize;",width:Z.attrs.width})]},addNodeView(){return({node:Q,editor:Z,getPos:X})=>{const J=document.createElement("img");J.src=Q.attrs.src,J.style.width=Q.attrs.width,J.style.cursor="nwse-resize",J.style.userSelect="none";let Y,q;const U=(G)=>{G.preventDefault(),Y=G.clientX,q=J.offsetWidth;const z=(K)=>{const H=Math.max(50,q+(K.clientX-Y));J.style.width=`${H}px`,requestAnimationFrame(()=>{const{state:W,view:B}=this.editor,{$anchor:L}=W.selection,_=L.nodeAfter||L.parent;let I;if(_.type.name=="image")I=_;else if(_.type.name==="imageFigure")I=_.content.firstChild;if(console.log(I),!I)return;const F=W.tr.setNodeMarkup(L.pos,I.type,{...I.attrs,width:`${H}px`});B.dispatch(F)})},V=()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",V)};document.addEventListener("mousemove",z),document.addEventListener("mouseup",V)};return J.addEventListener("mousedown",(G)=>{if(G.preventDefault(),Z.chain().focus().setNodeSelection(X()).run(),G.button===0)U(G)}),{dom:J,update(G){if(Q.type!==G.type)return!1;return J.style.width=G.attrs.width,J.setAttribute("width",G.attrs.width),!0}}}},addCommands(){return{deleteImage:()=>{const{$anchor:Q}=this.editor.state.selection,Z=Q.nodeAfter||Q.parent;return console.log(Z,Q.nodeAfter,Q.parent,Q.nodeBefore),!0}}},addKeyboardShortcuts(){return{Delete:()=>this.editor.commands.deleteImage(),Backspace:()=>this.editor.commands.deleteImage()}}});window.onload=()=>{console.log("Script loaded!");const Q=document.createElement("style");Q.innerHTML=l7,document.head.appendChild(Q);const Z=new A7({element:document.getElementById("app"),content:"<p>Hello World</p>",extensions:[Q2,N8,O8.configure({resizable:!0}),E8,A8,R8,q2,Y2,G2,U2,V2,Z2,a5]})};
